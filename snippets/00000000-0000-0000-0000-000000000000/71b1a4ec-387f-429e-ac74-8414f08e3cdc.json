{
  "settings": {
    "snippetUuid": "71b1a4ec-387f-429e-ac74-8414f08e3cdc",
    "snippetname": "LinuxAudit",
    "snippettype": ".py",
    "created_at": 1763041552
  },
  "payload": {
    "payloadsig": "oLr0oeOZicmi1M9mxA/J9DBH0gCbhmtnO4VTSIsKJQamztmd8JHeGvqA7OVVFYTgSTjChsJ3Lo4G/5i+QokFqS+XG2ln41nuXLmHbb5aPMyRmO+jvT/f22UKQ96yi2kbQ86kpwi8AfQgZpCcA7b+g/DMmrWN6nTFb/9jf1U0SIJvxO/+25U+nKzd3FQJUsuERMfBH3W/Gm1AVBLi49jSWnGcUe1Xr2RBvWpElPit/68nXSWgZgT2sUM++w7WlMxUiwsWv5sFedioNXiXzSAU1KylUC91JgWUfBph1KfWkRlvYpIFjF+hpCYAxeHv2DKP2Cwq1oLPW6xtqr+nEs2eHvQZP9uw6GA1lls9n2Re/SXR2vNgI3U/MYJU4tRRpsUJmRQDlUZGfcDlQP0/Cj/jTE7JTR5K2zIRO9hej7KWkutQJkZ4IllN7bn1pzbxkYEtCYg9DFP35MJrimeW/y3XqmAOcuN7nft6lCqpdqoQQUHxf/8QaQaivlNwtc4DYCZUxz+pkA7sNxGHDxc4zejk6v0AHSCqEmdB4Q7906Z2u+nrdh0mIBQFOobiiQVOkDnSZwT2D4dMcNGmlZC7d5rx5+TGUIVDKV9nWv7r0U9d29LdK5jLiK0TX+ur37d92VJTJ7GBl6ze2NFml7mEvInjd/LL7IvfUlxUGNy2uNd15/o=",
    "payloadb64": "IyBGaWxlcGF0aDogc25pcHBldHMvdW5TaWduZWQvTGludXhBdWRpdC5weQoiIiIKTGludXgtc3BlY2lmaWMgYXVkaXQgY29sbGVjdG9yIGZvciBXZWd3ZWlzZXIKQ29sbGVjdHMgY29tcHJlaGVuc2l2ZSBzeXN0ZW0gaW5mb3JtYXRpb24gdXNpbmcgcHN1dGlsIGFuZCBMaW51eC1zcGVjaWZpYyB0b29scwpTZWxmLWNvbnRhaW5lZCBzbmlwcGV0IHdpdGggYWxsIHV0aWxpdGllcyBpbmxpbmVkLgoiIiIKaW1wb3J0IHNvY2tldAppbXBvcnQganNvbgppbXBvcnQgb3MKaW1wb3J0IHBsYXRmb3JtCmltcG9ydCB0aW1lCmltcG9ydCBnZXRwYXNzCmltcG9ydCBzeXMKaW1wb3J0IHN1YnByb2Nlc3MKaW1wb3J0IGhhc2hsaWIKaW1wb3J0IGRhdGV0aW1lCmltcG9ydCBtYXRoCgojIEltcG9ydCBkZXBlbmRlbmNpZXMKdHJ5OgogICAgZnJvbSBsb2d6ZXJvIGltcG9ydCBsb2dnZXIsIGxvZ2ZpbGUKZXhjZXB0IEltcG9ydEVycm9yOgogICAgc3VicHJvY2Vzcy5jaGVja19jYWxsKFtzeXMuZXhlY3V0YWJsZSwgJy1tJywgJ3BpcCcsICdpbnN0YWxsJywgJ2xvZ3plcm8nXSkKICAgIGZyb20gbG9nemVybyBpbXBvcnQgbG9nZ2VyLCBsb2dmaWxlCgp0cnk6CiAgICBpbXBvcnQgcHN1dGlsCmV4Y2VwdCBJbXBvcnRFcnJvcjoKICAgIHN1YnByb2Nlc3MuY2hlY2tfY2FsbChbc3lzLmV4ZWN1dGFibGUsICctbScsICdwaXAnLCAnaW5zdGFsbCcsICdwc3V0aWwnXSkKICAgIGltcG9ydCBwc3V0aWwKCnRyeToKICAgIGltcG9ydCByZXF1ZXN0cwpleGNlcHQgSW1wb3J0RXJyb3I6CiAgICBzdWJwcm9jZXNzLmNoZWNrX2NhbGwoW3N5cy5leGVjdXRhYmxlLCAnLW0nLCAncGlwJywgJ2luc3RhbGwnLCAncmVxdWVzdHMnXSkKICAgIGltcG9ydCByZXF1ZXN0cwoKdHJ5OgogICAgaW1wb3J0IGRucy5yZXNvbHZlcgpleGNlcHQgSW1wb3J0RXJyb3I6CiAgICBzdWJwcm9jZXNzLmNoZWNrX2NhbGwoW3N5cy5leGVjdXRhYmxlLCAnLW0nLCAncGlwJywgJ2luc3RhbGwnLCAnZG5zcHl0aG9uJ10pCiAgICBpbXBvcnQgZG5zLnJlc29sdmVyCgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIElOTElORUQgVVRJTElUSUVTIChmcm9tIEF1ZGl0Q29tbW9uKSAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgpkZWYgY29udmVydFNpemUoc2l6ZUJ5dGVzKToKICAgICIiIkNvbnZlcnQgYnl0ZXMgdG8gaHVtYW4tcmVhZGFibGUgZm9ybWF0IiIiCiAgICBpZiBzaXplQnl0ZXMgPT0gMDoKICAgICAgICByZXR1cm4gIjAgQiIKICAgIHNpemVOYW1lID0gKCJCIiwgIktCIiwgIk1CIiwgIkdCIiwgIlRCIiwgIlBCIiwgIkVCIiwgIlpCIiwgIllCIikKICAgIGkgPSBpbnQobWF0aC5mbG9vcihtYXRoLmxvZyhzaXplQnl0ZXMsIDEwMjQpKSkKICAgIHAgPSBtYXRoLnBvdygxMDI0LCBpKQogICAgcyA9IHJvdW5kKHNpemVCeXRlcyAvIHAsIDIpCiAgICByZXR1cm4gZid7c30ge3NpemVOYW1lW2ldfScKCmRlZiBzZW5kSnNvblBheWxvYWRGbGFzayhwYXlsb2FkLCBlbmRwb2ludCwgaG9zdCwgZGVidWdNb2RlPUZhbHNlKToKICAgICIiIlNlbmQgSlNPTiBwYXlsb2FkIHRvIEZsYXNrIGVuZHBvaW50IiIiCiAgICB1cmwgPSBmJ2h0dHBzOi8ve2hvc3R9e2VuZHBvaW50fScKICAgIGlmIGRlYnVnTW9kZToKICAgICAgICBsb2dnZXIuZGVidWcoZidwYXlsb2FkIHRvIHNlbmQ6IHtwYXlsb2FkfScpCiAgICAgICAgbG9nZ2VyLmRlYnVnKGYnQXR0ZW1wdGluZyB0byBjb25uZWN0IHRvIHt1cmx9JykKICAgIGhlYWRlcnMgPSB7J0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ30KICAgIHJlc3BvbnNlID0gcmVxdWVzdHMucG9zdCh1cmwsIGhlYWRlcnM9aGVhZGVycywgZGF0YT1qc29uLmR1bXBzKHBheWxvYWQpKQogICAgcmV0dXJuIHJlc3BvbnNlCgpkZWYgZ2V0UHVibGljSXBBZGRyKCk6CiAgICAiIiJHZXQgcHVibGljIElQIGFkZHJlc3MiIiIKICAgIG9kRG5zU2VydmVyID0gJzIwOC42Ny4yMjIuMjIyJwogICAgaHR0cERuc1NlcnZlciA9ICdodHRwczovL2ljYW5oYXppcC5jb20nCiAgICBkbnNSZXNvbHZlciA9IGRucy5yZXNvbHZlci5SZXNvbHZlcigpCiAgICBkbnNSZXNvbHZlci5uYW1lc2VydmVycyA9IFtvZERuc1NlcnZlcl0KICAgIHB1YmxpY0lwID0gTm9uZQoKICAgIHRyeToKICAgICAgICBhbnN3ZXJzID0gZG5zUmVzb2x2ZXIucmVzb2x2ZSgnbXlpcC5vcGVuZG5zLmNvbScsICdBJykKICAgICAgICBmb3IgaXAgaW4gYW5zd2VyczoKICAgICAgICAgICAgcHVibGljSXAgPSBpcC50b190ZXh0KCkKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICBsb2dnZXIuZXJyb3IoZidGYWlsZWQgdG8gZ2V0IHB1YmxpY0lQIGZyb20ge29kRG5zU2VydmVyfS4gUmVhc29uOiB7ZX0nKQoKICAgIGlmIG5vdCBwdWJsaWNJcDoKICAgICAgICB0cnk6CiAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5nZXQoaHR0cERuc1NlcnZlcikKICAgICAgICAgICAgcHVibGljSXAgPSByLnRleHQuc3RyaXAoKQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgbG9nZ2VyLmVycm9yKGYnRmFpbGVkIHRvIGdldCBwdWJsaWNJUCBmcm9tIHtodHRwRG5zU2VydmVyfS4gUmVhc29uOiB7ZX0nKQoKICAgIGlmIG5vdCBwdWJsaWNJcDoKICAgICAgICBwdWJsaWNJcCA9ICcwLjAuMC4wJwoKICAgIHJldHVybiBwdWJsaWNJcAoKZGVmIGdldFVzZXJIb21lUGF0aCgpOgogICAgIiIiR2V0IHVzZXIgaG9tZSBkaXJlY3RvcnkgcGF0aCIiIgogICAgdXNlckhvbWVQYXRoID0gb3MucGF0aC5leHBhbmR1c2VyKCJ+IikKICAgIGxvZ2dlci5pbmZvKGYndXNlckhvbWVQYXRoOiB7dXNlckhvbWVQYXRofScpCiAgICByZXR1cm4gdXNlckhvbWVQYXRoCgpkZWYgZ2V0RGV2aWNlVXVpZChjb25maWdGaWxlKToKICAgICIiIkdldCBkZXZpY2UgVVVJRCBmcm9tIGNvbmZpZyBmaWxlIiIiCiAgICBsb2dnZXIuaW5mbyhmJ0F0dGVtcHRpbmcgdG8gcmVhZCB7Y29uZmlnRmlsZX0nKQogICAgdHJ5OgogICAgICAgIHdpdGggb3Blbihjb25maWdGaWxlLCAncicpIGFzIGY6CiAgICAgICAgICAgIGNvbmZpZyA9IGpzb24ubG9hZChmKQogICAgICAgICAgICBkZXZpY2VVdWlkID0gY29uZmlnLmdldCgnZGV2aWNlVXVpZCcpCiAgICAgICAgICAgIGhvc3QgPSBjb25maWcuZ2V0KCdob3N0JywgJ2FwcC53ZWd3ZWlzZXIudGVjaCcpCiAgICAgICAgICAgIGxvZ2dlci5pbmZvKGYnZGV2aWNlVXVpZDoge2RldmljZVV1aWR9JykKICAgICAgICAgICAgcmV0dXJuIGRldmljZVV1aWQsIGhvc3QKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICBsb2dnZXIuZXJyb3IoZidGYWlsZWQgdG8gcmVhZCBjb25maWcgZmlsZToge2V9JykKICAgICAgICByZXR1cm4gTm9uZSwgJ2FwcC53ZWd3ZWlzZXIudGVjaCcKCmRlZiBnZXRBcHBEaXJzKCk6CiAgICAiIiJHZXQgYXBwbGljYXRpb24gZGlyZWN0b3JpZXMiIiIKICAgIHVzZXJIb21lUGF0aCA9IGdldFVzZXJIb21lUGF0aCgpCiAgICBhcHBEaXIgPSBvcy5wYXRoLmpvaW4odXNlckhvbWVQYXRoLCAnLndlZ3dlaXNlcicpCiAgICBsb2dEaXIgPSBvcy5wYXRoLmpvaW4oYXBwRGlyLCAnbG9ncycpCiAgICBjb25maWdEaXIgPSBvcy5wYXRoLmpvaW4oYXBwRGlyLCAnY29uZmlnJykKICAgIHRlbXBEaXIgPSBvcy5wYXRoLmpvaW4oYXBwRGlyLCAndGVtcCcpCiAgICBmaWxlc0RpciA9IG9zLnBhdGguam9pbihhcHBEaXIsICdmaWxlcycpCgogICAgZm9yIGRpcmVjdG9yeSBpbiBbYXBwRGlyLCBsb2dEaXIsIGNvbmZpZ0RpciwgdGVtcERpciwgZmlsZXNEaXJdOgogICAgICAgIG9zLm1ha2VkaXJzKGRpcmVjdG9yeSwgZXhpc3Rfb2s9VHJ1ZSkKCiAgICBsb2dnZXIuaW5mbyhmJ2FwcERpcjoge2FwcERpcn0nKQogICAgcmV0dXJuIGFwcERpciwgbG9nRGlyLCBjb25maWdEaXIsIHRlbXBEaXIsIGZpbGVzRGlyCgpkZWYgZGVsRmlsZShmaWxlVG9EZWxldGUpOgogICAgIiIiRGVsZXRlIGEgZmlsZSIiIgogICAgbG9nZ2VyLmluZm8oZidBdHRlbXB0aW5nIHRvIGRlbGV0ZSB7ZmlsZVRvRGVsZXRlfS4uLicpCiAgICB0cnk6CiAgICAgICAgb3MucmVtb3ZlKGZpbGVUb0RlbGV0ZSkKICAgICAgICBsb2dnZXIuaW5mbyhmJ1N1Y2Nlc3NmdWxseSBkZWxldGVkIHtmaWxlVG9EZWxldGV9LicpCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgbG9nZ2VyLmVycm9yKGYnRmFpbGVkIHRvIGRlbGV0ZSB7ZmlsZVRvRGVsZXRlfS4gUmVhc29uOiB7ZX0nKQoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyBJTkxJTkVEIFBTVVRJTCBNRVRSSUNTIChmcm9tIFBzdXRpbE1ldHJpY3MpICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCmRlZiBnZXRDcHVNZXRyaWNzKCk6CiAgICAiIiJHYXRoZXIgY29tcHJlaGVuc2l2ZSBDUFUgbWV0cmljcyB1c2luZyBwc3V0aWwiIiIKICAgIHRyeToKICAgICAgICBjcHVfbWV0cmljcyA9IHt9CgogICAgICAgICMgQ29yZSBpbmZvcm1hdGlvbgogICAgICAgIGNwdV9tZXRyaWNzWydjb3Jlc19sb2dpY2FsJ10gPSBwc3V0aWwuY3B1X2NvdW50KGxvZ2ljYWw9VHJ1ZSkKICAgICAgICBjcHVfbWV0cmljc1snY29yZXNfcGh5c2ljYWwnXSA9IHBzdXRpbC5jcHVfY291bnQobG9naWNhbD1GYWxzZSkKCiAgICAgICAgIyBGcmVxdWVuY3kgaW5mb3JtYXRpb24KICAgICAgICB0cnk6CiAgICAgICAgICAgIGZyZXEgPSBwc3V0aWwuY3B1X2ZyZXEoKQogICAgICAgICAgICBpZiBmcmVxOgogICAgICAgICAgICAgICAgY3B1X21ldHJpY3NbJ2ZyZXF1ZW5jeV9jdXJyZW50J10gPSByb3VuZChmcmVxLmN1cnJlbnQsIDIpCiAgICAgICAgICAgICAgICBjcHVfbWV0cmljc1snZnJlcXVlbmN5X21pbiddID0gcm91bmQoZnJlcS5taW4sIDIpCiAgICAgICAgICAgICAgICBjcHVfbWV0cmljc1snZnJlcXVlbmN5X21heCddID0gcm91bmQoZnJlcS5tYXgsIDIpCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBsb2dnZXIuZGVidWcoZidDb3VsZCBub3QgZ2V0IENQVSBmcmVxdWVuY3k6IHtlfScpCgogICAgICAgICMgUGVyLUNQVSB1c2FnZSBwZXJjZW50YWdlCiAgICAgICAgdHJ5OgogICAgICAgICAgICBjcHVfcGVyY2VudCA9IHBzdXRpbC5jcHVfcGVyY2VudChpbnRlcnZhbD0xLCBwZXJjcHU9VHJ1ZSkKICAgICAgICAgICAgY3B1X21ldHJpY3NbJ2NwdV9wZXJjZW50J10gPSBbcm91bmQocCwgMikgZm9yIHAgaW4gY3B1X3BlcmNlbnRdCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBsb2dnZXIuZGVidWcoZidDb3VsZCBub3QgZ2V0IHBlci1DUFUgcGVyY2VudDoge2V9JykKCiAgICAgICAgIyBPdmVyYWxsIENQVSB1c2FnZQogICAgICAgIHRyeToKICAgICAgICAgICAgY3B1X21ldHJpY3NbJ2NwdV9wZXJjZW50X292ZXJhbGwnXSA9IHJvdW5kKHBzdXRpbC5jcHVfcGVyY2VudChpbnRlcnZhbD0wLjEpLCAyKQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKGYnQ291bGQgbm90IGdldCBvdmVyYWxsIENQVSBwZXJjZW50OiB7ZX0nKQoKICAgICAgICAjIENQVSB0aW1lcyAodXNlciwgc3lzdGVtLCBpZGxlLCBpb3dhaXQsIGlycSwgc29mdGlycSkKICAgICAgICB0cnk6CiAgICAgICAgICAgIHRpbWVzID0gcHN1dGlsLmNwdV90aW1lcygpCiAgICAgICAgICAgIGNwdV9tZXRyaWNzWydjcHVfdGltZXMnXSA9IHsKICAgICAgICAgICAgICAgICd1c2VyJzogcm91bmQodGltZXMudXNlciwgMiksCiAgICAgICAgICAgICAgICAnc3lzdGVtJzogcm91bmQodGltZXMuc3lzdGVtLCAyKSwKICAgICAgICAgICAgICAgICdpZGxlJzogcm91bmQodGltZXMuaWRsZSwgMiksCiAgICAgICAgICAgICAgICAnaW93YWl0Jzogcm91bmQodGltZXMuaW93YWl0LCAyKSBpZiBoYXNhdHRyKHRpbWVzLCAnaW93YWl0JykgZWxzZSBOb25lLAogICAgICAgICAgICAgICAgJ2lycSc6IHJvdW5kKHRpbWVzLmlycSwgMikgaWYgaGFzYXR0cih0aW1lcywgJ2lycScpIGVsc2UgTm9uZSwKICAgICAgICAgICAgICAgICdzb2Z0aXJxJzogcm91bmQodGltZXMuc29mdGlycSwgMikgaWYgaGFzYXR0cih0aW1lcywgJ3NvZnRpcnEnKSBlbHNlIE5vbmUsCiAgICAgICAgICAgIH0KICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZyhmJ0NvdWxkIG5vdCBnZXQgQ1BVIHRpbWVzOiB7ZX0nKQoKICAgICAgICAjIENQVSBzdGF0aXN0aWNzIChjb250ZXh0IHN3aXRjaGVzLCBpbnRlcnJ1cHRzKQogICAgICAgIHRyeToKICAgICAgICAgICAgc3RhdHMgPSBwc3V0aWwuY3B1X3N0YXRzKCkKICAgICAgICAgICAgY3B1X21ldHJpY3NbJ2NwdV9zdGF0cyddID0gewogICAgICAgICAgICAgICAgJ2N0eF9zd2l0Y2hlcyc6IHN0YXRzLmN0eF9zd2l0Y2hlcywKICAgICAgICAgICAgICAgICdpbnRlcnJ1cHRzJzogc3RhdHMuaW50ZXJydXB0cywKICAgICAgICAgICAgICAgICdzb2Z0X2ludGVycnVwdHMnOiBzdGF0cy5zb2Z0X2ludGVycnVwdHMsCiAgICAgICAgICAgICAgICAnc3lzY2FsbHMnOiBzdGF0cy5zeXNjYWxscyBpZiBoYXNhdHRyKHN0YXRzLCAnc3lzY2FsbHMnKSBlbHNlIE5vbmUsCiAgICAgICAgICAgIH0KICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZyhmJ0NvdWxkIG5vdCBnZXQgQ1BVIHN0YXRzOiB7ZX0nKQoKICAgICAgICBsb2dnZXIuaW5mbyhmJ1N1Y2Nlc3NmdWxseSBnYXRoZXJlZCBDUFUgbWV0cmljcycpCiAgICAgICAgcmV0dXJuIGNwdV9tZXRyaWNzCgogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIGxvZ2dlci5lcnJvcihmJ0Vycm9yIGdhdGhlcmluZyBDUFUgbWV0cmljczoge2V9JykKICAgICAgICByZXR1cm4ge30KCmRlZiBnZXRNZW1vcnlNZXRyaWNzKCk6CiAgICAiIiJHYXRoZXIgY29tcHJlaGVuc2l2ZSBtZW1vcnkgbWV0cmljcyB1c2luZyBwc3V0aWwiIiIKICAgIHRyeToKICAgICAgICBtZW1vcnlfbWV0cmljcyA9IHt9CgogICAgICAgICMgVmlydHVhbCBtZW1vcnkgZGV0YWlscwogICAgICAgIHRyeToKICAgICAgICAgICAgdm1lbSA9IHBzdXRpbC52aXJ0dWFsX21lbW9yeSgpCiAgICAgICAgICAgIG1lbW9yeV9tZXRyaWNzWydidWZmZXJzJ10gPSB2bWVtLmJ1ZmZlcnMgaWYgaGFzYXR0cih2bWVtLCAnYnVmZmVycycpIGVsc2UgTm9uZQogICAgICAgICAgICBtZW1vcnlfbWV0cmljc1snY2FjaGVkJ10gPSB2bWVtLmNhY2hlZCBpZiBoYXNhdHRyKHZtZW0sICdjYWNoZWQnKSBlbHNlIE5vbmUKICAgICAgICAgICAgbWVtb3J5X21ldHJpY3NbJ3NoYXJlZCddID0gdm1lbS5zaGFyZWQgaWYgaGFzYXR0cih2bWVtLCAnc2hhcmVkJykgZWxzZSBOb25lCiAgICAgICAgICAgIG1lbW9yeV9tZXRyaWNzWydwZXJjZW50J10gPSByb3VuZCh2bWVtLnBlcmNlbnQsIDIpCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBsb2dnZXIuZGVidWcoZidDb3VsZCBub3QgZ2V0IHZpcnR1YWwgbWVtb3J5IGRldGFpbHM6IHtlfScpCgogICAgICAgICMgU3dhcCBtZW1vcnkgZGV0YWlscwogICAgICAgIHRyeToKICAgICAgICAgICAgc3dhcCA9IHBzdXRpbC5zd2FwX21lbW9yeSgpCiAgICAgICAgICAgIG1lbW9yeV9tZXRyaWNzWydzd2FwX3RvdGFsJ10gPSBzd2FwLnRvdGFsCiAgICAgICAgICAgIG1lbW9yeV9tZXRyaWNzWydzd2FwX3VzZWQnXSA9IHN3YXAudXNlZAogICAgICAgICAgICBtZW1vcnlfbWV0cmljc1snc3dhcF9mcmVlJ10gPSBzd2FwLmZyZWUKICAgICAgICAgICAgbWVtb3J5X21ldHJpY3NbJ3N3YXBfcGVyY2VudCddID0gcm91bmQoc3dhcC5wZXJjZW50LCAyKQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKGYnQ291bGQgbm90IGdldCBzd2FwIG1lbW9yeSBkZXRhaWxzOiB7ZX0nKQoKICAgICAgICBsb2dnZXIuaW5mbyhmJ1N1Y2Nlc3NmdWxseSBnYXRoZXJlZCBtZW1vcnkgbWV0cmljcycpCiAgICAgICAgcmV0dXJuIG1lbW9yeV9tZXRyaWNzCgogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIGxvZ2dlci5lcnJvcihmJ0Vycm9yIGdhdGhlcmluZyBtZW1vcnkgbWV0cmljczoge2V9JykKICAgICAgICByZXR1cm4ge30KCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMgQ09ORklHVVJBVElPTiAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgpkZWJ1Z01vZGUgPSBUcnVlCmhvc3QgPSAnYXBwLndlZ3dlaXNlci50ZWNoJwpwb3J0ID0gNDQzCgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIEZVTkNUSU9OUyAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgpkZWYgZ2V0Q3B1SW5mbyhkZXZpY2VEYXRhRGljdCk6CiAgICAiIiJHZXQgQ1BVIGluZm9ybWF0aW9uIGluY2x1ZGluZyBjb21wcmVoZW5zaXZlIHBzdXRpbCBtZXRyaWNzIiIiCiAgICB0cnk6CiAgICAgICAgIyBHZXQgQ1BVIG5hbWUgZnJvbSBsc2NwdQogICAgICAgIHJlc3VsdCA9IHN1YnByb2Nlc3MucnVuKAogICAgICAgICAgICBbJ2xzY3B1J10sCiAgICAgICAgICAgIHN0ZG91dD1zdWJwcm9jZXNzLlBJUEUsCiAgICAgICAgICAgIHVuaXZlcnNhbF9uZXdsaW5lcz1UcnVlLAogICAgICAgICAgICB0aW1lb3V0PTEwCiAgICAgICAgKQogICAgICAgIGNwdU5hbWUgPSAnVW5rbm93bicKICAgICAgICBmb3IgbGluZSBpbiByZXN1bHQuc3Rkb3V0LnNwbGl0bGluZXMoKToKICAgICAgICAgICAgaWYgJ01vZGVsIG5hbWUnIGluIGxpbmU6CiAgICAgICAgICAgICAgICBjcHVOYW1lID0gbGluZS5zcGxpdCgnTW9kZWwgbmFtZTonKVsxXS5zdHJpcCgpCiAgICAgICAgICAgICAgICBicmVhawogICAgICAgIAogICAgICAgIGxvZ2dlci5pbmZvKGYnY3B1TmFtZToge2NwdU5hbWV9JykKICAgICAgICAKICAgICAgICAjIEdldCBjb21wcmVoZW5zaXZlIENQVSBtZXRyaWNzCiAgICAgICAgY3B1X21ldHJpY3MgPSBnZXRDcHVNZXRyaWNzKCkKICAgICAgICAKICAgICAgICBkZXZpY2VEYXRhRGljdFsnY3B1J10gPSB7CiAgICAgICAgICAgICdjcHVuYW1lJzogY3B1TmFtZSwKICAgICAgICAgICAgJ2NwdV9tZXRyaWNzJzogY3B1X21ldHJpY3MKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgcmV0dXJuIGRldmljZURhdGFEaWN0CiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgbG9nZ2VyLmVycm9yKGYnRXJyb3IgZ2V0dGluZyBDUFUgaW5mbzoge2V9JykKICAgICAgICBkZXZpY2VEYXRhRGljdFsnY3B1J10gPSB7CiAgICAgICAgICAgICdjcHVuYW1lJzogJ1Vua25vd24nLAogICAgICAgICAgICAnY3B1X21ldHJpY3MnOiB7fQogICAgICAgIH0KICAgICAgICByZXR1cm4gZGV2aWNlRGF0YURpY3QKCmRlZiBnZXRNZW1vcnlEYXRhKGRldmljZURhdGFEaWN0KToKICAgICIiIkdldCBtZW1vcnkgaW5mb3JtYXRpb24gaW5jbHVkaW5nIGNvbXByZWhlbnNpdmUgcHN1dGlsIG1ldHJpY3MiIiIKICAgIHRyeToKICAgICAgICB2bWVtID0gcHN1dGlsLnZpcnR1YWxfbWVtb3J5KCkKICAgICAgICAKICAgICAgICAjIEJhc2ljIG1lbW9yeSBpbmZvCiAgICAgICAgdG90YWxNZW1vcnkgPSB2bWVtLnRvdGFsCiAgICAgICAgYXZhaWxhYmxlTWVtb3J5ID0gdm1lbS5hdmFpbGFibGUKICAgICAgICB1c2VkTWVtb3J5ID0gdm1lbS51c2VkCiAgICAgICAgZnJlZU1lbW9yeSA9IHZtZW0uZnJlZQogICAgICAgIAogICAgICAgICMgR2V0IGNvbXByZWhlbnNpdmUgbWVtb3J5IG1ldHJpY3MKICAgICAgICBtZW1vcnlfbWV0cmljcyA9IGdldE1lbW9yeU1ldHJpY3MoKQogICAgICAgIAogICAgICAgIGRldmljZURhdGFEaWN0WydtZW1vcnknXSA9IHsKICAgICAgICAgICAgJ3RvdGFsJzogdG90YWxNZW1vcnksCiAgICAgICAgICAgICdhdmFpbGFibGUnOiBhdmFpbGFibGVNZW1vcnksCiAgICAgICAgICAgICd1c2VkJzogdXNlZE1lbW9yeSwKICAgICAgICAgICAgJ2ZyZWUnOiBmcmVlTWVtb3J5LAogICAgICAgICAgICAnbWVtb3J5X21ldHJpY3MnOiBtZW1vcnlfbWV0cmljcwogICAgICAgIH0KICAgICAgICAKICAgICAgICBsb2dnZXIuaW5mbyhmJ01lbW9yeToge2NvbnZlcnRTaXplKHRvdGFsTWVtb3J5KX0gdG90YWwnKQogICAgICAgIHJldHVybiBkZXZpY2VEYXRhRGljdAogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIGxvZ2dlci5lcnJvcihmJ0Vycm9yIGdldHRpbmcgbWVtb3J5IGRhdGE6IHtlfScpCiAgICAgICAgZGV2aWNlRGF0YURpY3RbJ21lbW9yeSddID0gewogICAgICAgICAgICAndG90YWwnOiAwLAogICAgICAgICAgICAnYXZhaWxhYmxlJzogMCwKICAgICAgICAgICAgJ3VzZWQnOiAwLAogICAgICAgICAgICAnZnJlZSc6IDAsCiAgICAgICAgICAgICdtZW1vcnlfbWV0cmljcyc6IHt9CiAgICAgICAgfQogICAgICAgIHJldHVybiBkZXZpY2VEYXRhRGljdAoKZGVmIGdldFN5c3RlbURhdGEoZGV2aWNlRGF0YURpY3QpOgogICAgIiIiR2V0IHN5c3RlbSBpbmZvcm1hdGlvbiIiIgogICAgdHJ5OgogICAgICAgIGRldmljZURhdGFEaWN0WydzeXN0ZW0nXSA9IHsKICAgICAgICAgICAgJ2RldmljZVBsYXRmb3JtJzogcGxhdGZvcm0uc3lzdGVtKCksCiAgICAgICAgICAgICdzeXN0ZW1OYW1lJzogc29ja2V0LmdldGhvc3RuYW1lKCksCiAgICAgICAgICAgICdjdXJyZW50VXNlcic6IGdldHBhc3MuZ2V0dXNlcigpLAogICAgICAgICAgICAnY3B1VXNhZ2UnOiBwc3V0aWwuY3B1X3BlcmNlbnQoaW50ZXJ2YWw9MSksCiAgICAgICAgICAgICdjcHVDb3VudCc6IHBzdXRpbC5jcHVfY291bnQoKSwKICAgICAgICAgICAgJ2Jvb3RUaW1lJzogcHN1dGlsLmJvb3RfdGltZSgpLAogICAgICAgICAgICAncHVibGljSXAnOiBnZXRQdWJsaWNJcEFkZHIoKQogICAgICAgIH0KICAgICAgICBsb2dnZXIuaW5mbyhmJ1N5c3RlbSBkYXRhIGNvbGxlY3RlZCcpCiAgICAgICAgcmV0dXJuIGRldmljZURhdGFEaWN0CiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgbG9nZ2VyLmVycm9yKGYnRXJyb3IgZ2V0dGluZyBzeXN0ZW0gZGF0YToge2V9JykKICAgICAgICByZXR1cm4gZGV2aWNlRGF0YURpY3QKCmRlZiBnZXREaXNrU3RhdHMoZGV2aWNlRGF0YURpY3QpOgogICAgIiIiR2V0IGRpc2sgc3RhdGlzdGljcyIiIgogICAgdHJ5OgogICAgICAgIGRyaXZlcyA9IFtdCiAgICAgICAgZm9yIHBhcnRpdGlvbiBpbiBwc3V0aWwuZGlza19wYXJ0aXRpb25zKCk6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIHVzYWdlID0gcHN1dGlsLmRpc2tfdXNhZ2UocGFydGl0aW9uLm1vdW50cG9pbnQpCiAgICAgICAgICAgICAgICBkcml2ZXMuYXBwZW5kKHsKICAgICAgICAgICAgICAgICAgICAnbmFtZSc6IHBhcnRpdGlvbi5kZXZpY2UsCiAgICAgICAgICAgICAgICAgICAgJ3RvdGFsJzogdXNhZ2UudG90YWwsCiAgICAgICAgICAgICAgICAgICAgJ3VzZWQnOiB1c2FnZS51c2VkLAogICAgICAgICAgICAgICAgICAgICdmcmVlJzogdXNhZ2UuZnJlZSwKICAgICAgICAgICAgICAgICAgICAndXNlZFBlcic6IHVzYWdlLnBlcmNlbnQsCiAgICAgICAgICAgICAgICAgICAgJ2ZyZWVQZXInOiAxMDAgLSB1c2FnZS5wZXJjZW50CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICBleGNlcHQgUGVybWlzc2lvbkVycm9yOgogICAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKGYnUGVybWlzc2lvbiBkZW5pZWQgZm9yIHtwYXJ0aXRpb24ubW91bnRwb2ludH0nKQoKICAgICAgICBkZXZpY2VEYXRhRGljdFsnZHJpdmVzJ10gPSBkcml2ZXMKICAgICAgICBsb2dnZXIuaW5mbyhmJ0Rpc2sgc3RhdHMgY29sbGVjdGVkOiB7bGVuKGRyaXZlcyl9IGRyaXZlcycpCiAgICAgICAgcmV0dXJuIGRldmljZURhdGFEaWN0CiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgbG9nZ2VyLmVycm9yKGYnRXJyb3IgZ2V0dGluZyBkaXNrIHN0YXRzOiB7ZX0nKQogICAgICAgIGRldmljZURhdGFEaWN0Wydkcml2ZXMnXSA9IFtdCiAgICAgICAgcmV0dXJuIGRldmljZURhdGFEaWN0CgpkZWYgZ2V0TmV0d29ya0RhdGEoZGV2aWNlRGF0YURpY3QpOgogICAgIiIiR2V0IG5ldHdvcmsgaW50ZXJmYWNlIGluZm9ybWF0aW9uIiIiCiAgICB0cnk6CiAgICAgICAgbmV0d29ya0xpc3QgPSBbXQogICAgICAgIGZvciBpbnRlcmZhY2VfbmFtZSwgaW50ZXJmYWNlX2FkZHJzIGluIHBzdXRpbC5uZXRfaWZfYWRkcnMoKS5pdGVtcygpOgogICAgICAgICAgICBuZXRfaWZfc3RhdHMgPSBwc3V0aWwubmV0X2lmX3N0YXRzKCkKICAgICAgICAgICAgaWYgaW50ZXJmYWNlX25hbWUgaW4gbmV0X2lmX3N0YXRzOgogICAgICAgICAgICAgICAgc3RhdHMgPSBuZXRfaWZfc3RhdHNbaW50ZXJmYWNlX25hbWVdCiAgICAgICAgICAgICAgICBpbnRlcmZhY2VfZGF0YSA9IHsKICAgICAgICAgICAgICAgICAgICBpbnRlcmZhY2VfbmFtZTogewogICAgICAgICAgICAgICAgICAgICAgICAnaWZJc1VwJzogc3RhdHMuaXN1cCwKICAgICAgICAgICAgICAgICAgICAgICAgJ2lmU3BlZWQnOiBzdGF0cy5zcGVlZCwKICAgICAgICAgICAgICAgICAgICAgICAgJ2lmTXR1Jzogc3RhdHMubXR1LAogICAgICAgICAgICAgICAgICAgICAgICAnYnl0ZXNTZW50Jzogc3RhdHMuYnl0ZXNfc2VudCwKICAgICAgICAgICAgICAgICAgICAgICAgJ2J5dGVzUmVjdic6IHN0YXRzLmJ5dGVzX3JlY3YsCiAgICAgICAgICAgICAgICAgICAgICAgICdlcnJJbic6IHN0YXRzLmVycmluLAogICAgICAgICAgICAgICAgICAgICAgICAnZXJyT3V0Jzogc3RhdHMuZXJyb3V0LAogICAgICAgICAgICAgICAgICAgICAgICAnYWRkcmVzczQnOiBOb25lLAogICAgICAgICAgICAgICAgICAgICAgICAnbmV0bWFzazQnOiBOb25lLAogICAgICAgICAgICAgICAgICAgICAgICAnYnJvYWRjYXN0NCc6IE5vbmUsCiAgICAgICAgICAgICAgICAgICAgICAgICdhZGRyZXNzNic6IE5vbmUsCiAgICAgICAgICAgICAgICAgICAgICAgICduZXRtYXNrNic6IE5vbmUsCiAgICAgICAgICAgICAgICAgICAgICAgICdicm9hZGNhc3Q2JzogTm9uZQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBmb3IgYWRkciBpbiBpbnRlcmZhY2VfYWRkcnM6CiAgICAgICAgICAgICAgICAgICAgaWYgYWRkci5mYW1pbHkubmFtZSA9PSAnQUZfSU5FVCc6CiAgICAgICAgICAgICAgICAgICAgICAgIGludGVyZmFjZV9kYXRhW2ludGVyZmFjZV9uYW1lXVsnYWRkcmVzczQnXSA9IGFkZHIuYWRkcmVzcwogICAgICAgICAgICAgICAgICAgICAgICBpbnRlcmZhY2VfZGF0YVtpbnRlcmZhY2VfbmFtZV1bJ25ldG1hc2s0J10gPSBhZGRyLm5ldG1hc2sKICAgICAgICAgICAgICAgICAgICAgICAgaW50ZXJmYWNlX2RhdGFbaW50ZXJmYWNlX25hbWVdWydicm9hZGNhc3Q0J10gPSBhZGRyLmJyb2FkY2FzdAogICAgICAgICAgICAgICAgICAgIGVsaWYgYWRkci5mYW1pbHkubmFtZSA9PSAnQUZfSU5FVDYnOgogICAgICAgICAgICAgICAgICAgICAgICBpbnRlcmZhY2VfZGF0YVtpbnRlcmZhY2VfbmFtZV1bJ2FkZHJlc3M2J10gPSBhZGRyLmFkZHJlc3MKICAgICAgICAgICAgICAgICAgICAgICAgaW50ZXJmYWNlX2RhdGFbaW50ZXJmYWNlX25hbWVdWyduZXRtYXNrNiddID0gYWRkci5uZXRtYXNrCiAgICAgICAgICAgICAgICAgICAgICAgIGludGVyZmFjZV9kYXRhW2ludGVyZmFjZV9uYW1lXVsnYnJvYWRjYXN0NiddID0gYWRkci5icm9hZGNhc3QKCiAgICAgICAgICAgICAgICBuZXR3b3JrTGlzdC5hcHBlbmQoaW50ZXJmYWNlX2RhdGEpCgogICAgICAgIGRldmljZURhdGFEaWN0WyduZXR3b3JrTGlzdCddID0gbmV0d29ya0xpc3QKICAgICAgICBsb2dnZXIuaW5mbyhmJ05ldHdvcmsgZGF0YSBjb2xsZWN0ZWQ6IHtsZW4obmV0d29ya0xpc3QpfSBpbnRlcmZhY2VzJykKICAgICAgICByZXR1cm4gZGV2aWNlRGF0YURpY3QKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICBsb2dnZXIuZXJyb3IoZidFcnJvciBnZXR0aW5nIG5ldHdvcmsgZGF0YToge2V9JykKICAgICAgICBkZXZpY2VEYXRhRGljdFsnbmV0d29ya0xpc3QnXSA9IFtdCiAgICAgICAgcmV0dXJuIGRldmljZURhdGFEaWN0CgpkZWYgZ2V0VXNlckRhdGEoZGV2aWNlRGF0YURpY3QpOgogICAgIiIiR2V0IGxvZ2dlZC1pbiB1c2VycyIiIgogICAgdHJ5OgogICAgICAgIHVzZXJzID0gW10KICAgICAgICB1c2VyX2RpY3QgPSB7fQogICAgICAgIGZvciBpZHgsIHVzZXIgaW4gZW51bWVyYXRlKHBzdXRpbC51c2VycygpKToKICAgICAgICAgICAgdXNlcl9kaWN0W3N0cihpZHgpXSA9IHsKICAgICAgICAgICAgICAgICd1c2VybmFtZSc6IHVzZXIubmFtZSwKICAgICAgICAgICAgICAgICd0ZXJtaW5hbCc6IHVzZXIudGVybWluYWwgb3IgJ04vQScsCiAgICAgICAgICAgICAgICAnaG9zdCc6IHVzZXIuaG9zdCBvciAnTi9BJywKICAgICAgICAgICAgICAgICdsb2dnZWRJbic6IHVzZXIuc3RhcnRlZCwKICAgICAgICAgICAgICAgICdwaWQnOiB1c2VyLnBpZCBvciAwCiAgICAgICAgICAgIH0KICAgICAgICB1c2Vycy5hcHBlbmQodXNlcl9kaWN0KQoKICAgICAgICBkZXZpY2VEYXRhRGljdFsnVXNlcnMnXSA9IHVzZXJzCiAgICAgICAgbG9nZ2VyLmluZm8oZidVc2VyIGRhdGEgY29sbGVjdGVkOiB7bGVuKHVzZXJfZGljdCl9IHVzZXJzJykKICAgICAgICByZXR1cm4gZGV2aWNlRGF0YURpY3QKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICBsb2dnZXIuZXJyb3IoZidFcnJvciBnZXR0aW5nIHVzZXIgZGF0YToge2V9JykKICAgICAgICBkZXZpY2VEYXRhRGljdFsnVXNlcnMnXSA9IFtdCiAgICAgICAgcmV0dXJuIGRldmljZURhdGFEaWN0CgpkZWYgZ2V0QmF0dGVyeURhdGEoZGV2aWNlRGF0YURpY3QpOgogICAgIiIiR2V0IGJhdHRlcnkgaW5mb3JtYXRpb24iIiIKICAgIHRyeToKICAgICAgICBiYXR0ZXJ5ID0gcHN1dGlsLnNlbnNvcnNfYmF0dGVyeSgpCiAgICAgICAgaWYgYmF0dGVyeToKICAgICAgICAgICAgZGV2aWNlRGF0YURpY3RbJ2JhdHRlcnknXSA9IHsKICAgICAgICAgICAgICAgICdpbnN0YWxsZWQnOiBUcnVlLAogICAgICAgICAgICAgICAgJ3BjQ2hhcmdlZCc6IGJhdHRlcnkucGVyY2VudCwKICAgICAgICAgICAgICAgICdzZWNzTGVmdCc6IGJhdHRlcnkuc2Vjc2xlZnQgaWYgYmF0dGVyeS5zZWNzbGVmdCAhPSBwc3V0aWwuUE9XRVJfVElNRV9VTkxJTUlURUQgZWxzZSAnTi9BJywKICAgICAgICAgICAgICAgICdwb3dlclBsdWcnOiBiYXR0ZXJ5LnBvd2VyX3BsdWdnZWQKICAgICAgICAgICAgfQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGRldmljZURhdGFEaWN0WydiYXR0ZXJ5J10gPSB7CiAgICAgICAgICAgICAgICAnaW5zdGFsbGVkJzogRmFsc2UsCiAgICAgICAgICAgICAgICAncGNDaGFyZ2VkJzogMCwKICAgICAgICAgICAgICAgICdzZWNzTGVmdCc6ICdOL0EnLAogICAgICAgICAgICAgICAgJ3Bvd2VyUGx1Zyc6IFRydWUKICAgICAgICAgICAgfQogICAgICAgIGxvZ2dlci5pbmZvKGYnQmF0dGVyeSBkYXRhIGNvbGxlY3RlZCcpCiAgICAgICAgcmV0dXJuIGRldmljZURhdGFEaWN0CiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgbG9nZ2VyLmVycm9yKGYnRXJyb3IgZ2V0dGluZyBiYXR0ZXJ5IGRhdGE6IHtlfScpCiAgICAgICAgZGV2aWNlRGF0YURpY3RbJ2JhdHRlcnknXSA9IHsKICAgICAgICAgICAgJ2luc3RhbGxlZCc6IEZhbHNlLAogICAgICAgICAgICAncGNDaGFyZ2VkJzogMCwKICAgICAgICAgICAgJ3NlY3NMZWZ0JzogJ04vQScsCiAgICAgICAgICAgICdwb3dlclBsdWcnOiBUcnVlCiAgICAgICAgfQogICAgICAgIHJldHVybiBkZXZpY2VEYXRhRGljdAoKZGVmIGdldFVwdGltZURhdGEoZGV2aWNlRGF0YURpY3QpOgogICAgIiIiR2V0IHVwdGltZSBpbmZvcm1hdGlvbiIiIgogICAgdHJ5OgogICAgICAgIGJvb3RfdGltZSA9IHBzdXRpbC5ib290X3RpbWUoKQogICAgICAgIGRldmljZURhdGFEaWN0Wyd1cHRpbWUnXSA9IHsKICAgICAgICAgICAgJ2Jvb3RUaW1lJzogYm9vdF90aW1lLAogICAgICAgICAgICAndXB0aW1lU2Vjb25kcyc6IHRpbWUudGltZSgpIC0gYm9vdF90aW1lCiAgICAgICAgfQogICAgICAgIGxvZ2dlci5pbmZvKGYnVXB0aW1lIGRhdGEgY29sbGVjdGVkJykKICAgICAgICByZXR1cm4gZGV2aWNlRGF0YURpY3QKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICBsb2dnZXIuZXJyb3IoZidFcnJvciBnZXR0aW5nIHVwdGltZSBkYXRhOiB7ZX0nKQogICAgICAgIHJldHVybiBkZXZpY2VEYXRhRGljdAoKZGVmIGdldENvbGxlY3RvckRhdGEoZGV2aWNlRGF0YURpY3QpOgogICAgIiIiR2V0IGNvbGxlY3RvciB2ZXJzaW9uIGluZm9ybWF0aW9uIiIiCiAgICB0cnk6CiAgICAgICAgZGV2aWNlRGF0YURpY3RbJ2NvbGxlY3RvciddID0gewogICAgICAgICAgICAndmVyc2lvbic6ICcyLjAuMCcsCiAgICAgICAgICAgICd0eXBlJzogJ0xpbnV4QXVkaXQnLAogICAgICAgICAgICAndGltZXN0YW1wJzogZGF0ZXRpbWUuZGF0ZXRpbWUubm93KCkuaXNvZm9ybWF0KCkKICAgICAgICB9CiAgICAgICAgbG9nZ2VyLmluZm8oZidDb2xsZWN0b3IgZGF0YSBjb2xsZWN0ZWQnKQogICAgICAgIHJldHVybiBkZXZpY2VEYXRhRGljdAogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIGxvZ2dlci5lcnJvcihmJ0Vycm9yIGdldHRpbmcgY29sbGVjdG9yIGRhdGE6IHtlfScpCiAgICAgICAgcmV0dXJuIGRldmljZURhdGFEaWN0CgpkZWYgZ2V0RGV2aWNlRGF0YShkZXZpY2VEYXRhRGljdCwgZGV2aWNlVXVpZCk6CiAgICAiIiJHZXQgYmFzaWMgZGV2aWNlIGluZm9ybWF0aW9uIiIiCiAgICB0cnk6CiAgICAgICAgZGV2aWNlRGF0YURpY3RbJ2RldmljZSddID0gewogICAgICAgICAgICAnZGV2aWNlVXVpZCc6IGRldmljZVV1aWQsCiAgICAgICAgICAgICdzeXN0ZW10aW1lJzogdGltZS50aW1lKCkKICAgICAgICB9CiAgICAgICAgbG9nZ2VyLmluZm8oZidEZXZpY2UgZGF0YSBjb2xsZWN0ZWQnKQogICAgICAgIHJldHVybiBkZXZpY2VEYXRhRGljdAogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIGxvZ2dlci5lcnJvcihmJ0Vycm9yIGdldHRpbmcgZGV2aWNlIGRhdGE6IHtlfScpCiAgICAgICAgcmV0dXJuIGRldmljZURhdGFEaWN0CgpkZWYgZ2V0UGFydGl0aW9uRGF0YShkZXZpY2VEYXRhRGljdCk6CiAgICAiIiJHZXQgcGFydGl0aW9uIGluZm9ybWF0aW9uIiIiCiAgICB0cnk6CiAgICAgICAgcGFydGl0aW9ucyA9IFtdCiAgICAgICAgcGFydGl0aW9uX2RpY3QgPSB7fQogICAgICAgIGZvciBpZHgsIHBhcnRpdGlvbiBpbiBlbnVtZXJhdGUocHN1dGlsLmRpc2tfcGFydGl0aW9ucygpKToKICAgICAgICAgICAgcGFydGl0aW9uX2RpY3RbcGFydGl0aW9uLm1vdW50cG9pbnRdID0gewogICAgICAgICAgICAgICAgJ2RldmljZSc6IHBhcnRpdGlvbi5kZXZpY2UsCiAgICAgICAgICAgICAgICAnZnN0eXBlJzogcGFydGl0aW9uLmZzdHlwZQogICAgICAgICAgICB9CiAgICAgICAgcGFydGl0aW9ucy5hcHBlbmQocGFydGl0aW9uX2RpY3QpCgogICAgICAgIGRldmljZURhdGFEaWN0WydwYXJ0aXRpb25zJ10gPSBwYXJ0aXRpb25zCiAgICAgICAgbG9nZ2VyLmluZm8oZidQYXJ0aXRpb24gZGF0YSBjb2xsZWN0ZWQ6IHtsZW4ocGFydGl0aW9uX2RpY3QpfSBwYXJ0aXRpb25zJykKICAgICAgICByZXR1cm4gZGV2aWNlRGF0YURpY3QKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICBsb2dnZXIuZXJyb3IoZidFcnJvciBnZXR0aW5nIHBhcnRpdGlvbiBkYXRhOiB7ZX0nKQogICAgICAgIGRldmljZURhdGFEaWN0WydwYXJ0aXRpb25zJ10gPSBbXQogICAgICAgIHJldHVybiBkZXZpY2VEYXRhRGljdAoKZGVmIGdldEdwdUluZm8oZGV2aWNlRGF0YURpY3QpOgogICAgIiIiR2V0IEdQVSBpbmZvcm1hdGlvbiAoTGludXgtc3BlY2lmaWMpIiIiCiAgICB0cnk6CiAgICAgICAgdmVuZG9yID0gJ05vIGRhdGEgZm91bmQnCiAgICAgICAgcHJvZHVjdCA9ICdObyBkYXRhIGZvdW5kJwogICAgICAgIGNvbG91ckRlcHRoID0gLTEKICAgICAgICBoUmVzID0gLTEKICAgICAgICB2UmVzID0gLTEKCiAgICAgICAgIyBUcnkgbHNwY2kgZm9yIEdQVSBpbmZvCiAgICAgICAgdHJ5OgogICAgICAgICAgICByZXN1bHQgPSBzdWJwcm9jZXNzLnJ1bigKICAgICAgICAgICAgICAgIFsnbHNwY2knXSwKICAgICAgICAgICAgICAgIHN0ZG91dD1zdWJwcm9jZXNzLlBJUEUsCiAgICAgICAgICAgICAgICB1bml2ZXJzYWxfbmV3bGluZXM9VHJ1ZSwKICAgICAgICAgICAgICAgIHRpbWVvdXQ9MTAKICAgICAgICAgICAgKQogICAgICAgICAgICBmb3IgbGluZSBpbiByZXN1bHQuc3Rkb3V0LnNwbGl0bGluZXMoKToKICAgICAgICAgICAgICAgIGlmICdWR0EnIGluIGxpbmUgb3IgJ0Rpc3BsYXknIGluIGxpbmU6CiAgICAgICAgICAgICAgICAgICAgcGFydHMgPSBsaW5lLnNwbGl0KCc6ICcpCiAgICAgICAgICAgICAgICAgICAgaWYgbGVuKHBhcnRzKSA+IDE6CiAgICAgICAgICAgICAgICAgICAgICAgIHByb2R1Y3QgPSBwYXJ0c1sxXQogICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwYXNzCgogICAgICAgIGRldmljZURhdGFEaWN0WydncHVpbmZvJ10gPSB7CiAgICAgICAgICAgICdncHV2ZW5kb3InOiB2ZW5kb3IsCiAgICAgICAgICAgICdncHVwcm9kdWN0JzogcHJvZHVjdCwKICAgICAgICAgICAgJ2dwdWNvbG91cic6IGNvbG91ckRlcHRoLAogICAgICAgICAgICAnZ3B1aHJlcyc6IGhSZXMsCiAgICAgICAgICAgICdncHV2cmVzJzogdlJlcwogICAgICAgIH0KICAgICAgICBsb2dnZXIuaW5mbyhmJ0dQVSBpbmZvIGNvbGxlY3RlZCcpCiAgICAgICAgcmV0dXJuIGRldmljZURhdGFEaWN0CiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgbG9nZ2VyLmVycm9yKGYnRXJyb3IgZ2V0dGluZyBHUFUgaW5mbzoge2V9JykKICAgICAgICBkZXZpY2VEYXRhRGljdFsnZ3B1aW5mbyddID0gewogICAgICAgICAgICAnZ3B1dmVuZG9yJzogJ05vIGRhdGEgZm91bmQnLAogICAgICAgICAgICAnZ3B1cHJvZHVjdCc6ICdObyBkYXRhIGZvdW5kJywKICAgICAgICAgICAgJ2dwdWNvbG91cic6IC0xLAogICAgICAgICAgICAnZ3B1aHJlcyc6IC0xLAogICAgICAgICAgICAnZ3B1dnJlcyc6IC0xCiAgICAgICAgfQogICAgICAgIHJldHVybiBkZXZpY2VEYXRhRGljdAoKZGVmIGdldE1hbnVmYWN0dXJlcihkZXZpY2VEYXRhRGljdCk6CiAgICAiIiJHZXQgc3lzdGVtIG1hbnVmYWN0dXJlciIiIgogICAgdHJ5OgogICAgICAgIG1hbnVmYWN0dXJlciA9ICdVbmtub3duJwogICAgICAgICMgVHJ5IGRtaWRlY29kZQogICAgICAgIHRyeToKICAgICAgICAgICAgcmVzdWx0ID0gc3VicHJvY2Vzcy5ydW4oCiAgICAgICAgICAgICAgICBbJ3N1ZG8nLCAnZG1pZGVjb2RlJywgJy1zJywgJ3N5c3RlbS1tYW51ZmFjdHVyZXInXSwKICAgICAgICAgICAgICAgIHN0ZG91dD1zdWJwcm9jZXNzLlBJUEUsCiAgICAgICAgICAgICAgICB1bml2ZXJzYWxfbmV3bGluZXM9VHJ1ZSwKICAgICAgICAgICAgICAgIHRpbWVvdXQ9MTAKICAgICAgICAgICAgKQogICAgICAgICAgICBtYW51ZmFjdHVyZXIgPSByZXN1bHQuc3Rkb3V0LnN0cmlwKCkgb3IgJ1Vua25vd24nCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwYXNzCgogICAgICAgIGRldmljZURhdGFEaWN0WydtYW51ZmFjdHVyZXInXSA9IG1hbnVmYWN0dXJlcgogICAgICAgIGxvZ2dlci5pbmZvKGYnTWFudWZhY3R1cmVyOiB7bWFudWZhY3R1cmVyfScpCiAgICAgICAgcmV0dXJuIGRldmljZURhdGFEaWN0CiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgbG9nZ2VyLmVycm9yKGYnRXJyb3IgZ2V0dGluZyBtYW51ZmFjdHVyZXI6IHtlfScpCiAgICAgICAgZGV2aWNlRGF0YURpY3RbJ21hbnVmYWN0dXJlciddID0gJ1Vua25vd24nCiAgICAgICAgcmV0dXJuIGRldmljZURhdGFEaWN0CgpkZWYgZ2V0T3NMYW5nKGRldmljZURhdGFEaWN0KToKICAgICIiIkdldCBPUyBsYW5ndWFnZSIiIgogICAgdHJ5OgogICAgICAgIG9zTGFuZyA9ICdVbmtub3duJwogICAgICAgIHRyeToKICAgICAgICAgICAgcmVzdWx0ID0gc3VicHJvY2Vzcy5ydW4oCiAgICAgICAgICAgICAgICBbJ2xvY2FsZSddLAogICAgICAgICAgICAgICAgc3Rkb3V0PXN1YnByb2Nlc3MuUElQRSwKICAgICAgICAgICAgICAgIHVuaXZlcnNhbF9uZXdsaW5lcz1UcnVlLAogICAgICAgICAgICAgICAgdGltZW91dD0xMAogICAgICAgICAgICApCiAgICAgICAgICAgIGZvciBsaW5lIGluIHJlc3VsdC5zdGRvdXQuc3BsaXRsaW5lcygpOgogICAgICAgICAgICAgICAgaWYgJ0xBTkc9JyBpbiBsaW5lOgogICAgICAgICAgICAgICAgICAgIG9zTGFuZyA9IGxpbmUuc3BsaXQoJz0nKVsxXQogICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwYXNzCgogICAgICAgIGRldmljZURhdGFEaWN0Wydvc0xhbmcnXSA9IG9zTGFuZwogICAgICAgIGxvZ2dlci5pbmZvKGYnT1MgTGFuZ3VhZ2U6IHtvc0xhbmd9JykKICAgICAgICByZXR1cm4gZGV2aWNlRGF0YURpY3QKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICBsb2dnZXIuZXJyb3IoZidFcnJvciBnZXR0aW5nIE9TIGxhbmd1YWdlOiB7ZX0nKQogICAgICAgIGRldmljZURhdGFEaWN0Wydvc0xhbmcnXSA9ICdVbmtub3duJwogICAgICAgIHJldHVybiBkZXZpY2VEYXRhRGljdAoKZGVmIGdldFNtQmlvc0luZm8oZGV2aWNlRGF0YURpY3QpOgogICAgIiIiR2V0IFNNQklPUyBpbmZvcm1hdGlvbiAoTGludXgtc3BlY2lmaWMpIiIiCiAgICB0cnk6CiAgICAgICAgc21iaW9zX2RpY3QgPSB7fQogICAgICAgIHRyeToKICAgICAgICAgICAgcmVzdWx0ID0gc3VicHJvY2Vzcy5ydW4oCiAgICAgICAgICAgICAgICBbJ3N1ZG8nLCAnZG1pZGVjb2RlJ10sCiAgICAgICAgICAgICAgICBzdGRvdXQ9c3VicHJvY2Vzcy5QSVBFLAogICAgICAgICAgICAgICAgdW5pdmVyc2FsX25ld2xpbmVzPVRydWUsCiAgICAgICAgICAgICAgICB0aW1lb3V0PTEwCiAgICAgICAgICAgICkKICAgICAgICAgICAgZm9yIGxpbmUgaW4gcmVzdWx0LnN0ZG91dC5zcGxpdGxpbmVzKCk6CiAgICAgICAgICAgICAgICBpZiAnU2VyaWFsIE51bWJlcicgaW4gbGluZToKICAgICAgICAgICAgICAgICAgICBzbWJpb3NfZGljdFsnc2VyaWFsTnVtYmVyJ10gPSBsaW5lLnNwbGl0KCc6JylbMV0uc3RyaXAoKQogICAgICAgICAgICAgICAgaWYgJ0NoYXNzaXMgVHlwZScgaW4gbGluZToKICAgICAgICAgICAgICAgICAgICBzbWJpb3NfZGljdFsnY2hhc3Npc1R5cGUnXSA9IGxpbmUuc3BsaXQoJzonKVsxXS5zdHJpcCgpCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwYXNzCgogICAgICAgIGRldmljZURhdGFEaWN0WydzbWJpb3MnXSA9IHNtYmlvc19kaWN0CiAgICAgICAgbG9nZ2VyLmluZm8oZidTTUJJT1MgaW5mbyBjb2xsZWN0ZWQnKQogICAgICAgIHJldHVybiBkZXZpY2VEYXRhRGljdAogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIGxvZ2dlci5lcnJvcihmJ0Vycm9yIGdldHRpbmcgU01CSU9TIGluZm86IHtlfScpCiAgICAgICAgZGV2aWNlRGF0YURpY3RbJ3NtYmlvcyddID0ge30KICAgICAgICByZXR1cm4gZGV2aWNlRGF0YURpY3QKCmRlZiBnZXRTeXN0ZW1Nb2RlbChkZXZpY2VEYXRhRGljdCk6CiAgICAiIiJHZXQgc3lzdGVtIG1vZGVsIiIiCiAgICB0cnk6CiAgICAgICAgbW9kZWwgPSAnVW5rbm93bicKICAgICAgICB0cnk6CiAgICAgICAgICAgIHJlc3VsdCA9IHN1YnByb2Nlc3MucnVuKAogICAgICAgICAgICAgICAgWydzdWRvJywgJ2RtaWRlY29kZScsICctcycsICdzeXN0ZW0tcHJvZHVjdC1uYW1lJ10sCiAgICAgICAgICAgICAgICBzdGRvdXQ9c3VicHJvY2Vzcy5QSVBFLAogICAgICAgICAgICAgICAgdW5pdmVyc2FsX25ld2xpbmVzPVRydWUsCiAgICAgICAgICAgICAgICB0aW1lb3V0PTEwCiAgICAgICAgICAgICkKICAgICAgICAgICAgbW9kZWwgPSByZXN1bHQuc3Rkb3V0LnN0cmlwKCkgb3IgJ1Vua25vd24nCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwYXNzCgogICAgICAgIGRldmljZURhdGFEaWN0WydzeXN0ZW1Nb2RlbCddID0gbW9kZWwKICAgICAgICBsb2dnZXIuaW5mbyhmJ1N5c3RlbSBNb2RlbDoge21vZGVsfScpCiAgICAgICAgcmV0dXJuIGRldmljZURhdGFEaWN0CiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgbG9nZ2VyLmVycm9yKGYnRXJyb3IgZ2V0dGluZyBzeXN0ZW0gbW9kZWw6IHtlfScpCiAgICAgICAgZGV2aWNlRGF0YURpY3RbJ3N5c3RlbU1vZGVsJ10gPSAnVW5rbm93bicKICAgICAgICByZXR1cm4gZGV2aWNlRGF0YURpY3QKCmRlZiBnZXRQcmludGVycyhkZXZpY2VEYXRhRGljdCk6CiAgICAiIiJHZXQgcHJpbnRlciBpbmZvcm1hdGlvbiIiIgogICAgdHJ5OgogICAgICAgIHByaW50ZXJzID0gW10KICAgICAgICB0cnk6CiAgICAgICAgICAgIHJlc3VsdCA9IHN1YnByb2Nlc3MucnVuKAogICAgICAgICAgICAgICAgWydscHN0YXQnLCAnLXAnLCAnLWQnXSwKICAgICAgICAgICAgICAgIHN0ZG91dD1zdWJwcm9jZXNzLlBJUEUsCiAgICAgICAgICAgICAgICB1bml2ZXJzYWxfbmV3bGluZXM9VHJ1ZSwKICAgICAgICAgICAgICAgIHRpbWVvdXQ9MTAKICAgICAgICAgICAgKQogICAgICAgICAgICBmb3IgbGluZSBpbiByZXN1bHQuc3Rkb3V0LnNwbGl0bGluZXMoKToKICAgICAgICAgICAgICAgIGlmICdwcmludGVyJyBpbiBsaW5lLmxvd2VyKCk6CiAgICAgICAgICAgICAgICAgICAgcHJpbnRlcnMuYXBwZW5kKGxpbmUuc3RyaXAoKSkKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHBhc3MKCiAgICAgICAgZGV2aWNlRGF0YURpY3RbJ3ByaW50ZXJzJ10gPSBwcmludGVycwogICAgICAgIGxvZ2dlci5pbmZvKGYnUHJpbnRlcnMgY29sbGVjdGVkOiB7bGVuKHByaW50ZXJzKX0nKQogICAgICAgIHJldHVybiBkZXZpY2VEYXRhRGljdAogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIGxvZ2dlci5lcnJvcihmJ0Vycm9yIGdldHRpbmcgcHJpbnRlcnM6IHtlfScpCiAgICAgICAgZGV2aWNlRGF0YURpY3RbJ3ByaW50ZXJzJ10gPSBbXQogICAgICAgIHJldHVybiBkZXZpY2VEYXRhRGljdAoKZGVmIGdldFVzYkRldmljZXMoZGV2aWNlRGF0YURpY3QpOgogICAgIiIiR2V0IFVTQiBkZXZpY2UgaW5mb3JtYXRpb24iIiIKICAgIHRyeToKICAgICAgICB1c2JfZGV2aWNlcyA9IFtdCiAgICAgICAgdHJ5OgogICAgICAgICAgICByZXN1bHQgPSBzdWJwcm9jZXNzLnJ1bigKICAgICAgICAgICAgICAgIFsnbHN1c2InXSwKICAgICAgICAgICAgICAgIHN0ZG91dD1zdWJwcm9jZXNzLlBJUEUsCiAgICAgICAgICAgICAgICB1bml2ZXJzYWxfbmV3bGluZXM9VHJ1ZSwKICAgICAgICAgICAgICAgIHRpbWVvdXQ9MTAKICAgICAgICAgICAgKQogICAgICAgICAgICB1c2JfZGV2aWNlcyA9IHJlc3VsdC5zdGRvdXQuc3BsaXRsaW5lcygpCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwYXNzCgogICAgICAgIGRldmljZURhdGFEaWN0Wyd1c2JEZXZpY2VzJ10gPSB1c2JfZGV2aWNlcwogICAgICAgIGxvZ2dlci5pbmZvKGYnVVNCIGRldmljZXMgY29sbGVjdGVkOiB7bGVuKHVzYl9kZXZpY2VzKX0nKQogICAgICAgIHJldHVybiBkZXZpY2VEYXRhRGljdAogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIGxvZ2dlci5lcnJvcihmJ0Vycm9yIGdldHRpbmcgVVNCIGRldmljZXM6IHtlfScpCiAgICAgICAgZGV2aWNlRGF0YURpY3RbJ3VzYkRldmljZXMnXSA9IFtdCiAgICAgICAgcmV0dXJuIGRldmljZURhdGFEaWN0CgpkZWYgZ2V0UGNpRGV2aWNlcyhkZXZpY2VEYXRhRGljdCk6CiAgICAiIiJHZXQgUENJIGRldmljZSBpbmZvcm1hdGlvbiAoTGludXgtc3BlY2lmaWMpIiIiCiAgICB0cnk6CiAgICAgICAgcGNpX2RldmljZXMgPSBbXQogICAgICAgIHRyeToKICAgICAgICAgICAgcmVzdWx0ID0gc3VicHJvY2Vzcy5ydW4oCiAgICAgICAgICAgICAgICBbJ2xzcGNpJ10sCiAgICAgICAgICAgICAgICBzdGRvdXQ9c3VicHJvY2Vzcy5QSVBFLAogICAgICAgICAgICAgICAgdW5pdmVyc2FsX25ld2xpbmVzPVRydWUsCiAgICAgICAgICAgICAgICB0aW1lb3V0PTEwCiAgICAgICAgICAgICkKICAgICAgICAgICAgcGNpX2RldmljZXMgPSByZXN1bHQuc3Rkb3V0LnNwbGl0bGluZXMoKQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcGFzcwoKICAgICAgICBkZXZpY2VEYXRhRGljdFsncGNpRGV2aWNlcyddID0gcGNpX2RldmljZXMKICAgICAgICBsb2dnZXIuaW5mbyhmJ1BDSSBkZXZpY2VzIGNvbGxlY3RlZDoge2xlbihwY2lfZGV2aWNlcyl9JykKICAgICAgICByZXR1cm4gZGV2aWNlRGF0YURpY3QKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICBsb2dnZXIuZXJyb3IoZidFcnJvciBnZXR0aW5nIFBDSSBkZXZpY2VzOiB7ZX0nKQogICAgICAgIGRldmljZURhdGFEaWN0WydwY2lEZXZpY2VzJ10gPSBbXQogICAgICAgIHJldHVybiBkZXZpY2VEYXRhRGljdAoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyBNQUlOIEVYRUNVVElPTiAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgppZiBfX25hbWVfXyA9PSAnX19tYWluX18nOgogICAgaWYgZGVidWdNb2RlOgogICAgICAgIGxvZ2dlci5pbmZvKCdMaW51eEF1ZGl0IFN0YXJ0aW5nLi4uJykKCiAgICAjIFNldHVwIGRpcmVjdG9yaWVzCiAgICBhcHBEaXIsIGxvZ0RpciwgY29uZmlnRGlyLCB0ZW1wRGlyLCBmaWxlc0RpciA9IGdldEFwcERpcnMoKQoKICAgICMgR2V0IGRldmljZSBVVUlEIGFuZCBob3N0CiAgICBhZ2VudENvbmZpZ0ZpbGUgPSBvcy5wYXRoLmpvaW4oY29uZmlnRGlyLCAnYWdlbnQuY29uZmlnJykKICAgIGRldmljZVV1aWQsIGhvc3QgPSBnZXREZXZpY2VVdWlkKGFnZW50Q29uZmlnRmlsZSkKCiAgICAjIENvbGxlY3QgYWxsIGRhdGEKICAgIGRldmljZURhdGFEaWN0ID0ge30KICAgIGRldmljZURhdGFEaWN0ID0gZ2V0RGV2aWNlRGF0YShkZXZpY2VEYXRhRGljdCwgZGV2aWNlVXVpZCkKICAgIGRldmljZURhdGFEaWN0ID0gZ2V0U3lzdGVtRGF0YShkZXZpY2VEYXRhRGljdCkKICAgIGRldmljZURhdGFEaWN0ID0gZ2V0RGlza1N0YXRzKGRldmljZURhdGFEaWN0KQogICAgZGV2aWNlRGF0YURpY3QgPSBnZXROZXR3b3JrRGF0YShkZXZpY2VEYXRhRGljdCkKICAgIGRldmljZURhdGFEaWN0ID0gZ2V0VXNlckRhdGEoZGV2aWNlRGF0YURpY3QpCiAgICBkZXZpY2VEYXRhRGljdCA9IGdldFVwdGltZURhdGEoZGV2aWNlRGF0YURpY3QpCiAgICBkZXZpY2VEYXRhRGljdCA9IGdldEJhdHRlcnlEYXRhKGRldmljZURhdGFEaWN0KQogICAgZGV2aWNlRGF0YURpY3QgPSBnZXRNZW1vcnlEYXRhKGRldmljZURhdGFEaWN0KQogICAgZGV2aWNlRGF0YURpY3QgPSBnZXRDb2xsZWN0b3JEYXRhKGRldmljZURhdGFEaWN0KQogICAgZGV2aWNlRGF0YURpY3QgPSBnZXRNYW51ZmFjdHVyZXIoZGV2aWNlRGF0YURpY3QpCiAgICBkZXZpY2VEYXRhRGljdCA9IGdldE9zTGFuZyhkZXZpY2VEYXRhRGljdCkKICAgIGRldmljZURhdGFEaWN0ID0gZ2V0Q3B1SW5mbyhkZXZpY2VEYXRhRGljdCkKICAgIGRldmljZURhdGFEaWN0ID0gZ2V0R3B1SW5mbyhkZXZpY2VEYXRhRGljdCkKICAgIGRldmljZURhdGFEaWN0ID0gZ2V0U21CaW9zSW5mbyhkZXZpY2VEYXRhRGljdCkKICAgIGRldmljZURhdGFEaWN0ID0gZ2V0U3lzdGVtTW9kZWwoZGV2aWNlRGF0YURpY3QpCiAgICBkZXZpY2VEYXRhRGljdCA9IGdldFByaW50ZXJzKGRldmljZURhdGFEaWN0KQogICAgZGV2aWNlRGF0YURpY3QgPSBnZXRVc2JEZXZpY2VzKGRldmljZURhdGFEaWN0KQogICAgZGV2aWNlRGF0YURpY3QgPSBnZXRQY2lEZXZpY2VzKGRldmljZURhdGFEaWN0KQogICAgZGV2aWNlRGF0YURpY3QgPSBnZXRQYXJ0aXRpb25EYXRhKGRldmljZURhdGFEaWN0KQoKICAgICMgVXBkYXRlIGRldmljZSBVVUlEIGluIHBheWxvYWQKICAgIGRldmljZURhdGFEaWN0WydkZXZpY2UnXVsnZGV2aWNlVXVpZCddID0gZGV2aWNlVXVpZAoKICAgICMgU2VuZCBwYXlsb2FkCiAgICByb3V0ZSA9ICcvcGF5bG9hZC9zZW5kYXVkaXQnCiAgICBwYXlsb2FkID0geydkYXRhJzogZGV2aWNlRGF0YURpY3R9CgogICAgaWYgZGVidWdNb2RlOgogICAgICAgIGxvZ2dlci5pbmZvKGYnUGF5bG9hZDoge2pzb24uZHVtcHMocGF5bG9hZCwgaW5kZW50PTIsIGRlZmF1bHQ9c3RyKX0nKQoKICAgIHJlc3BvbnNlID0gc2VuZEpzb25QYXlsb2FkRmxhc2socGF5bG9hZCwgcm91dGUsIGhvc3QsIGRlYnVnTW9kZSkKICAgIGxvZ2dlci5pbmZvKGYnU2VydmVyIHJlc3BvbnNlOiB7cmVzcG9uc2Uuc3RhdHVzX2NvZGV9IHwge3Jlc3BvbnNlLnRleHR9JykKCg=="
  }
}