{"settings": {"snippetUuid": "a91878f9-bdf5-43aa-a3e8-ebc5f086bc5f", "snippetname": "MacAudit", "snippettype": ".py", "created_at": 1751799310}, "payload": {"payloadsig": "jyuID30y0nlrPw1XRa0FLXt6S6vLlh4GzsShxjNJliIY4vkPhV3KhBrRKIyEIb7l+SqjXjPKQrdngOCoLfUhU7kAvG0uSWFw9cRFq+rgvHxDh6sEBKzRveV5rzXAFSVQ1Epxx46obBGHhi6OvMXUp8rmaHPPjM7F/yohqK7dg+3oPKDB9yBsDO1x+JHGOKTFhKabHggHzUcKL/K6Vlu+u4rvu+2VJHLeXTn5tC+G5EbDJEV1Qi79xyIISbqdzoSbJnvHrjBEfpVbUnLBq3u+5madBSBUGWeBYgEIPIiMhYvanrzFQc5h8kdnnZ/MKuLsIUwxsuvuGZ4Lj3yTg27J8k2w0ubKbGhdZmoVWhgWVDJ+aMbcuJ4JGK8zAaYYXUsvFUp+ZmebQk4D9svOubZYtxpDQYBD9uol1Q/mdDdeCihfDm0oCCxbbrza5sW5jzM3LXxp9uDt5luPyZH3fYn3TTdqBxnxTyITbCqT+DQSXA4U17NsLMDe45hJRXNr2Al1OilD+ftOCBtl95Wa2Oe8Z9o4C2bBPguL1MeS0d+WEDexaRrnF6GpBEJqCcm2Ab6Sa+nV4gnBr6eOBEL9AuMUCKam8vBg9HsFS8+AuJzfxx2QX1jwzciMrk1zQoGF+NXA7eMZGwKQNmwMAFpt6YnZCM9hclozxpc2s9FGsnKZUOc=", "payloadb64": "IyBGaWxlcGF0aDogc25pcHBldHMvdW5TaWduZWQvZnVsbEF1ZGl0LnB5CiMgRmlsZXBhdGg6IGNvbGxlY3Rvci9jb2xsZWN0b3IucHkKaW1wb3J0IHNvY2tldAppbXBvcnQganNvbgppbXBvcnQgb3MKaW1wb3J0IHBsYXRmb3JtCmltcG9ydCB0aW1lCmltcG9ydCBnZXRwYXNzCmltcG9ydCBzaHV0aWwKaW1wb3J0IG1hdGgKaW1wb3J0IGFyZ3BhcnNlCmltcG9ydCBzeXMKaW1wb3J0IGRhdGV0aW1lCmltcG9ydCBzdWJwcm9jZXNzCmltcG9ydCBoYXNobGliCnRyeToKCWZyb20gbG9nemVybyBpbXBvcnQgbG9nZ2VyLCBsb2dmaWxlCmV4Y2VwdCBFeGNlcHRpb24gYXMgZToKCXN1YnByb2Nlc3MuY2hlY2tfY2FsbChbc3lzLmV4ZWN1dGFibGUsICctbScsICdwaXAnLCAnaW5zdGFsbCcsICdsb2d6ZXJvJ10pCglmcm9tIGxvZ3plcm8gaW1wb3J0IGxvZ2dlciwgbG9nZmlsZQp0cnk6CglpbXBvcnQgcHN1dGlsCmV4Y2VwdCBFeGNlcHRpb24gYXMgZToKCXN1YnByb2Nlc3MuY2hlY2tfY2FsbChbc3lzLmV4ZWN1dGFibGUsICctbScsICdwaXAnLCAnaW5zdGFsbCcsICdwc3V0aWwnXSkKCWltcG9ydCBwc3V0aWwKdHJ5OgoJaW1wb3J0IHJlcXVlc3RzCmV4Y2VwdCBFeGNlcHRpb24gYXMgZToKCXN1YnByb2Nlc3MuY2hlY2tfY2FsbChbc3lzLmV4ZWN1dGFibGUsICctbScsICdwaXAnLCAnaW5zdGFsbCcsICdyZXF1ZXN0cyddKQoJaW1wb3J0IHJlcXVlc3RzCnRyeToKCWltcG9ydCBkbnMucmVzb2x2ZXIKZXhjZXB0OgoJc3VicHJvY2Vzcy5jaGVja19jYWxsKFtzeXMuZXhlY3V0YWJsZSwgJy1tJywgJ3BpcCcsICdpbnN0YWxsJywgJ2Ruc3B5dGhvbiddKQoJaW1wb3J0IGRucy5yZXNvbHZlcgojIG1hY09TLXNwZWNpZmljIGltcG9ydHMgLSBub25lIG5lZWRlZCBmb3IgYmFzaWMgZnVuY3Rpb25hbGl0eQoKCgoKCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMgRlVOQ1RJT05TICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCiMgZGVmIHBhcnNlQXJncygpOgojIAlwYXJzZXIgPSBhcmdwYXJzZS5Bcmd1bWVudFBhcnNlcigpCiMgCXBhcnNlci5hZGRfYXJndW1lbnQoIi10IiwgIi0tdGVtcERpciIsIAkJaGVscCA9ICJFbnRlciB0ZW1wIGRpcmVjdG9yeSIsIAlyZXF1aXJlZD1UcnVlKQojIAlwYXJzZXIuYWRkX2FyZ3VtZW50KCItbSIsICItLW1vZGUiLCAJCWhlbHAgPSAiRW50ZXIgbW9kZSAtIGF1ZGl0IiwgCXJlcXVpcmVkPUZhbHNlKQkKIyAJcGFyc2VyLmFkZF9hcmd1bWVudCgiLWciLCAiLS1ncm91cFV1aWQiLAloZWxwID0gIkVudGVyIGdyb3VwVXVpZCIsCQlyZXF1aXJlZD1GYWxzZSkJCSAKIyAJcGFyc2VyLmFkZF9hcmd1bWVudCgiLXYiLCAiLS12ZXJzaW9uIiwJCWhlbHAgPSAiRGlzcGxheSB0aGUgdmVyc2lvbiIsIAlhY3Rpb249J3N0b3JlX3RydWUnKQojIAlhcmdzID0gcGFyc2VyLnBhcnNlX2FyZ3MoKQkKIyAJcmV0dXJuKGFyZ3MpCgpkZWYgY29udmVydFNpemUoc2l6ZUJ5dGVzKToKCWlmIHNpemVCeXRlcyA9PSAwOgoJCXJldHVybiAiMCBCIgoJc2l6ZU5hbWUgPSAoIkIiLCAiS0IiLCAiTUIiLCAiR0IiLCAiVEIiLCAiUEIiLCAiRUIiLCAiWkIiLCAiWUIiKQoJaSA9IGludChtYXRoLmZsb29yKG1hdGgubG9nKHNpemVCeXRlcywgMTAyNCkpKQoJcCA9IG1hdGgucG93KDEwMjQsIGkpCglzID0gcm91bmQoc2l6ZUJ5dGVzIC8gcCwgMikKCXJldHVybiAoZid7c30ge3NpemVOYW1lW2ldfScpCgpkZWYgc2VuZEpzb25QYXlsb2FkRmxhc2socGF5bG9hZCwgZW5kcG9pbnQpOgoJdXJsIAkJPSBmJ2h0dHBzOi8ve2hvc3R9e2VuZHBvaW50fScKCWlmIGRlYnVnTW9kZSA9PSBUcnVlOgoJCWxvZ2dlci5kZWJ1ZyhmJ3BheWxvYWQgdG8gc2VuZDoge3BheWxvYWR9JykKCQlsb2dnZXIuZGVidWcoZidBdHRlbXB0aW5nIHRvIGNvbm5lY3QgdG8ge3VybH0nKQoJaGVhZGVycyAJPSB7J0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ30KCXJlc3BvbnNlIAk9IHJlcXVlc3RzLnBvc3QodXJsLCBoZWFkZXJzPWhlYWRlcnMsIGRhdGE9anNvbi5kdW1wcyhwYXlsb2FkKSkKCXJldHVybihyZXNwb25zZSkKCmRlZiBnZXRQdWJsaWNJcEFkZHIoKToKCW9kRG5zU2VydmVyIAkJCT0gJzIwOC42Ny4yMjIuMjIyJwoJaHR0cERuc1NlcnZlcgkJCT0gJ2h0dHBzOi8vaWNhbmhhemlwLmNvbScKCWRuc1Jlc29sdmVyIAkJCT0gZG5zLnJlc29sdmVyLlJlc29sdmVyKCkKCWRuc1Jlc29sdmVyLm5hbWVzZXJ2ZXJzID0gW29kRG5zU2VydmVyXQoJdHJ5OgoJCWFuc3dlcnMgCQkJPSBkbnNSZXNvbHZlci5yZXNvbHZlKCdteWlwLm9wZW5kbnMuY29tJywgJ0EnKQoJCWZvciBwdWJsaWNJcCBpbiBhbnN3ZXJzOgoJCQlwdWJsaWNJcCA9IHB1YmxpY0lwLnRvX3RleHQoKQoJZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgoJCWxvZ2dlci5lcnJvcihmJ0ZhaWxlZCB0byBnZXQgcHVibGljSVAgZnJvbSB7b2REbnNTZXJ2ZXJ9LiBSZWFzb246IHtlfScpCgkJcHVibGljSXAgPSBOb25lCglpZiBub3QgcHVibGljSXA6CgkJdHJ5OgoJCQlyIAkJCT0gcmVxdWVzdHMuZ2V0KGh0dHBEbnNTZXJ2ZXIpCgkJCWxvZ2dlci5pbmZvKGYncnRleHQ6IHtyLnRleHR9JykKCQkJcHVibGljSXAgCT0gci50ZXh0LnN0cmlwKCkKCQlleGNlcHQgRXhjZXB0aW9uIGFzIGU6CgkJCWxvZ2dlci5lcnJvcihmJ0ZhaWxlZCB0byBnZXQgcHVibGljSVAgZnJvbSB7aHR0cERuc1NlcnZlcn0uIFJlYXNvbjoge2V9JykKCQkJcHVibGljSXAgPSBOb25lCglpZiBub3QgcHVibGljSXA6CgkJcHVibGljSXAgPSAnMC4wLjAuMCcKCXJldHVybihwdWJsaWNJcCkKCmRlZiBnZXRVc2VySG9tZVBhdGgoKToKCXVzZXJIb21lUGF0aCAJPSBvcy5wYXRoLmV4cGFuZHVzZXIoIn4iKQoJbG9nZ2VyLmluZm8oZid1c2VySG9tZVBhdGg6IHt1c2VySG9tZVBhdGh9JykKCXJldHVybih1c2VySG9tZVBhdGgpCgpkZWYgZ2V0RGV2aWNlVXVpZChjb25maWdGaWxlKToKCWxvZ2dlci5pbmZvKGYnQXR0ZW1wdGluZyB0byByZWFkIGNvbmZpZyBmaWxlOiB7Y29uZmlnRmlsZX0uLi4nKQoJaWYgb3MucGF0aC5pc2ZpbGUoY29uZmlnRmlsZSk6CgkJdHJ5OgoJCQl3aXRoIG9wZW4oY29uZmlnRmlsZSwgJ3InKSBhcyBmOgoJCQkJY29uZmlnRGljdCA9IGpzb24ubG9hZChmKQoJCQlsb2dnZXIuaW5mbyhmJ1N1Y2Nlc3NmdWxseSByZWFkIHtjb25maWdGaWxlfScpCgkJZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgoJCQlsb2dnZXIuZXJyb3IoZidGYWlsZWQgdG8gcmVhZCB7Y29uZmlnRmlsZX0nKQoJCQlxdWl0KCdRdWl0dGluZy4nKQoJCWRldmljZVV1aWQgCT0gY29uZmlnRGljdFsnZGV2aWNldXVpZCddCgkJaWYgJ3NlcnZlckFkZHInIGluIGNvbmZpZ0RpY3Q6CgkJCWhvc3QgPSBjb25maWdEaWN0WydzZXJ2ZXJBZGRyJ10KCQllbHNlOgoJCQlob3N0ID0gJ2FwcC53ZWd3ZWlzZXIudGVjaCcKCWVsc2U6CgkJbG9nZ2VyLmVycm9yKGYne2NvbmZpZ0ZpbGV9IGRvZXMgbm90IGV4aXN0LiBRdWl0dGluZy4nKQoJcmV0dXJuKGRldmljZVV1aWQsIGhvc3QpCgojIGRlZiB3cml0ZVdlZ0NvbmZpZ0ZpbGUoZGV2aWNldXVpZCwgZ3JvdXB1dWlkKToKIyAJY29uZmlnRGljdCA9IHsnZGV2aWNldXVpZCc6ZGV2aWNldXVpZCwgJ2dyb3VwdXVpZCc6Z3JvdXB1dWlkfQojIAlsb2dnZXIuaW5mbyhmJ0F0dGVtcHRpbmcgdG8gd3JpdGUgdG8ge3dlZ0NvbmZpZ0ZpbGV9JykKIyAJd2l0aCBvcGVuKHdlZ0NvbmZpZ0ZpbGUsICd3JykgYXMgZjoKIyAJCWYud3JpdGUoanNvbi5kdW1wcyhjb25maWdEaWN0LCBpbmRlbnQ9NCkpCiMgCWxvZ2dlci5pbmZvKGYne3dlZ0NvbmZpZ0ZpbGV9IHdyaXR0ZW4gc3VjY2Vzc2Z1bGx5LicpCgojIGRlZiByZWdpc3RlckRldmljZShncm91cHV1aWQpOgojIAllbmRwb2ludCAJCT0gJy9kZXZpY2VzL3JlZ2lzdGVyJwojIAlkZXZpY2VOYW1lIAkJPSBzb2NrZXQuZ2V0aG9zdG5hbWUoKQojIAloYXJkd2FyZUluZm8gCT0gcGxhdGZvcm0uc3lzdGVtKCkKIyAJcGF5bG9hZCAJCT0geydncm91cHV1aWQnOiBncm91cHV1aWQsICdkZXZpY2VuYW1lJzogZGV2aWNlTmFtZSwgJ2hhcmR3YXJlaW5mbyc6IGhhcmR3YXJlSW5mb30KIyAJcmVzcG9uc2UgCQk9IHNlbmRKc29uUGF5bG9hZEZsYXNrKHBheWxvYWQsIGVuZHBvaW50KQojIAlsb2dnZXIuZGVidWcoZidyZXNwb25zZToge3Jlc3BvbnNlLnRleHR9JykKIyAJZGV2aWNlVXVpZCAJCT0ganNvbi5sb2FkcyhyZXNwb25zZS50ZXh0KVsnZGV2aWNldXVpZCddCiMgCWxvZ2dlci5kZWJ1ZyhmJ0RldmljZSBpc3N1ZWQgbmV3IGRldmljZVV1aWQ6IHtkZXZpY2VVdWlkfScpCiMgCXJldHVybihkZXZpY2VVdWlkKQoKZGVmIGdldERldmljZURhdGEoZGV2aWNlRGF0YURpY3QpOgoJZGV2aWNlRGF0YURpY3RbJ2RldmljZSddIAkJCQkJPSB7fQoJZGV2aWNlRGF0YURpY3RbJ2RldmljZSddWydkZXZpY2VVdWlkJ10JCT0gZid7ZGV2aWNlVXVpZH0nCiMJZGV2aWNlRGF0YURpY3RbJ2RldmljZSddWydncm91cFV1aWQnXQkJPSBmJ3tncm91cFV1aWR9JwoJZGV2aWNlRGF0YURpY3RbJ2RldmljZSddWydzeXN0ZW10aW1lJ10JCT0gaW50KHRpbWUudGltZSgpKQoJaWYgZGVidWdNb2RlID09IFRydWU6CgkJbG9nZ2VyLmRlYnVnKGpzb24uZHVtcHMoZGV2aWNlRGF0YURpY3QsIGluZGVudD00KSkKCXJldHVybihkZXZpY2VEYXRhRGljdCkKCmRlZiBnZXRTeXN0ZW1EYXRhKGRldmljZURhdGFEaWN0KToKCWRldmljZURhdGFEaWN0WydzeXN0ZW0nXSAJCQkJCT0ge30JCglkZXZpY2VEYXRhRGljdFsnc3lzdGVtJ11bJ2RldmljZVBsYXRmb3JtJ10gCT0gcGxhdGZvcm0ucGxhdGZvcm0oKQoJZGV2aWNlRGF0YURpY3RbJ3N5c3RlbSddWydzeXN0ZW1OYW1lJ10JCT0gc29ja2V0LmdldGhvc3RuYW1lKCkKCWRldmljZURhdGFEaWN0WydzeXN0ZW0nXVsnY3VycmVudFVzZXInXQkJPSBnZXRwYXNzLmdldHVzZXIoKQoJZGV2aWNlRGF0YURpY3RbJ3N5c3RlbSddWydjcHVVc2FnZSddCQk9IHBzdXRpbC5jcHVfcGVyY2VudCg0KQoJZGV2aWNlRGF0YURpY3RbJ3N5c3RlbSddWydjcHVDb3VudCddIAkJPSBwc3V0aWwuY3B1X2NvdW50KCkKCWRldmljZURhdGFEaWN0WydzeXN0ZW0nXVsncHVibGljSXAnXSAJCT0gZ2V0UHVibGljSXBBZGRyKCkKCXJldHVybihkZXZpY2VEYXRhRGljdCkKCmRlZiBnZXRDb2xsZWN0b3JEYXRhKGRldmljZURhdGFEaWN0KToKCWFnZW50VmVyc2lvbkZpbGUgPSBvcy5wYXRoLmpvaW4oY29uZmlnRGlyLCAnYWdlbnRWZXJzaW9uLnR4dCcpCgl3aXRoIG9wZW4oYWdlbnRWZXJzaW9uRmlsZSwgJ3InKSBhcyBmOgoJCWxvY2FsQWdlbnRWZXJzaW9uID0gZi5yZWFkKCkuc3RyaXAoKQoJbG9nZ2VyLmluZm8oZidsb2NhbEFnZW50VmVyc2lvbjoge2xvY2FsQWdlbnRWZXJzaW9ufScpCglkZXZpY2VEYXRhRGljdFsnY29sbGVjdG9yJ10gCQkJCQk9IHt9CglkZXZpY2VEYXRhRGljdFsnY29sbGVjdG9yJ11bJ2NvbGx2ZXJzaW9uJ10JCT0gbG9jYWxBZ2VudFZlcnNpb24KCWRldmljZURhdGFEaWN0Wydjb2xsZWN0b3InXVsnY29sbGluc3RhbGxkaXInXQk9IGFwcERpcgoJcmV0dXJuKGRldmljZURhdGFEaWN0KQoKZGVmIGdldFVwdGltZURhdGEoZGV2aWNlRGF0YURpY3QpOgoJaWYgJ3N5c3RlbScgbm90IGluIGRldmljZURhdGFEaWN0OgoJCWRldmljZURhdGFEaWN0WydzeXN0ZW0nXSA9IHt9CglkZXZpY2VEYXRhRGljdFsnc3lzdGVtJ11bJ2Jvb3RUaW1lJ10JCT0gaW50KHBzdXRpbC5ib290X3RpbWUoKSkKCXJldHVybihkZXZpY2VEYXRhRGljdCkKCmRlZiBnZXROZXR3b3JrRGF0YShkZXZpY2VEYXRhRGljdCk6CglkZXZpY2VEYXRhRGljdFsnbmV0d29ya0xpc3QnXQkJCQk9IFtdCglwc05ldERpY3QgCQkJCQkJCQkJPSBwc3V0aWwubmV0X2lmX3N0YXRzKCkKCWlmRGljdCAJCQkJCQkJCQkJPSB7fQoKCWZvciBpZk5hbWUsIGRhdGEgaW4gcHNOZXREaWN0Lml0ZW1zKCk6CgkJaWZEaWN0W2lmTmFtZV0gCQkJCT0ge30KCQlpZkRpY3RbaWZOYW1lXVsnaWZJc1VwJ10JPSBkYXRhLmlzdXAKCQlpZkRpY3RbaWZOYW1lXVsnaWZTcGVlZCddCT0gZGF0YS5zcGVlZAoJCWlmRGljdFtpZk5hbWVdWydpZk10dSddCQk9IGRhdGEubXR1CgoJcHNOZXREaWN0IAkJCQkJCQkJCT0gcHN1dGlsLm5ldF9pb19jb3VudGVycyhwZXJuaWM9VHJ1ZSkKCWZvciBpZk5hbWUsIGRhdGEgaW4gcHNOZXREaWN0Lml0ZW1zKCk6CgkJaWYgaWZOYW1lIGluIGlmRGljdDogICMgT25seSBwcm9jZXNzIGludGVyZmFjZXMgd2UgZm91bmQgYmVmb3JlCgkJCWlmRGljdFtpZk5hbWVdWydieXRlc1NlbnQnXSAJPSBkYXRhLmJ5dGVzX3JlY3YKCQkJaWZEaWN0W2lmTmFtZV1bJ2J5dGVzUmVjdiddIAk9IGRhdGEuYnl0ZXNfc2VudAoJCQlpZkRpY3RbaWZOYW1lXVsnZXJySW4nXSAJCT0gZGF0YS5lcnJpbgoJCQlpZkRpY3RbaWZOYW1lXVsnZXJyT3V0J10gCQk9IGRhdGEuZXJyb3V0CgoJcHNOZXREaWN0IAkJCQkJCQkJCT0gcHN1dGlsLm5ldF9pZl9hZGRycygpCglmb3IgaWZOYW1lLCBhZGRyZXNzZXMgaW4gcHNOZXREaWN0Lml0ZW1zKCk6CgkJaWYgaWZOYW1lIGluIGlmRGljdDogICMgT25seSBwcm9jZXNzIGludGVyZmFjZXMgd2UgZm91bmQgYmVmb3JlCgkJCWZvciBhZGRyZXNzIGluIGFkZHJlc3NlczoKCQkJCWlmIGFkZHJlc3MuZmFtaWx5ID09IHNvY2tldC5BRl9JTkVUOgoJCQkJCWlmRGljdFtpZk5hbWVdWydhZGRyZXNzNCddIAkJPSBhZGRyZXNzLmFkZHJlc3MKCQkJCQlpZkRpY3RbaWZOYW1lXVsnbmV0bWFzazQnXSAJCT0gYWRkcmVzcy5uZXRtYXNrCgkJCQkJaWZEaWN0W2lmTmFtZV1bJ2Jyb2FkY2FzdDQnXSAJPSBhZGRyZXNzLmJyb2FkY2FzdAoJCQkJZWxpZiBhZGRyZXNzLmZhbWlseSA9PSBzb2NrZXQuQUZfSU5FVDY6CgkJCQkJaWZEaWN0W2lmTmFtZV1bJ2FkZHJlc3M2J10gCQk9IGFkZHJlc3MuYWRkcmVzcwoJCQkJCWlmRGljdFtpZk5hbWVdWyduZXRtYXNrNiddIAkJPSBhZGRyZXNzLm5ldG1hc2sKCQkJCQlpZkRpY3RbaWZOYW1lXVsnYnJvYWRjYXN0NiddIAk9IGFkZHJlc3MuYnJvYWRjYXN0CglkZXZpY2VEYXRhRGljdFsnbmV0d29ya0xpc3QnXS5hcHBlbmQoaWZEaWN0KQkKCXJldHVybihkZXZpY2VEYXRhRGljdCkJCgkKZGVmIGdldFVzZXJEYXRhKGRldmljZURhdGFEaWN0KToKCXVzZXJzIAkJPSBwc3V0aWwudXNlcnMoKQoJZGV2aWNlRGF0YURpY3RbJ1VzZXJzJ10gCQkJCT0gW10KCXVzZXJEaWN0IAk9IHt9Cgl1c2VySWQgCQk9IDAKCWZvciB1c2VyIGluIHVzZXJzOgoJCXVzZXJEaWN0W3VzZXJJZF0gCQkJCT0ge30KCQl1c2VyRGljdFt1c2VySWRdWyd1c2VybmFtZSddIAk9IHVzZXIubmFtZQoJCWlmIG5vdCB1c2VyLnRlcm1pbmFsOgoJCQl1c2VyRGljdFt1c2VySWRdWyd0ZXJtaW5hbCddIAk9ICctMScKCQllbHNlOgoJCQl1c2VyRGljdFt1c2VySWRdWyd0ZXJtaW5hbCddIAk9IHVzZXIudGVybWluYWwKCQlpZiBub3QgdXNlci5ob3N0OgoJCQl1c2VyRGljdFt1c2VySWRdWydob3N0J10gCT0gJ2xvY2FsaG9zdCcKCQllbHNlOgoJCQl1c2VyRGljdFt1c2VySWRdWydob3N0J10gCQk9IHVzZXIuaG9zdAoJCXVzZXJEaWN0W3VzZXJJZF1bJ2xvZ2dlZEluJ10gCT0gdXNlci5zdGFydGVkCgkJaWYgbm90IHVzZXIucGlkOgoJCQl1c2VyRGljdFt1c2VySWRdWydwaWQnXQkJCT0gLTEKCQllbHNlOgoJCQl1c2VyRGljdFt1c2VySWRdWydwaWQnXSAJCT0gdXNlci5waWQKCQl1c2VySWQgKz0gMQoJZGV2aWNlRGF0YURpY3RbJ1VzZXJzJ10uYXBwZW5kKHVzZXJEaWN0KQoJcmV0dXJuKGRldmljZURhdGFEaWN0KQoKIyBXaW5kb3dzLXNwZWNpZmljIGZ1bmN0aW9uIHJlbW92ZWQgZm9yIG1hY09TLW9ubHkgc2NyaXB0CgpkZWYgZ2V0RGlza1N0YXRzKGRldmljZURhdGFEaWN0KToKCSIiIkdldCBkaXNrIHVzYWdlIHN0YXRpc3RpY3MgZm9yIG1hY09TIiIiCglkcml2ZURhdGEgPSB7fQoJc3RhdCA9IHNodXRpbC5kaXNrX3VzYWdlKCcvJykKCXRvdGFsID0gc3RhdC50b3RhbAoJdXNlZCA9IHN0YXQudXNlZAoJZnJlZSA9IHN0YXQuZnJlZQoJdXNlZFBlciA9ICh1c2VkIC8gdG90YWwpICogMTAwCglmcmVlUGVyID0gKGZyZWUgLyB0b3RhbCkgKiAxMDAKCWRldmljZURhdGFEaWN0Wydkcml2ZXMnXSA9IFtdCglkcml2ZURhdGFbJ25hbWUnXSA9ICcvJwoJZHJpdmVEYXRhWyd0b3RhbCddID0gdG90YWwKCWRyaXZlRGF0YVsndXNlZCddID0gdXNlZAoJZHJpdmVEYXRhWydmcmVlJ10gPSBmcmVlCglkcml2ZURhdGFbJ3VzZWRQZXInXSA9IHVzZWRQZXIKCWRyaXZlRGF0YVsnZnJlZVBlciddID0gZnJlZVBlcgoJZGV2aWNlRGF0YURpY3RbJ2RyaXZlcyddLmFwcGVuZChkcml2ZURhdGEpCglyZXR1cm4oZGV2aWNlRGF0YURpY3QpCgpkZWYgZ2V0QmF0dGVyeURhdGEoZGV2aWNlRGF0YURpY3QpOgogICAgYmF0dGVyeSA9IHBzdXRpbC5zZW5zb3JzX2JhdHRlcnkoKQogICAgZGV2aWNlRGF0YURpY3RbJ2JhdHRlcnknXSA9IHt9CiAgICBpZiBiYXR0ZXJ5OgogICAgICAgIGRldmljZURhdGFEaWN0WydiYXR0ZXJ5J11bJ2luc3RhbGxlZCddID0gVHJ1ZQogICAgICAgIGRldmljZURhdGFEaWN0WydiYXR0ZXJ5J11bJ3BjQ2hhcmdlZCddID0gYmF0dGVyeS5wZXJjZW50CiAgICAgICAgIyBGaXggZm9yIG1hY09TIGJhdHRlcnkgc2Vjb25kcyBsZWZ0IGhhbmRsaW5nCiAgICAgICAgaWYgYmF0dGVyeS5zZWNzbGVmdCA9PSAtMjogICMgUG93ZXIgY29ubmVjdGVkCiAgICAgICAgICAgIGRldmljZURhdGFEaWN0WydiYXR0ZXJ5J11bJ3NlY3NMZWZ0J10gPSAtMgogICAgICAgIGVsaWYgYmF0dGVyeS5zZWNzbGVmdCA9PSAtMTogICMgQ2FsY3VsYXRpbmcuLi4KICAgICAgICAgICAgZGV2aWNlRGF0YURpY3RbJ2JhdHRlcnknXVsnc2Vjc0xlZnQnXSA9IC0xCiAgICAgICAgZWxzZToKICAgICAgICAgICAgZGV2aWNlRGF0YURpY3RbJ2JhdHRlcnknXVsnc2Vjc0xlZnQnXSA9IGJhdHRlcnkuc2Vjc2xlZnQKICAgICAgICBkZXZpY2VEYXRhRGljdFsnYmF0dGVyeSddWydwb3dlclBsdWcnXSA9IGJhdHRlcnkucG93ZXJfcGx1Z2dlZAogICAgZWxzZToKICAgICAgICBkZXZpY2VEYXRhRGljdFsnYmF0dGVyeSddWydpbnN0YWxsZWQnXSA9IEZhbHNlCiAgICAgICAgZGV2aWNlRGF0YURpY3RbJ2JhdHRlcnknXVsncGNDaGFyZ2VkJ10gPSAwCiAgICAgICAgZGV2aWNlRGF0YURpY3RbJ2JhdHRlcnknXVsnc2Vjc0xlZnQnXSA9IDAKICAgICAgICBkZXZpY2VEYXRhRGljdFsnYmF0dGVyeSddWydwb3dlclBsdWcnXSA9IEZhbHNlCiAgICByZXR1cm4oZGV2aWNlRGF0YURpY3QpCgpkZWYgZ2V0UGFydGl0aW9uRGF0YShkZXZpY2VEYXRhRGljdCk6CglwYXJ0aXRpb25EaWN0IAkJCQkJPSB7fQoJZGV2aWNlRGF0YURpY3RbJ3BhcnRpdGlvbnMnXSAJPSBbXQoJcGFydGl0aW9uc0xpc3QJCQkJCT0gcHN1dGlsLmRpc2tfcGFydGl0aW9ucygpCglmb3IgcGFydGl0aW9uIGluIHBhcnRpdGlvbnNMaXN0OgoJCXBhcnRpdGlvbkRpY3RbcGFydGl0aW9uLm1vdW50cG9pbnRdIAkJCT0ge30KCQlwYXJ0aXRpb25EaWN0W3BhcnRpdGlvbi5tb3VudHBvaW50XVsnZGV2aWNlJ10JPSBwYXJ0aXRpb24uZGV2aWNlCgkJcGFydGl0aW9uRGljdFtwYXJ0aXRpb24ubW91bnRwb2ludF1bJ2ZzdHlwZSddCT0gcGFydGl0aW9uLmZzdHlwZQoJZGV2aWNlRGF0YURpY3RbJ3BhcnRpdGlvbnMnXS5hcHBlbmQocGFydGl0aW9uRGljdCkKCXJldHVybihkZXZpY2VEYXRhRGljdCkKCmRlZiBnZXRtZW1vcnlEYXRhKGRldmljZURhdGFEaWN0KToKCW1lbW9yeSAJCQkJCQkJCQk9IHBzdXRpbC52aXJ0dWFsX21lbW9yeSgpCglkZXZpY2VEYXRhRGljdFsnbWVtb3J5J10JIAkJCT0ge30KCWRldmljZURhdGFEaWN0WydtZW1vcnknXVsndG90YWwnXQkJPSBtZW1vcnkudG90YWwKCWRldmljZURhdGFEaWN0WydtZW1vcnknXVsnYXZhaWxhYmxlJ10JPSBtZW1vcnkuYXZhaWxhYmxlCglkZXZpY2VEYXRhRGljdFsnbWVtb3J5J11bJ3VzZWQnXQkJPSBtZW1vcnkudXNlZAoJZGV2aWNlRGF0YURpY3RbJ21lbW9yeSddWydmcmVlJ10JCT0gbWVtb3J5LmZyZWUKCXJldHVybihkZXZpY2VEYXRhRGljdCkKCgoKZGVmIGNoZWNrTW9kZShtb2RlKToKCXZhbGlkTW9kZXMgPSBbJ0FVRElUJywgJ0VWRU5UTE9HJywgJ1NUQVRVUycsICdXRUdMT0cnLCAnRlVMTEFVRElUJywgCgkJCSAgIAkJJ01TSU5GTycsICdVUERBVEUnLCAnSU5TVEFMTCcsICdSRVNFVEVWRU5UUyddCglpZiBtb2RlLnVwcGVyKCkgaW4gdmFsaWRNb2RlczoKCQlyZXR1cm4obW9kZSkKCWVsc2U6CgkJbG9nZ2VyLmVycm9yKGYnSW52YWxpZCBtb2RlIHNwZWNpZmllZDoge21vZGV9JykKCQlzeXMuZXhpdCgpCgpkZWYgZ2V0V2VnQ29uZmlnRmlsZVgoY29uZmlnRGlyKToKCSIiIkdldCBjb25maWcgZmlsZSBwYXRoIGZvciBtYWNPUyIiIgoJd2VnQ29uZmlnRmlsZSA9IGYne2NvbmZpZ0Rpcn1hZ2VudC5jb25maWcnCglyZXR1cm4od2VnQ29uZmlnRmlsZSkKCmRlZiBnZXRBcHBEaXJzKCk6CgkiIiJHZXQgYXBwbGljYXRpb24gZGlyZWN0b3JpZXMgZm9yIG1hY09TIiIiCglhcHBEaXIgPSAnL29wdC9XZWd3ZWlzZXIvJwoJbG9nRGlyID0gb3MucGF0aC5qb2luKGFwcERpciwgJ0xvZ3MnLCAnJykKCWNvbmZpZ0RpciA9IG9zLnBhdGguam9pbihhcHBEaXIsICdDb25maWcnLCAnJykKCXRlbXBEaXIgPSBvcy5wYXRoLmpvaW4oYXBwRGlyLCAnVGVtcCcsICcnKQoJZmlsZXNEaXIgPSBvcy5wYXRoLmpvaW4oYXBwRGlyLCAnRmlsZXMnLCAnJykKCWNoZWNrRGlycyhbYXBwRGlyLCBsb2dEaXIsIGNvbmZpZ0RpciwgdGVtcERpciwgZmlsZXNEaXJdKQoJcmV0dXJuKGFwcERpciwgbG9nRGlyLCBjb25maWdEaXIsIHRlbXBEaXIsIGZpbGVzRGlyKQoKZGVmIGNoZWNrRGlycyhkaXJzVG9DaGVjayk6Cglmb3IgZGlyVG9DaGVjayBpbiBkaXJzVG9DaGVjazoKCQlkaXJUb0NoZWNrID0gb3MucGF0aC5qb2luKGRpclRvQ2hlY2ssICcnKQoJCWlmIG5vdCBvcy5wYXRoLmlzZGlyKGRpclRvQ2hlY2spOgoJCQlsb2dnZXIuaW5mbyhmJ3tkaXJUb0NoZWNrfSBkb2VzIG5vdCBleGlzdC4gQ3JlYXRpbmcuLi4nKQoJCQl0cnk6CgkJCQlvcy5tYWtlZGlycyhkaXJUb0NoZWNrKQoJCQkJbG9nZ2VyLmluZm8oZid7ZGlyVG9DaGVja30gY3JlYXRlZC4nKQoJCQlleGNlcHQgRXhjZXB0aW9uIGFzIGU6CgkJCQlsb2dnZXIuZXJyb3IoZidGYWlsZWQgdG8gY3JlYXRlIHtkaXJUb0NoZWNrfS4gUmVhc29uOiB7ZX0nKQoJCQkJc3lzLmV4aXQoKQoKZGVmIGRlbEZpbGUoZmlsZVRvRGVsZXRlKToKCWxvZ2dlci5pbmZvKGYnQXR0ZW1wdGluZyB0byBkZWxldGUge2ZpbGVUb0RlbGV0ZX0uLi4nKQoJdHJ5OgoJCW9zLnJlbW92ZShmaWxlVG9EZWxldGUpCgkJbG9nZ2VyLmluZm8oZidTdWNjZXNzZnVsbHkgZGVsZXRlZCB7ZmlsZVRvRGVsZXRlfS4nKQoJZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgoJCWxvZ2dlci5lcnJvcihmJ0ZhaWxlZCB0byBkZWxldGUge2ZpbGVUb0RlbGV0ZX0uIFJlYXNvbjoge2V9JykKCiMgV2luZG93cyBNU0luZm8gZnVuY3Rpb25zIHJlbW92ZWQgLSBub3QgYXBwbGljYWJsZSBmb3IgbWFjT1MKIyBNU0luZm8gcHJvY2Vzc2luZyByZW1vdmVkIC0gbm90IGFwcGxpY2FibGUgZm9yIG1hY09TCgpkZWYgZ2V0Q3B1SW5mbyhkZXZpY2VEYXRhRGljdCk6CgkiIiJHZXQgQ1BVIGluZm9ybWF0aW9uIGZvciBtYWNPUyIiIgoJY29tbWFuZCA9IFsnc3lzY3RsJywgJy1uJywgJ21hY2hkZXAuY3B1LmJyYW5kX3N0cmluZyddCglyZXN1bHQgPSBzdWJwcm9jZXNzLnJ1bihjb21tYW5kLCBjYXB0dXJlX291dHB1dD1UcnVlLCB0ZXh0PVRydWUpCgljcHVOYW1lID0gcmVzdWx0LnN0ZG91dC5zdHJpcCgpCgoJbG9nZ2VyLmluZm8oZidjcHVOYW1lOiB7Y3B1TmFtZX0nKQoJZGV2aWNlRGF0YURpY3RbJ2NwdSddID0ge30KCWRldmljZURhdGFEaWN0WydjcHUnXVsnY3B1bmFtZSddID0gY3B1TmFtZQoJcmV0dXJuKGRldmljZURhdGFEaWN0KQoKZGVmIGNoZWNrQXBwSW5zdGFsbGVkKGFwcE5hbWUpOgoJbG9nZ2VyLmluZm8oZidDaGVja2luZyBpZiB7YXBwTmFtZX0gZXhpc3RzLi4uJykKCWNvbW1hbmQgCT0gWyJ3aGljaCIsIGFwcE5hbWVdCglyZXN1bHQgCQk9IHN1YnByb2Nlc3MuUG9wZW4oY29tbWFuZCwgc3Rkb3V0PXN1YnByb2Nlc3MuUElQRSkKCXJlc3VsdCAJCT0gcmVzdWx0LnN0ZG91dC5yZWFkKCkuZGVjb2RlKCJ1dGYtOCIpLnN0cmlwKCkKCWxvZ2dlci5pbmZvKGYnRToge3Jlc3VsdH0nKQoJaWYgbGVuKHJlc3VsdCkgPiAwOgoJCWxvZ2dlci5pbmZvKGYne2FwcE5hbWV9IGV4aXN0cycpCgkJcmV0dXJuKFRydWUpCgllbHNlOgoJCWxvZ2dlci5pbmZvKGYne2FwcE5hbWV9IGRvZXMgbm90IGV4aXN0JykKCQlyZXR1cm4oRmFsc2UpCgpkZWYgZ2V0R3B1SW5mbyhkZXZpY2VEYXRhRGljdCk6CgkiIiJHZXQgR1BVIGluZm9ybWF0aW9uIGZvciBtYWNPUyIiIgoJdmVuZG9yID0gJ05vIGRhdGEgZm91bmQnCglwcm9kdWN0ID0gJ05vIGRhdGEgZm91bmQnCgljb2xvdXJEZXB0aCA9IC0xCgloUmVzID0gLTEKCXZSZXMgPSAtMQoKCWNvbW1hbmQgPSBbJ3N5c3RlbV9wcm9maWxlcicsICdTUERpc3BsYXlzRGF0YVR5cGUnXQoJcmVzdWx0ID0gc3VicHJvY2Vzcy5ydW4oY29tbWFuZCwgY2FwdHVyZV9vdXRwdXQ9VHJ1ZSwgdGV4dD1UcnVlKQoJZm9yIGxpbmUgaW4gcmVzdWx0LnN0ZG91dC5zcGxpdGxpbmVzKCk6CgkJaWYgJ0NoaXBzZXQgTW9kZWwnIGluIGxpbmU6CgkJCXByb2R1Y3QgPSBsaW5lLnNwbGl0KCc6ICcpWzFdLnN0cmlwKCkKCQlpZiAnVmVuZG9yJyBpbiBsaW5lOgoJCQl2ZW5kb3IgPSBsaW5lLnNwbGl0KCc6ICcpWzFdLnN0cmlwKCkKCQlpZiAnUmVzb2x1dGlvbicgaW4gbGluZToKCQkJcmVzb2x1dGlvbiA9IGxpbmUuc3BsaXQoJzogJylbMV0uc3RyaXAoKQoJCQl0cnk6CgkJCQloUmVzLCB2UmVzID0gcmVzb2x1dGlvbi5zcGxpdCgnIHggJykKCQkJCWhSZXMgPSBpbnQoaFJlcykKCQkJCXZSZXMgPSAnJy5qb2luKGZpbHRlcihzdHIuaXNkaWdpdCwgdlJlcykpCgkJCQl2UmVzID0gaW50KHZSZXMpIGlmIHZSZXMuaXNkaWdpdCgpIGVsc2UgLTEKCQkJZXhjZXB0OgoJCQkJaFJlcyA9IC0xCgkJCQl2UmVzID0gLTEKCQlpZiAnRnJhbWVidWZmZXIgRGVwdGgnIGluIGxpbmU6CgkJCXRyeToKCQkJCWNvbG91ckRlcHRoID0gaW50KGxpbmUuc3BsaXQoJzogJylbMV0uc3RyaXAoKS5zcGxpdCgnLScpWzBdKQoJCQlleGNlcHQ6CgkJCQljb2xvdXJEZXB0aCA9IC0xCgoJZGV2aWNlRGF0YURpY3RbJ2dwdWluZm8nXSA9IHt9CglkZXZpY2VEYXRhRGljdFsnZ3B1aW5mbyddWydncHV2ZW5kb3InXSA9IHZlbmRvcgoJZGV2aWNlRGF0YURpY3RbJ2dwdWluZm8nXVsnZ3B1cHJvZHVjdCddID0gcHJvZHVjdAoJZGV2aWNlRGF0YURpY3RbJ2dwdWluZm8nXVsnZ3B1Y29sb3VyJ10gPSBjb2xvdXJEZXB0aAoJZGV2aWNlRGF0YURpY3RbJ2dwdWluZm8nXVsnZ3B1aHJlcyddID0gaFJlcwoJZGV2aWNlRGF0YURpY3RbJ2dwdWluZm8nXVsnZ3B1dnJlcyddID0gdlJlcwoJcmV0dXJuKGRldmljZURhdGFEaWN0KQoKZGVmIHppcEZpbGUoZmlsZVRvWmlwKToKCWltcG9ydCB6aXBmaWxlCglpbkZpbGUgCQk9IG9zLnBhdGguam9pbihmaWxlc0RpciwgZmlsZVRvWmlwKQoJb3V0WmlwRmlsZSAJPSBvcy5wYXRoLmpvaW4oZmlsZXNEaXIsIGYne2ZpbGVUb1ppcH0uemlwJykKCWxvZ2dlci5pbmZvKGYnWmlwcGluZyB7aW5GaWxlfSB0byB7b3V0WmlwRmlsZX0nKQoJdHJ5OgoJCXdpdGggemlwZmlsZS5aaXBGaWxlKG91dFppcEZpbGUsICd3JywgY29tcHJlc3Npb249emlwZmlsZS5aSVBfREVGTEFURUQpIGFzIHppcGY6CgkJCXppcGYud3JpdGUoaW5GaWxlLCBvcy5wYXRoLmJhc2VuYW1lKGluRmlsZSkpCgkJbG9nZ2VyLmluZm8oZidTdWNjZXNzZnVsbHkgemlwcGVkIHtpbkZpbGV9IHRvIHtvdXRaaXBGaWxlfScpCglleGNlcHQgRXhjZXB0aW9uIGFzIGU6CgkJbG9nZ2VyLmVycm9yKGYnRmFpbGVkIHRvIHppcCB7aW5GaWxlfSB0byB7b3V0WmlwRmlsZX0uIFJlYXNvbjoge2V9JykKCXJldHVybihvdXRaaXBGaWxlKQoKZGVmIHNlbmRQYXlsb2FkRmxhc2socm91dGUsIG91dFppcEZpbGUsIGRldmljZVV1aWQpOgoJcGF5bG9hZE5hbWUgCT0gb3MucGF0aC5iYXNlbmFtZShvdXRaaXBGaWxlKQoJdXJsIAkJCT0gZidodHRwczovL3tob3N0fXtyb3V0ZX0nCglsb2dnZXIuaW5mbyhmJ1JlcXVlc3QgdG8gc2VuZCB7b3V0WmlwRmlsZX0gfCBwYXlsb2FkTmFtZToge3BheWxvYWROYW1lfScpCglsb2dnZXIuaW5mbyhmJ0F0dGVtcHRpbmcgdG8gY29ubmVjdCB0byB7dXJsfScpCgl3aXRoIG9wZW4ob3V0WmlwRmlsZSwgJ3JiJykgYXMgZjoKCQlmaWxlcyA9IHsnZmlsZSc6IChwYXlsb2FkTmFtZSwgZil9CgkJaGVhZGVycyA9IHsnZGV2aWNldXVpZCc6IGRldmljZVV1aWR9CgkJcmVzcG9uc2UgPSByZXF1ZXN0cy5wb3N0KHVybCwgZmlsZXM9ZmlsZXMsIGhlYWRlcnM9aGVhZGVycykKCQlpZiByZXNwb25zZS5zdGF0dXNfY29kZSA9PSAyMDA6CgkJCWxvZ2dlci5pbmZvKGYnc3RhdHVzX2NvZGU6IHtyZXNwb25zZS5zdGF0dXNfY29kZX0nKQoJCQlyZXR1cm4oVHJ1ZSkKCQllbHNlOgoJCQlsb2dnZXIuZXJyb3IoZidzdGF0dXNfY29kZToge3Jlc3BvbnNlLnN0YXR1c19jb2RlfS4gUmVhc29uOiB7cmVzcG9uc2UudGV4dH0nKQoJCQlyZXR1cm4oRmFsc2UpCgpkZWYgZ2V0U21CaW9zSW5mbyhkZXZpY2VEYXRhRGljdCk6CgkiIiJHZXQgc3lzdGVtIGluZm9ybWF0aW9uIGZvciBtYWNPUyB1c2luZyBzeXN0ZW1fcHJvZmlsZXIiIiIKCXZlbmRvciA9ICdBcHBsZSBJbmMuJwoJc2VyaWFsTnVtYmVyID0gJ24vYScKCXZlcnNpb24gPSAnbi9hJwoKCXRyeToKCQljb21tYW5kID0gWydzeXN0ZW1fcHJvZmlsZXInLCAnU1BIYXJkd2FyZURhdGFUeXBlJ10KCQlyZXN1bHQgPSBzdWJwcm9jZXNzLnJ1bihjb21tYW5kLCBjYXB0dXJlX291dHB1dD1UcnVlLCB0ZXh0PVRydWUpCgkJZm9yIGxpbmUgaW4gcmVzdWx0LnN0ZG91dC5zcGxpdGxpbmVzKCk6CgkJCWlmICdTZXJpYWwgTnVtYmVyJyBpbiBsaW5lOgoJCQkJc2VyaWFsTnVtYmVyID0gbGluZS5zcGxpdCgnOiAnKVsxXS5zdHJpcCgpCgkJCWlmICdCb290IFJPTSBWZXJzaW9uJyBpbiBsaW5lOgoJCQkJdmVyc2lvbiA9IGxpbmUuc3BsaXQoJzogJylbMV0uc3RyaXAoKQoJZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgoJCWxvZ2dlci5lcnJvcihmJ0ZhaWxlZCB0byBnZXQgc3lzdGVtIGluZm86IHtlfScpCgoJbG9nZ2VyLmluZm8oZid2ZW5kb3I6IHt2ZW5kb3J9JykKCWxvZ2dlci5pbmZvKGYnc2VyaWFsTnVtYmVyOiB7c2VyaWFsTnVtYmVyfScpCglsb2dnZXIuaW5mbyhmJ3ZlcnNpb246IHt2ZXJzaW9ufScpCglkZXZpY2VEYXRhRGljdFsnYmlvcyddID0ge30KCWRldmljZURhdGFEaWN0WydiaW9zJ11bJ2Jpb3N2ZW5kb3InXSA9IHZlbmRvcgoJZGV2aWNlRGF0YURpY3RbJ2Jpb3MnXVsnc2VyaWFsbnVtYmVyJ10gPSBzZXJpYWxOdW1iZXIKCWRldmljZURhdGFEaWN0WydiaW9zJ11bJ2Jpb3N2ZXJzaW9uJ10gPSB2ZXJzaW9uCglyZXR1cm4oZGV2aWNlRGF0YURpY3QpCgpkZWYgZ2V0U3lzdGVtTW9kZWxGcm9tUHJvYygpOgoJc3lzdGVtTW9kZWwJPSAnbi9hJwoJY29tbWFuZAkJPSBbJ2NhdCcsICcvcHJvYy9jcHVpbmZvJ10KCXJlc3VsdCAJCT0gc3VicHJvY2Vzcy5Qb3Blbihjb21tYW5kLCBzdGRvdXQgPSBzdWJwcm9jZXNzLlBJUEUsIHVuaXZlcnNhbF9uZXdsaW5lcyA9IFRydWUpCglsb2dnZXIuZGVidWcoZidyZXN1bHQ6IHtyZXN1bHR9JykKCW91dHRleHQgCT0gcmVzdWx0LnN0ZG91dC5yZWFkKCkKCWxvZ2dlci5pbmZvKGYnb3V0dGV4dDoge291dHRleHR9JykKCWZvciBsaW5lIGluIG91dHRleHQuc3BsaXRsaW5lcygpOgoJCWlmICdNb2RlbCcgaW4gbGluZToKCQkJc3lzdGVtTW9kZWwgPSBsaW5lLnNwbGl0KCc6JylbMV0uc3RyaXAoKQoJbG9nZ2VyLmluZm8oZidzeXN0ZW1Nb2RlbDoge3N5c3RlbU1vZGVsfScpCQoJcmV0dXJuKHN5c3RlbU1vZGVsKQoKZGVmIGdldFN5c3RlbU1vZGVsKGRldmljZURhdGFEaWN0KToKCSIiIkdldCBkZXRhaWxlZCBzeXN0ZW0gbW9kZWwgZm9yIG1hY09TIGluY2x1ZGluZyB5ZWFyIGFuZCBnZW5lcmF0aW9uIiIiCglzeXN0ZW1Nb2RlbCA9ICduL2EnCgltb2RlbElkZW50aWZpZXIgPSAnbi9hJwoJbW9kZWxOYW1lID0gJ24vYScKCgl0cnk6CgkJY29tbWFuZCA9IFsnc3lzdGVtX3Byb2ZpbGVyJywgJ1NQSGFyZHdhcmVEYXRhVHlwZSddCgkJcmVzdWx0ID0gc3VicHJvY2Vzcy5ydW4oY29tbWFuZCwgY2FwdHVyZV9vdXRwdXQ9VHJ1ZSwgdGV4dD1UcnVlKQoJCWZvciBsaW5lIGluIHJlc3VsdC5zdGRvdXQuc3BsaXRsaW5lcygpOgoJCQlpZiAnTW9kZWwgTmFtZScgaW4gbGluZToKCQkJCW1vZGVsTmFtZSA9IGxpbmUuc3BsaXQoJzogJylbMV0uc3RyaXAoKQoJCQllbGlmICdNb2RlbCBJZGVudGlmaWVyJyBpbiBsaW5lOgoJCQkJbW9kZWxJZGVudGlmaWVyID0gbGluZS5zcGxpdCgnOiAnKVsxXS5zdHJpcCgpCgoJCSMgQ29tYmluZSBib3RoIGZvciBjb21wbGV0ZSBtb2RlbCBpbmZvCgkJaWYgbW9kZWxOYW1lICE9ICduL2EnIGFuZCBtb2RlbElkZW50aWZpZXIgIT0gJ24vYSc6CgkJCXN5c3RlbU1vZGVsID0gZiJ7bW9kZWxOYW1lfSAoe21vZGVsSWRlbnRpZmllcn0pIgoJCWVsaWYgbW9kZWxOYW1lICE9ICduL2EnOgoJCQlzeXN0ZW1Nb2RlbCA9IG1vZGVsTmFtZQoJCWVsaWYgbW9kZWxJZGVudGlmaWVyICE9ICduL2EnOgoJCQlzeXN0ZW1Nb2RlbCA9IG1vZGVsSWRlbnRpZmllcgoKCWV4Y2VwdCBFeGNlcHRpb24gYXMgZToKCQlsb2dnZXIuZXJyb3IoZidGYWlsZWQgdG8gZ2V0IHN5c3RlbSBtb2RlbDoge2V9JykKCglsb2dnZXIuaW5mbyhmJ3N5c3RlbU1vZGVsOiB7c3lzdGVtTW9kZWx9JykKCWxvZ2dlci5pbmZvKGYnbW9kZWxOYW1lOiB7bW9kZWxOYW1lfScpCglsb2dnZXIuaW5mbyhmJ21vZGVsSWRlbnRpZmllcjoge21vZGVsSWRlbnRpZmllcn0nKQoJZGV2aWNlRGF0YURpY3RbJ3N5c3RlbSddWydzeXN0ZW1tb2RlbCddID0gc3lzdGVtTW9kZWwKCWRldmljZURhdGFEaWN0WydzeXN0ZW0nXVsnbW9kZWxuYW1lJ10gPSBtb2RlbE5hbWUKCWRldmljZURhdGFEaWN0WydzeXN0ZW0nXVsnbW9kZWxpZGVudGlmaWVyJ10gPSBtb2RlbElkZW50aWZpZXIKCXJldHVybihkZXZpY2VEYXRhRGljdCkKCmRlZiBnZXRTZXJ2aWNlcygpOgoJIiIiR2V0IHJ1bm5pbmcgc2VydmljZXMvZGFlbW9ucyBmb3IgbWFjT1MgdXNpbmcgbGF1bmNoY3RsIiIiCglsb2dnZXIuaW5mbygnQXR0ZW1wdGluZyB0byBnZXQgc2VydmljZXMuLi4nKQoJc2VydmljZXNEaWN0ID0ge30KCgl0cnk6CgkJIyBHZXQgbGlzdCBvZiBsb2FkZWQgc2VydmljZXMKCQljb21tYW5kID0gWydsYXVuY2hjdGwnLCAnbGlzdCddCgkJcmVzdWx0ID0gc3VicHJvY2Vzcy5ydW4oY29tbWFuZCwgY2FwdHVyZV9vdXRwdXQ9VHJ1ZSwgdGV4dD1UcnVlKQoKCQlmb3IgbGluZSBpbiByZXN1bHQuc3Rkb3V0LnNwbGl0bGluZXMoKToKCQkJaWYgbGluZS5zdGFydHN3aXRoKCdQSUQnKSBvciBsaW5lLnN0cmlwKCkgPT0gJyc6CgkJCQljb250aW51ZQoJCQlwYXJ0cyA9IGxpbmUuc3BsaXQoJ1x0JykKCQkJaWYgbGVuKHBhcnRzKSA+PSAzOgoJCQkJcGlkID0gcGFydHNbMF0uc3RyaXAoKQoJCQkJc3RhdHVzID0gcGFydHNbMV0uc3RyaXAoKQoJCQkJc2VydmljZU5hbWUgPSBwYXJ0c1syXS5zdHJpcCgpCgoJCQkJIyBEZXRlcm1pbmUgZnJpZW5kbHkgc3RhdGUKCQkJCWlmIHBpZCA9PSAnLSc6CgkJCQkJZnJpZW5kbHlTdGF0ZSA9ICdTVE9QUEVEJwoJCQkJZWxpZiBwaWQuaXNkaWdpdCgpOgoJCQkJCWZyaWVuZGx5U3RhdGUgPSAnUlVOTklORycKCQkJCWVsc2U6CgkJCQkJZnJpZW5kbHlTdGF0ZSA9ICdPVEhFUicKCgkJCQlzZXJ2aWNlc0RpY3Rbc2VydmljZU5hbWVdID0gewoJCQkJCSdkaXNwbGF5bmFtZSc6IHNlcnZpY2VOYW1lLAoJCQkJCSdjdXJyZW50c3RhdGUnOiAxIGlmIGZyaWVuZGx5U3RhdGUgPT0gJ1NUT1BQRUQnIGVsc2UgNCwKCQkJCQknZnJpZW5kbHlzdGF0ZSc6IGZyaWVuZGx5U3RhdGUsCgkJCQkJJ3BpZCc6IHBpZCBpZiBwaWQgIT0gJy0nIGVsc2UgTm9uZQoJCQkJfQoJZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgoJCWxvZ2dlci5lcnJvcihmJ0ZhaWxlZCB0byBnZXQgc2VydmljZXM6IHtlfScpCgoJbG9nZ2VyLmluZm8oJ1N1Y2Nlc3NmdWxseSBjb2xsZWN0ZWQgc2VydmljZXMuJykKCXNlcnZpY2VzRGljdEZpbGUgPSB3cml0ZVNlcnZpY2VzSnNvbihzZXJ2aWNlc0RpY3QpCglyb3V0ZSA9ICcvcGF5bG9hZC9zZW5kZmlsZScKCXVwbG9hZFN1Y2Nlc3MgPSBzZW5kUGF5bG9hZEZsYXNrKHJvdXRlLCBzZXJ2aWNlc0RpY3RGaWxlLCBkZXZpY2VVdWlkKQoJaWYgdXBsb2FkU3VjY2VzczoKCQlkZWxGaWxlKHNlcnZpY2VzRGljdEZpbGUpCgllbHNlOgoJCWxvZ2dlci5lcnJvcihmJ1VwbG9hZCBmYWlsZWQuJykKCXJldHVybihzZXJ2aWNlc0RpY3QpCgpkZWYgd3JpdGVTZXJ2aWNlc0pzb24oc2VydmljZXNEaWN0KToKCXNlcnZpY2VzRGljdEZpbGUgPSBmJ3tmaWxlc0Rpcn1zZXJ2aWNlcy5qc29uJwoJbG9nZ2VyLmluZm8oZidBdHRlbXB0aW5nIHRvIHdyaXRlIHNlcnZpY2VzIHRvIHtzZXJ2aWNlc0RpY3RGaWxlfScpCgl0cnk6CgkJd2l0aCBvcGVuKHNlcnZpY2VzRGljdEZpbGUsICd3JykgYXMgZjoKCQkJZi53cml0ZShqc29uLmR1bXBzKHNlcnZpY2VzRGljdCwgaW5kZW50PTQpKQoJZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgoJCWxvZ2dlci5lcnJvcihmJ0ZhaWxlZCB0byB3cml0ZSBzZXJ2aWNlc0RpY3QgdG8ge3NlcnZpY2VzRGljdEZpbGV9LiBSZWFzb246IHtlfScpCglyZXR1cm4oc2VydmljZXNEaWN0RmlsZSkKCmRlZiBnZXRQcmludGVycyhkZXZpY2VEYXRhRGljdCk6CgkiIiJHZXQgcHJpbnRlciBpbmZvcm1hdGlvbiBmb3IgbWFjT1MiIiIKCXByaW50ZXJEaWN0ID0ge30KCWRldmljZURhdGFEaWN0WydwcmludGVycyddID0gW10KCgl0cnk6CgkJIyBVc2UgbHBzdGF0IHRvIGdldCBwcmludGVyIGluZm9ybWF0aW9uCgkJY29tbWFuZCA9IFsnbHBzdGF0JywgJy1wJywgJy1sJywgJy1zJ10KCQlyZXN1bHQgPSBzdWJwcm9jZXNzLnJ1bihjb21tYW5kLCBjYXB0dXJlX291dHB1dD1UcnVlLCB0ZXh0PVRydWUpCgoJCWZvciBsaW5lIGluIHJlc3VsdC5zdGRvdXQuc3BsaXRsaW5lcygpOgoJCQlpZiBsaW5lLnN0cmlwKCkuc3RhcnRzd2l0aCgncHJpbnRlcicpOgoJCQkJcHJpbnRlck5hbWUgPSBsaW5lLnNwbGl0KCdwcmludGVyICcpWzFdLnNwbGl0KCcgJylbMF0uc3RyaXAoKQoJCQkJaWYgcHJpbnRlck5hbWUgbm90IGluIHByaW50ZXJEaWN0OgoJCQkJCXByaW50ZXJEaWN0W3ByaW50ZXJOYW1lXSA9IHt9CgkJCWVsaWYgbGluZS5zdHJpcCgpLnN0YXJ0c3dpdGgoJ3N5c3RlbSBkZWZhdWx0Jyk6CgkJCQlkZWZhdWx0UHJpbnRlciA9IGxpbmUuc3BsaXQoJzonKVsxXS5zdHJpcCgpCgkJCQlpZiBkZWZhdWx0UHJpbnRlciBpbiBwcmludGVyRGljdDoKCQkJCQlwcmludGVyRGljdFtkZWZhdWx0UHJpbnRlcl1bJ2RlZmF1bHQnXSA9IFRydWUKCQkJZWxpZiBsaW5lLnN0cmlwKCkuc3RhcnRzd2l0aCgnZGV2aWNlJyk6CgkJCQlwcmludGVyTmFtZSA9IGxpbmUuc3BsaXQoJ2RldmljZSBmb3IgJylbMV0uc3BsaXQoJzonKVswXQoJCQkJcHJpbnRlclBvcnQgPSAnOicuam9pbihsaW5lLnNwbGl0KCc6JylbMTpdKS5zdHJpcCgpCgkJCQlpZiBwcmludGVyTmFtZSBpbiBwcmludGVyRGljdDoKCQkJCQlwcmludGVyRGljdFtwcmludGVyTmFtZV1bJ3BvcnRuYW1lJ10gPSBwcmludGVyUG9ydAoKCQlkZXZpY2VEYXRhRGljdFsncHJpbnRlcnMnXSA9IHByaW50ZXJEaWN0CglleGNlcHQgRXhjZXB0aW9uIGFzIGU6CgkJbG9nZ2VyLmVycm9yKGYnRmFpbGVkIHRvIGdldCBwcmludGVyIGluZm86IHtlfScpCgkJZGV2aWNlRGF0YURpY3RbJ3ByaW50ZXJzJ10gPSB7fQoKCXJldHVybihkZXZpY2VEYXRhRGljdCkKCmRlZiBnZXRQY2lEZXZpY2VzKGRldmljZURhdGFEaWN0KToKCSIiIkdldCBQQ0kgZGV2aWNlIGluZm9ybWF0aW9uIGZvciBtYWNPUyB1c2luZyBzeXN0ZW1fcHJvZmlsZXIiIiIKCXBjaURldmljZURpY3QgPSB7fQoKCXRyeToKCQljb21tYW5kID0gWydzeXN0ZW1fcHJvZmlsZXInLCAnU1BQQ0lEYXRhVHlwZSddCgkJcmVzdWx0ID0gc3VicHJvY2Vzcy5ydW4oY29tbWFuZCwgY2FwdHVyZV9vdXRwdXQ9VHJ1ZSwgdGV4dD1UcnVlKQoKCQljdXJyZW50X2RldmljZSA9IE5vbmUKCQlmb3IgbGluZSBpbiByZXN1bHQuc3Rkb3V0LnNwbGl0bGluZXMoKToKCQkJbGluZSA9IGxpbmUuc3RyaXAoKQoJCQlpZiAnOicgaW4gbGluZSBhbmQgbm90IGxpbmUuc3RhcnRzd2l0aCgnICcpOgoJCQkJIyBUaGlzIGlzIGEgZGV2aWNlIG5hbWUKCQkJCWN1cnJlbnRfZGV2aWNlID0gbGluZS5yc3RyaXAoJzonKQoJCQkJcGNpRGV2aWNlRGljdFtjdXJyZW50X2RldmljZV0gPSB7fQoJCQllbGlmIGN1cnJlbnRfZGV2aWNlIGFuZCAnVHlwZTonIGluIGxpbmU6CgkJCQlkZXZpY2VfdHlwZSA9IGxpbmUuc3BsaXQoJ1R5cGU6JylbMV0uc3RyaXAoKQoJCQkJcGNpRGV2aWNlRGljdFtjdXJyZW50X2RldmljZV1bJ3BucGNsYXNzJ10gPSBkZXZpY2VfdHlwZQoKCQlkZXZpY2VEYXRhRGljdFsncGNpZGV2aWNlcyddID0gcGNpRGV2aWNlRGljdAoJZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgoJCWxvZ2dlci5lcnJvcihmJ0ZhaWxlZCB0byBnZXQgUENJIGRldmljZXM6IHtlfScpCgkJZGV2aWNlRGF0YURpY3RbJ3BjaWRldmljZXMnXSA9IHt9CgoJcmV0dXJuKGRldmljZURhdGFEaWN0KQoKZGVmIGdldFVzYkRldmljZXMoZGV2aWNlRGF0YURpY3QpOgoJIiIiR2V0IFVTQiBkZXZpY2UgaW5mb3JtYXRpb24gZm9yIG1hY09TIHVzaW5nIHN5c3RlbV9wcm9maWxlciIiIgoJdXNiRGV2aWNlTGlzdCA9IFtdCgoJdHJ5OgoJCWNvbW1hbmQgPSBbJ3N5c3RlbV9wcm9maWxlcicsICdTUFVTQkRhdGFUeXBlJ10KCQlyZXN1bHQgPSBzdWJwcm9jZXNzLnJ1bihjb21tYW5kLCBjYXB0dXJlX291dHB1dD1UcnVlLCB0ZXh0PVRydWUpCgoJCWZvciBsaW5lIGluIHJlc3VsdC5zdGRvdXQuc3BsaXRsaW5lcygpOgoJCQlsaW5lID0gbGluZS5zdHJpcCgpCgkJCWlmICc6JyBpbiBsaW5lIGFuZCBub3QgbGluZS5zdGFydHN3aXRoKCcgJyk6CgkJCQkjIFRoaXMgaXMgYSBkZXZpY2UgbmFtZQoJCQkJZGV2aWNlX25hbWUgPSBsaW5lLnJzdHJpcCgnOicpCgkJCQlpZiBkZXZpY2VfbmFtZSBub3QgaW4gdXNiRGV2aWNlTGlzdCBhbmQgZGV2aWNlX25hbWUgIT0gJ1VTQic6CgkJCQkJdXNiRGV2aWNlTGlzdC5hcHBlbmQoZGV2aWNlX25hbWUpCgoJCWRldmljZURhdGFEaWN0Wyd1c2JkZXZpY2VzJ10gPSB1c2JEZXZpY2VMaXN0CglleGNlcHQgRXhjZXB0aW9uIGFzIGU6CgkJbG9nZ2VyLmVycm9yKGYnRmFpbGVkIHRvIGdldCBVU0IgZGV2aWNlczoge2V9JykKCQlkZXZpY2VEYXRhRGljdFsndXNiZGV2aWNlcyddID0gW10KCglyZXR1cm4oZGV2aWNlRGF0YURpY3QpCgojIFdpbmRvd3MgRXZlbnQgTG9nIGZ1bmN0aW9ucyByZW1vdmVkIC0gbm90IGFwcGxpY2FibGUgZm9yIG1hY09TCgojIGRlZiBnZXRTZXJ2ZXJDb2xsVmVyc2lvbihhcHBWZXJzaW9uKToKIyAJbG9nZ2VyLmluZm8oZidDaGVja2luZyBjb2xsZWN0b3IgdmVyc2lvbicpCiMgCWxvZ2dlci5pbmZvKGYnbG9jYWwgY29sbGVjdG9yVmVyc2lvbjoge2FwcFZlcnNpb259JykKIyAJciAJCT0gcmVxdWVzdHMuZ2V0KGYnaHR0cHM6Ly97aG9zdH0vZGlhZ3MvY29sbGVjdG9yVmVyc2lvbicpCiMgCWRhdGEgCT0gci5qc29uKCkKIyAJc2VydmVyQ29sbGVjdG9yVmVyc2lvbiA9IGRhdGFbJ3NlcnZlckNvbGxlY3RvclZlcnNpb24nXQojIAljb2xsSGFzaFB5IAk9IGRhdGFbJ3NlcnZlckhhc2hQeSddCiMgCWNvbGxIYXNoV2luCT0gZGF0YVsnc2VydmVySGFzaFdpbiddCiMgCWxvZ2dlci5pbmZvKGYnc2VydmVyIGNvbGxlY3RvclZlcnNpb246IHtzZXJ2ZXJDb2xsZWN0b3JWZXJzaW9ufScpCiMgCWlmIGludChhcHBWZXJzaW9uKSA8IGludChzZXJ2ZXJDb2xsZWN0b3JWZXJzaW9uKToKIyAJCWxvZ2dlci5pbmZvKCdMb2NhbCBjb2xsZWN0b3IgbmVlZHMgdXBkYXRpbmcuLi4nKQojIAkJY29sbGVjdG9yVXBkYXRlUmVxZCA9IFRydWUKIyAJZWxzZToKIyAJCWxvZ2dlci5pbmZvKCdMb2NhbCBjb2xsZWN0b3IgaXMgdXAgdG8gZGF0ZS4nKQojIAkJY29sbGVjdG9yVXBkYXRlUmVxZCA9IEZhbHNlCiMgCXJldHVybihjb2xsZWN0b3JVcGRhdGVSZXFkLCBjb2xsSGFzaFB5LCBjb2xsSGFzaFdpbikKCmRlZiBnZXRTaGEyNTZIYXNoKGZpbGVUb0hhc2gpOgoJc2hhMjU2SGFzaCA9IGhhc2hsaWIuc2hhMjU2KCkKCXdpdGggb3BlbihmaWxlVG9IYXNoLCAncmInKSBhcyBmOgoJCWZvciBieXRlQmxvY2sgaW4gaXRlcihsYW1iZGE6IGYucmVhZCg0MDk2KSwgYiIiKToKCQkJc2hhMjU2SGFzaC51cGRhdGUoYnl0ZUJsb2NrKQoJbG9nZ2VyLmluZm8oZidzaGEyNTYgb2Yge2ZpbGVUb0hhc2h9OiB7c2hhMjU2SGFzaC5oZXhkaWdlc3QoKX0nKQoJcmV0dXJuKHNoYTI1Nkhhc2guaGV4ZGlnZXN0KCkpCgojIGRlZiB1cGRhdGVDb2xsZWN0b3IoY29sbEhhc2hQeSwgY29sbEhhc2hXaW4pOgojIAlpZiBwbGF0Zm9ybS5zeXN0ZW0oKSA9PSAnTGludXgnOgojIAkJY29sbGVjdG9yVXJsID0gZidodHRwczovL3tob3N0fS9kb3dubG9hZC9jb2xsZWN0b3IucHknCiMgCQljaHVua1NpemUgPSA0MDk2CiMgCQlzYXZlVG9GaWxlID0gZid7c3lzLmFyZ3ZbMF19Lm5ldycKIyAJCWxvZ2dlci5pbmZvKGYnQXR0ZW1wdGluZyB0byBkb3dubG9hZCB7Y29sbGVjdG9yVXJsfSB0byB7c2F2ZVRvRmlsZX0uLi4nKQojIAkJdHJ5OgojIAkJCXIgPSByZXF1ZXN0cy5nZXQoY29sbGVjdG9yVXJsLCBzdHJlYW09VHJ1ZSkKIyAJCQlpZiByLnN0YXR1c19jb2RlICE9IDIwMDoKIyAJCQkJbG9nZ2VyLmVycm9yKGYnRmFpbGVkIHRvIGRvd25sb2FkIHtjb2xsZWN0b3JVcmx9LiBTdGF0dXMgQ29kZToge3Iuc3RhdHVzX2NvZGV9JykKIyAJCQkJcmV0dXJuKEZhbHNlKQojIAkJCXdpdGggb3BlbihzYXZlVG9GaWxlLCAnd2InKSBhcyBmOgojIAkJCQlmb3IgY2h1bmsgaW4gci5pdGVyX2NvbnRlbnQoY2h1bmtfc2l6ZT1jaHVua1NpemUpOgojIAkJCQkJaWYgY2h1bms6CiMgCQkJCQkJZi53cml0ZShjaHVuaykKIyAJCWV4Y2VwdCBFeGNlcHRpb24gYXMgZToKIyAJCQlsb2dnZXIuZXJyb3IoZidGYWlsZWQgdG8gZG93bmxvYWQge2NvbGxlY3RvclVybH0gdG8ge3NhdmVUb0ZpbGV9LiBSZWFzb246IHtlfScpCiMgCQluZXdDb2xsSGFzaCA9IGdldFNoYTI1Nkhhc2goc2F2ZVRvRmlsZSkKIyAJCWxvZ2dlci5pbmZvKGYnRG93bmxvYWRlZCBIYXNoOiB7bmV3Q29sbEhhc2h9IHwgU2VydmVyIEhhc2g6IHtjb2xsSGFzaFB5fScpCiMgCQlpZiBuZXdDb2xsSGFzaCA9PSBjb2xsSGFzaFB5OgojIAkJCWxvZ2dlci5pbmZvKGYnQXR0ZW1wdGluZyB0byByZW5hbWUge3NhdmVUb0ZpbGV9IHRvIHtzeXMuYXJndlswXX0nKQojIAkJCXRyeToKIyAJCQkJb3MucmVuYW1lKHNhdmVUb0ZpbGUsIHN5cy5hcmd2WzBdKQojIAkJCQlsb2dnZXIuaW5mbyhmJ1N1Y2Nlc3NmdWxseSB1cGdyYWRlZCB7Y29sbGVjdG9yVXJsfSB0byB7c2F2ZVRvRmlsZX0nKQojIAkJCQlsb2dnZXIuaW5mbygnTmV3IGNvbGxlY3RvciB3aWxsIHJ1biBvbiBuZXh0IGN5Y2xlJykKIyAJCQlleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiMgCQkJCWxvZ2dlci5lcnJvcihmJ0ZhaWxlZCB0byByZW5hbWUge3NhdmVUb0ZpbGV9IHRvIHtzeXMuYXJndlswXX0uIFJlYXNvbjoge2V9JykKIyAJCWVsc2U6CiMgCQkJbG9nZ2VyLmVycm9yKCdIYXNoZXMgZG8gbm90IG1hdGNoLiBEZWxldGluZyBkb3dubG9hZC4nKQojIAkJCXRyeToKIyAJCQkJb3MucmVtb3ZlKHNhdmVUb0ZpbGUpCiMgCQkJZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgojIAkJCQlsb2dnZXIuZXJyb3IoZidGYWlsZWQgdG8gZGVsZXRlIHtzYXZlVG9GaWxlfS4gUmVhc29uOiB7ZX0nKQoJCQojIAllbGlmIHBsYXRmb3JtLnN5c3RlbSgpID09ICdXaW5kb3dzJzoKIyAJCWNvbW1hbmQgPSBmJyhOZXctT2JqZWN0IFN5c3RlbS5OZXQuV2ViQ2xpZW50KS5Eb3dubG9hZEZpbGUoImh0dHBzOi8vYXBwLndlZ3dlaXNlci50ZWNoL2Rvd25sb2FkL3dlZ3dlaXNlci5leGUiLCIkZW52OlRFTVAvd2Vnd2Vpc2VyLmV4ZSIpOyBcCiMgU3RhcnQtUHJvY2VzcyAtRmlsZVBhdGggIiRlbnY6VEVNUC93ZWd3ZWlzZXIuZXhlIiAtQXJndW1lbnRMaXN0ICIvZ3JvdXB1dWlkPXtncm91cFV1aWR9IiwgIi9MT0c9JGVudjpURU1QL1dlZ3dlaXNlclNldHVwLmxvZyIsICIvU0lMRU5UIicKIyAJCWxvZ2dlci5pbmZvKGYnQXR0ZW1wdGluZyB0byBydW46IHtjb21tYW5kfScpCiMgCQlyZXN1bHQgPSBzdWJwcm9jZXNzLnJ1bihbInBvd2Vyc2hlbGwiLCAiLUNvbW1hbmQiLCBjb21tYW5kXSwgc3Rkb3V0ID0gc3VicHJvY2Vzcy5QSVBFLCB1bml2ZXJzYWxfbmV3bGluZXMgPSBUcnVlKQojIAkJbG9nZ2VyLmluZm8oZidyZXN1bHQ6IHtyZXN1bHQuc3Rkb3V0fScpCgpkZWYgcGFyc2VUaW1lKHRpbWVTdHIpOgogICAgcmV0dXJuIChkYXRldGltZS5kYXRldGltZS5zdHJwdGltZSh0aW1lU3RyLCAiJVktJW0tJWQtJUg6JU06JVMiKSkKCmRlZiBwYXJzZVRpbWUyKHRpbWVTdHIpOgogICAgcmV0dXJuIChkYXRldGltZS5kYXRldGltZS5zdHJwdGltZSh0aW1lU3RyLCAiJVktJW0tJWQgJUg6JU06JVMiKSkKCmRlZiByZWFkRXZlbnRKc29uKGpzb25GaWxlKToKICAgIHdpdGggb3Blbihqc29uRmlsZSwgJ3InKSBhcyBmOgogICAgICAgIGV2ZW50c0RpY3QgPSBqc29uLmxvYWQoZikKICAgIHJldHVybihldmVudHNEaWN0KQoKIyBXaW5kb3dzL0xpbnV4IGxvZyBmaWx0ZXJpbmcgZnVuY3Rpb25zIHJlbW92ZWQgLSBub3QgYXBwbGljYWJsZSBmb3IgbWFjT1MKCmRlZiBzZW5kRXZlbnRNZXRhZGF0YShkZXZpY2VVdWlkKToKCXVybCA9IGYnaHR0cHM6Ly97aG9zdH0vYWkvZGV2aWNlL21ldGFkYXRhJwoJbG9nTmFtZXMgPSBbJ0FwcGxpY2F0aW9uJywgJ1N5c3RlbScsICdTZWN1cml0eSddCglmb3IgbG9nTmFtZSBpbiBsb2dOYW1lczoKCQl3aXRoIG9wZW4ob3MucGF0aC5qb2luKGZpbGVzRGlyLCAnZXZlbnRzRmlsdGVyZWQtJyArIGxvZ05hbWUgKycuanNvbicpLCAncicpIGFzIGY6CgkJCWRhdGEgPSBqc29uLmxvYWQoZikKCQlib2R5ID0gewoJCQknZGV2aWNldXVpZCc6ZGV2aWNlVXVpZCwKCQkJJ21ldGFsb2dvc190eXBlJzpmJ2V2ZW50c0ZpbHRlcmVkLXtsb2dOYW1lfScsCgkJCSdtZXRhbG9nb3MnOmRhdGEKCQkJfQoJCQoJCWhlYWRlcnMgCT0geydDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbid9CgkJbG9nZ2VyLmluZm8oZidBdHRlbXB0aW5nIHRvIFBPU1QgdG86IHt1cmx9JykKCQlyZXNwb25zZSAJPSByZXF1ZXN0cy5wb3N0KHVybCwgaGVhZGVycz1oZWFkZXJzLCBkYXRhPWpzb24uZHVtcHMoYm9keSkpCgkJbG9nZ2VyLmluZm8oZidyZXNwb25zZToge3Jlc3BvbnNlLnN0YXR1c19jb2RlfScpCgkJaWYgcmVzcG9uc2Uuc3RhdHVzX2NvZGUgIT0gMjAxOgoJCQlsb2dnZXIuZXJyb3IoZidGYWlsZWQgdG8gUE9TVCBkYXRhLiBSZWFzb246IHtyZXNwb25zZS50ZXh0fScpCgpkZWYgc2VuZExpbnV4TG9nTWV0YWRhdGEoZGV2aWNlVXVpZCwgbG9nVG9TZW5kKToKCXVybCA9IGYnaHR0cHM6Ly97aG9zdH0vYWkvZGV2aWNlL21ldGFkYXRhJwoJd2l0aCBvcGVuKG9zLnBhdGguam9pbihmaWxlc0RpciwgZid7bG9nVG9TZW5kfUZpbHRlcmVkLmpzb24nKSwgJ3InKSBhcyBmOgoJCWRhdGEgPSBqc29uLmxvYWQoZikKCWJvZHkgPSB7CgkJJ2RldmljZXV1aWQnOmRldmljZVV1aWQsCgkJJ21ldGFsb2dvc190eXBlJzpmJ3tsb2dUb1NlbmR9RmlsdGVyZWQnLAoJCSdtZXRhbG9nb3MnOmRhdGEKCQl9CgloZWFkZXJzIAk9IHsnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nfQoJbG9nZ2VyLmluZm8oZidBdHRlbXB0aW5nIHRvIFBPU1QgdG86IHt1cmx9IGZvciB7bG9nVG9TZW5kfScpCglyZXNwb25zZSAJPSByZXF1ZXN0cy5wb3N0KHVybCwgaGVhZGVycz1oZWFkZXJzLCBkYXRhPWpzb24uZHVtcHMoYm9keSkpCglsb2dnZXIuaW5mbyhmJ3Jlc3BvbnNlOiB7cmVzcG9uc2Uuc3RhdHVzX2NvZGV9JykKCWlmIHJlc3BvbnNlLnN0YXR1c19jb2RlICE9IDIwMToKCQlsb2dnZXIuZXJyb3IoZidGYWlsZWQgdG8gUE9TVCBkYXRhLiBSZWFzb246IHtyZXNwb25zZS50ZXh0fScpCgpkZWYgZ2V0RGF0ZUZvcm1hdChkYXRlU3RyaW5nKToKCWlmICgnLScgaW4gZGF0ZVN0cmluZykgYW5kICgnKycgaW4gZGF0ZVN0cmluZyk6CgkJZXZlbnRUaW1lID0gZGF0ZXRpbWUuZGF0ZXRpbWUuZnJvbWlzb2Zvcm1hdChkYXRlU3RyaW5nKQoJZWxzZToKCQlldmVudFRpbWUgPSBkYXRldGltZS5kYXRldGltZS5zdHJwdGltZShkYXRlU3RyaW5nLCAiJWIgJWQgJUg6JU06JVMiKQoJCWV2ZW50VGltZSA9IGV2ZW50VGltZS5yZXBsYWNlKHllYXI9ZGF0ZXRpbWUuZGF0ZXRpbWUubm93KCkueWVhcikKCXJldHVybihldmVudFRpbWUpCQkKCQojIGRlZiBjaGVja0FyZ3MoYXJncyk6CiMgCWlmIGFyZ3MudmVyc2lvbjoKIyAJCXByaW50KGYne2FwcE5hbWV9IFZlcnNpb246IHthcHBWZXJzaW9ufScpCiMgCQlzeXMuZXhpdCgpCiMgCWlmIGFyZ3MuZ3JvdXBVdWlkOgojIAkJZ3JvdXBVdWlkIAkJPSBhcmdzLmdyb3VwVXVpZAojIAllbHNlOgojIAkJZ3JvdXBVdWlkCQk9IE5vbmUKIyAJaWYgYXJncy5tb2RlOgojIAkJbW9kZSA9IGFyZ3MubW9kZQojIAllbHNlOgojIAkJbW9kZSA9ICdBVURJVCcKIyAJcmV0dXJuKGdyb3VwVXVpZCwgbW9kZSkKCiMgTGludXggbG9nIHByb2Nlc3NpbmcgcmVtb3ZlZCAtIG5vdCBhcHBsaWNhYmxlIGZvciBtYWNPUwoKZGVmIGdldE9zTGFuZyhkZXZpY2VEYXRhRGljdCk6CgkiIiJHZXQgc3lzdGVtIGxvY2FsZSBmb3IgbWFjT1MiIiIKCXN5c3RlbUxvY2FsZSA9ICdOb3QgZGV0ZWN0ZWQnCgoJdHJ5OgoJCSMgR2V0IHN5c3RlbSBsb2NhbGUgdXNpbmcgZGVmYXVsdHMgY29tbWFuZAoJCWNvbW1hbmQgPSBbJ2RlZmF1bHRzJywgJ3JlYWQnLCAnLWcnLCAnQXBwbGVMb2NhbGUnXQoJCXJlc3VsdCA9IHN1YnByb2Nlc3MucnVuKGNvbW1hbmQsIGNhcHR1cmVfb3V0cHV0PVRydWUsIHRleHQ9VHJ1ZSkKCQlpZiByZXN1bHQucmV0dXJuY29kZSA9PSAwOgoJCQlzeXN0ZW1Mb2NhbGUgPSByZXN1bHQuc3Rkb3V0LnN0cmlwKCkKCQllbHNlOgoJCQkjIEZhbGxiYWNrIHRvIGVudmlyb25tZW50IHZhcmlhYmxlCgkJCXN5c3RlbUxvY2FsZSA9IG9zLmdldGVudignTEFORycsICdOb3QgZGV0ZWN0ZWQnKQoJZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgoJCWxvZ2dlci5lcnJvcihmJ0ZhaWxlZCB0byBnZXQgc3lzdGVtIGxvY2FsZToge2V9JykKCQlzeXN0ZW1Mb2NhbGUgPSBvcy5nZXRlbnYoJ0xBTkcnLCAnTm90IGRldGVjdGVkJykKCglsb2dnZXIuZGVidWcoZidzeXN0ZW1Mb2NhbGU6IHtzeXN0ZW1Mb2NhbGV9JykKCWRldmljZURhdGFEaWN0WydzeXN0ZW0nXVsnc3lzdGVtbG9jYWxlJ10gPSBzeXN0ZW1Mb2NhbGUKCXJldHVybihkZXZpY2VEYXRhRGljdCkKCmRlZiBnZXRNYW51ZmFjdHVyZXIoZGV2aWNlRGF0YURpY3QpOgogICAgIiIiR2V0IHN5c3RlbSBtYW51ZmFjdHVyZXIgZm9yIG1hY09TIiIiCiAgICBzeXN0ZW1NYW51ZmFjdHVyZXIgPSAnQXBwbGUgSW5jLicgICMgbWFjT1MgZGV2aWNlcyBhcmUgYWx3YXlzIEFwcGxlCgogICAgbG9nZ2VyLmRlYnVnKGYnc3lzdGVtTWFudWZhY3R1cmVyOiB7c3lzdGVtTWFudWZhY3R1cmVyfScpCiAgICBkZXZpY2VEYXRhRGljdFsnc3lzdGVtJ11bJ3N5c3RlbW1hbnVmYWN0dXJlciddID0gc3lzdGVtTWFudWZhY3R1cmVyCiAgICByZXR1cm4oZGV2aWNlRGF0YURpY3QpCgojIFdpbmRvd3Mtc3BlY2lmaWMgZnVuY3Rpb25zIHJlbW92ZWQgLSBub3QgYXBwbGljYWJsZSBmb3IgbWFjT1MKCmRlZiBnZXRGaWxlVmVyc2lvbihwYXRoLCBHZXRGaWxlVmVyc2lvbkluZm8sIExPV09SRCwgSElXT1JEKToKCXRyeToKCQlpbmZvID0gR2V0RmlsZVZlcnNpb25JbmZvIChwYXRoLCAiXFwiKQoJCW1zID0gaW5mb1snRmlsZVZlcnNpb25NUyddCgkJbHMgPSBpbmZvWydGaWxlVmVyc2lvbkxTJ10KCWV4Y2VwdCBFeGNlcHRpb24gYXMgZToKCQlsb2dnZXIuZXJyb3IoZidWZXJzaW9uIERhdGEgbm90IGZvdW5kLiBSZWFzb246IHtlfScpCgl0cnk6CgkJaW5zdGFsbGVkVmVyc2lvbiA9IHN0cihISVdPUkQgKG1zKSkgKyAnLicgKyBcCgkJCQkJCXN0cihMT1dPUkQgKG1zKSkgKyAnLicgKyBcCgkJCQkJCXN0cihISVdPUkQgKGxzKSkgKyAnLicgKyBcCgkJCQkJCXN0cihMT1dPUkQgKGxzKSkKCQlyZXR1cm4oaW5zdGFsbGVkVmVyc2lvbikKCWV4Y2VwdCBFeGNlcHRpb24gYXMgZToKCQlsb2dnZXIuZXJyb3IoZidlcnJvcjoge2V9JykKCQlyZXR1cm4oJzAuMC4wLjAnKQoKZGVmIGdldEZpbGVNb2RpZmllZERhdGUocGF0aCk6Cgltb2REYXRlID0gaW50KG9zLnBhdGguZ2V0bXRpbWUocGF0aCkpCglyZXR1cm4obW9kRGF0ZSkKCiMgZ2V0RHJpdmVycygpIGZ1bmN0aW9uIHJlbW92ZWQgLSBub3QgYXBwbGljYWJsZSBmb3IgbWFjT1MKCmRlZiBzZW5kTWV0YU1ldGFkYXRhKGRldmljZVV1aWQsIGRhdGEsIG1ldGFOYW1lKToKCXVybCA9IGYnaHR0cHM6Ly97aG9zdH0vbWV0YWRhdGEnCglib2R5ID0gewoJCSdkZXZpY2V1dWlkJzpkZXZpY2VVdWlkLAoJCSdtZXRhbG9nb3NfdHlwZSc6IG1ldGFOYW1lLAoJCSdtZXRhbG9nb3MnOmRhdGEKCQl9CgkKCWhlYWRlcnMgCT0geydDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbid9Cglsb2dnZXIuaW5mbyhmJ0F0dGVtcHRpbmcgdG8gUE9TVCB0bzoge3VybH0nKQoJcmVzcG9uc2UgCT0gcmVxdWVzdHMucG9zdCh1cmwsIGhlYWRlcnM9aGVhZGVycywgZGF0YT1qc29uLmR1bXBzKGJvZHkpKQoJbG9nZ2VyLmluZm8oZidyZXNwb25zZToge3Jlc3BvbnNlLnN0YXR1c19jb2RlfScpCglpZiByZXNwb25zZS5zdGF0dXNfY29kZSAhPSAyMDE6CgkJbG9nZ2VyLmVycm9yKGYnRmFpbGVkIHRvIFBPU1QgZGF0YS4gUmVhc29uOiB7cmVzcG9uc2UudGV4dH0nKQoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyBNQUlOICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCmRlYnVnTW9kZSAJCQk9IFRydWUKaG9zdCAJCQkJPSAnYXBwLndlZ3dlaXNlci50ZWNoJwpwb3J0IAkJCQk9IDQ0MwojYXJncwkJCQk9IHBhcnNlQXJncygpCgppZiBkZWJ1Z01vZGUgPT0gVHJ1ZToKCWxvZ2dlci5pbmZvKCdmdWxsQXVkaXQgU3RhcnRpbmcuLi4nKQoKYXBwRGlyLCBcCglsb2dEaXIsIFwKCWNvbmZpZ0RpciwgXAoJdGVtcERpciwgXAoJZmlsZXNEaXIJCT0gZ2V0QXBwRGlycygpCiNsb2dGaWxlIAkJCT0gZid7bG9nRGlyfS5sb2cnCiNsb2dmaWxlKGxvZ0ZpbGUpCiNsb2dnZXIuZGVidWcoZidsb2dGaWxlOiB7bG9nRmlsZX0nKQphZ2VudENvbmZpZ0ZpbGUgCT0gZid7Y29uZmlnRGlyfWFnZW50LmNvbmZpZycKZGV2aWNlVXVpZCwgXAoJaG9zdAkJPSBnZXREZXZpY2VVdWlkKGFnZW50Q29uZmlnRmlsZSkKbXNpbmZvT3V0cHV0IAkJPSBmJ3tmaWxlc0Rpcn1tc2luZm8udHh0JwoKCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMgTUFDT1MgQVVESVQgIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKZGV2aWNlRGF0YURpY3QgPSB7fQpkZXZpY2VEYXRhRGljdCA9IGdldERldmljZURhdGEoZGV2aWNlRGF0YURpY3QpCmRldmljZURhdGFEaWN0ID0gZ2V0U3lzdGVtRGF0YShkZXZpY2VEYXRhRGljdCkKZGV2aWNlRGF0YURpY3QgPSBnZXREaXNrU3RhdHMoZGV2aWNlRGF0YURpY3QpCmRldmljZURhdGFEaWN0ID0gZ2V0TmV0d29ya0RhdGEoZGV2aWNlRGF0YURpY3QpCmRldmljZURhdGFEaWN0ID0gZ2V0VXNlckRhdGEoZGV2aWNlRGF0YURpY3QpCmRldmljZURhdGFEaWN0ID0gZ2V0VXB0aW1lRGF0YShkZXZpY2VEYXRhRGljdCkKZGV2aWNlRGF0YURpY3QgPSBnZXRCYXR0ZXJ5RGF0YShkZXZpY2VEYXRhRGljdCkKZGV2aWNlRGF0YURpY3QgPSBnZXRtZW1vcnlEYXRhKGRldmljZURhdGFEaWN0KQpkZXZpY2VEYXRhRGljdCA9IGdldENvbGxlY3RvckRhdGEoZGV2aWNlRGF0YURpY3QpCmRldmljZURhdGFEaWN0ID0gZ2V0TWFudWZhY3R1cmVyKGRldmljZURhdGFEaWN0KQpkZXZpY2VEYXRhRGljdCA9IGdldE9zTGFuZyhkZXZpY2VEYXRhRGljdCkKZGV2aWNlRGF0YURpY3QgPSBnZXRDcHVJbmZvKGRldmljZURhdGFEaWN0KQpkZXZpY2VEYXRhRGljdCA9IGdldEdwdUluZm8oZGV2aWNlRGF0YURpY3QpCmRldmljZURhdGFEaWN0ID0gZ2V0U21CaW9zSW5mbyhkZXZpY2VEYXRhRGljdCkKZGV2aWNlRGF0YURpY3QgPSBnZXRTeXN0ZW1Nb2RlbChkZXZpY2VEYXRhRGljdCkKZGV2aWNlRGF0YURpY3QgPSBnZXRQcmludGVycyhkZXZpY2VEYXRhRGljdCkKZGV2aWNlRGF0YURpY3QgPSBnZXRQY2lEZXZpY2VzKGRldmljZURhdGFEaWN0KQpkZXZpY2VEYXRhRGljdCA9IGdldFVzYkRldmljZXMoZGV2aWNlRGF0YURpY3QpCmRldmljZURhdGFEaWN0ID0gZ2V0UGFydGl0aW9uRGF0YShkZXZpY2VEYXRhRGljdCkKIyBnZXREcml2ZXJzKCkgcmVtb3ZlZCAtIG5vdCBhcHBsaWNhYmxlIGZvciBtYWNPUwpzZXJ2aWNlc0RpY3QgPSBnZXRTZXJ2aWNlcygpCgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIFNFTkQgUkVTVUxUUyAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgpyb3V0ZSA9ICcvcGF5bG9hZC9zZW5kYXVkaXQnCnBheWxvYWQgPSB7CgkiZGF0YSI6IGRldmljZURhdGFEaWN0Cn0KCmlmIGRlYnVnTW9kZSA9PSBUcnVlOgoJcHJpbnQoZidwYXlsb2FkIGR1bXBzOiB7anNvbi5kdW1wcyhwYXlsb2FkLCBpbmRlbnQ9NCl9JykKCXdpdGggb3BlbihmJ3tsb2dEaXJ9ZnVsbEF1ZGl0LmxvZycsICdhJykgYXMgZjoKCQlmLndyaXRlKGpzb24uZHVtcHMoZGV2aWNlRGF0YURpY3QsIGluZGVudD00KSkKcmVzcG9uc2UgCT0gc2VuZEpzb25QYXlsb2FkRmxhc2socGF5bG9hZCwgcm91dGUpCmxvZ2dlci5pbmZvKGYnU2VydmVyIHJlc3BvbnNlOiB7cmVzcG9uc2V9IHwge3Jlc3BvbnNlLnRleHR9JykKCgoKCgoKCgoKCgo="}, "resigned_at": 1761308224}