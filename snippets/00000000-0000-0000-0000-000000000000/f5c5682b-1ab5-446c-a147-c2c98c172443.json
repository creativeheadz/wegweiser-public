{"settings": {"snippetUuid": "f5c5682b-1ab5-446c-a147-c2c98c172443", "snippetname": "MacAudit", "snippettype": ".py", "created_at": 1751703858}, "payload": {"payloadsig": "U/27Rn2NwIHKDDL73JVQJ8f/998Aesgb8/s5AIQn6neVOGD7Lf8dZUUeh9F5JZQEALE+TVxtmWH0dXvwK8lFndZcQoAiVti8l8meWFmCi47yAZ8Q891ChiLEfQ4LQrI0zt9zyOOZ6krnT19MOrIXSHr5t1bJcpi2CPZ8+zcoCiZ9L9GyM2wekVJkQkDFOlGFSO5TUuYiz/WmIvUY4A1Zaoieg4HuwgPr1yNwIKWTc8tsRMOtKdcjhe5ZGEFBcJCNgF2J0P3EWzKsjUN+SDIaMGSXnPsON5UYqCe0h0AmAKKF8Jwe+A2HG2Ha+5za+onvM4lk51fWlWWctrl7b4RlWXPSSoxmuPhvdmSlaWAA/h+up3vYW6VfbpwkhfXQ89KUrjsSBD7XtZxnhM4dsov9ln14Ccdb3pdJl/tFXnk3UWcLnbNZT6ptzKh4/K1PEJNqQKk+/9bVC90BJwPeSyyDrr4v9+MBi4c003V9ldOLn9z12eTD6Z8p+TV0pFdLROub3y2vO+LVaXWxNrMCZbBaZu+b2JcsCAN74/CSj4QbVh+3YfsQJwp/WDgAPgqHCaVQe/+vau8a6iW1QZ3vaYuCEHE6NLCM88aia9OCDXUv79NMonGZLjgZgoHLvkKXoWqZRCioBBjwK/f0ZaE5n+srWqdWB/RxyyXcp7cjLFRlAug=", "payloadb64": "IyBGaWxlcGF0aDogc25pcHBldHMvdW5TaWduZWQvZnVsbEF1ZGl0LnB5CiMgRmlsZXBhdGg6IGNvbGxlY3Rvci9jb2xsZWN0b3IucHkKaW1wb3J0IHNvY2tldAppbXBvcnQganNvbgppbXBvcnQgb3MKaW1wb3J0IHBsYXRmb3JtCmltcG9ydCB0aW1lCmltcG9ydCBnZXRwYXNzCmltcG9ydCBzaHV0aWwKaW1wb3J0IG1hdGgKaW1wb3J0IGFyZ3BhcnNlCmltcG9ydCBzeXMKaW1wb3J0IGRhdGV0aW1lCmltcG9ydCBzdWJwcm9jZXNzCmltcG9ydCBoYXNobGliCnRyeToKCWZyb20gbG9nemVybyBpbXBvcnQgbG9nZ2VyLCBsb2dmaWxlCmV4Y2VwdCBFeGNlcHRpb24gYXMgZToKCXN1YnByb2Nlc3MuY2hlY2tfY2FsbChbc3lzLmV4ZWN1dGFibGUsICctbScsICdwaXAnLCAnaW5zdGFsbCcsICdsb2d6ZXJvJ10pCglmcm9tIGxvZ3plcm8gaW1wb3J0IGxvZ2dlciwgbG9nZmlsZQp0cnk6CglpbXBvcnQgcHN1dGlsCmV4Y2VwdCBFeGNlcHRpb24gYXMgZToKCXN1YnByb2Nlc3MuY2hlY2tfY2FsbChbc3lzLmV4ZWN1dGFibGUsICctbScsICdwaXAnLCAnaW5zdGFsbCcsICdwc3V0aWwnXSkKCWltcG9ydCBwc3V0aWwKdHJ5OgoJaW1wb3J0IHJlcXVlc3RzCmV4Y2VwdCBFeGNlcHRpb24gYXMgZToKCXN1YnByb2Nlc3MuY2hlY2tfY2FsbChbc3lzLmV4ZWN1dGFibGUsICctbScsICdwaXAnLCAnaW5zdGFsbCcsICdyZXF1ZXN0cyddKQoJaW1wb3J0IHJlcXVlc3RzCnRyeToKCWltcG9ydCBkbnMucmVzb2x2ZXIKZXhjZXB0OgoJc3VicHJvY2Vzcy5jaGVja19jYWxsKFtzeXMuZXhlY3V0YWJsZSwgJy1tJywgJ3BpcCcsICdpbnN0YWxsJywgJ2Ruc3B5dGhvbiddKQoJaW1wb3J0IGRucy5yZXNvbHZlcgojIG1hY09TLXNwZWNpZmljIGltcG9ydHMgLSBub25lIG5lZWRlZCBmb3IgYmFzaWMgZnVuY3Rpb25hbGl0eQoKCgoKCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMgRlVOQ1RJT05TICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCiMgZGVmIHBhcnNlQXJncygpOgojIAlwYXJzZXIgPSBhcmdwYXJzZS5Bcmd1bWVudFBhcnNlcigpCiMgCXBhcnNlci5hZGRfYXJndW1lbnQoIi10IiwgIi0tdGVtcERpciIsIAkJaGVscCA9ICJFbnRlciB0ZW1wIGRpcmVjdG9yeSIsIAlyZXF1aXJlZD1UcnVlKQojIAlwYXJzZXIuYWRkX2FyZ3VtZW50KCItbSIsICItLW1vZGUiLCAJCWhlbHAgPSAiRW50ZXIgbW9kZSAtIGF1ZGl0IiwgCXJlcXVpcmVkPUZhbHNlKQkKIyAJcGFyc2VyLmFkZF9hcmd1bWVudCgiLWciLCAiLS1ncm91cFV1aWQiLAloZWxwID0gIkVudGVyIGdyb3VwVXVpZCIsCQlyZXF1aXJlZD1GYWxzZSkJCSAKIyAJcGFyc2VyLmFkZF9hcmd1bWVudCgiLXYiLCAiLS12ZXJzaW9uIiwJCWhlbHAgPSAiRGlzcGxheSB0aGUgdmVyc2lvbiIsIAlhY3Rpb249J3N0b3JlX3RydWUnKQojIAlhcmdzID0gcGFyc2VyLnBhcnNlX2FyZ3MoKQkKIyAJcmV0dXJuKGFyZ3MpCgpkZWYgY29udmVydFNpemUoc2l6ZUJ5dGVzKToKCWlmIHNpemVCeXRlcyA9PSAwOgoJCXJldHVybiAiMCBCIgoJc2l6ZU5hbWUgPSAoIkIiLCAiS0IiLCAiTUIiLCAiR0IiLCAiVEIiLCAiUEIiLCAiRUIiLCAiWkIiLCAiWUIiKQoJaSA9IGludChtYXRoLmZsb29yKG1hdGgubG9nKHNpemVCeXRlcywgMTAyNCkpKQoJcCA9IG1hdGgucG93KDEwMjQsIGkpCglzID0gcm91bmQoc2l6ZUJ5dGVzIC8gcCwgMikKCXJldHVybiAoZid7c30ge3NpemVOYW1lW2ldfScpCgpkZWYgc2VuZEpzb25QYXlsb2FkRmxhc2socGF5bG9hZCwgZW5kcG9pbnQpOgoJdXJsIAkJPSBmJ2h0dHBzOi8ve2hvc3R9e2VuZHBvaW50fScKCWlmIGRlYnVnTW9kZSA9PSBUcnVlOgoJCWxvZ2dlci5kZWJ1ZyhmJ3BheWxvYWQgdG8gc2VuZDoge3BheWxvYWR9JykKCQlsb2dnZXIuZGVidWcoZidBdHRlbXB0aW5nIHRvIGNvbm5lY3QgdG8ge3VybH0nKQoJaGVhZGVycyAJPSB7J0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ30KCXJlc3BvbnNlIAk9IHJlcXVlc3RzLnBvc3QodXJsLCBoZWFkZXJzPWhlYWRlcnMsIGRhdGE9anNvbi5kdW1wcyhwYXlsb2FkKSkKCXJldHVybihyZXNwb25zZSkKCmRlZiBnZXRQdWJsaWNJcEFkZHIoKToKCW9kRG5zU2VydmVyIAkJCT0gJzIwOC42Ny4yMjIuMjIyJwoJaHR0cERuc1NlcnZlcgkJCT0gJ2h0dHBzOi8vaWNhbmhhemlwLmNvbScKCWRuc1Jlc29sdmVyIAkJCT0gZG5zLnJlc29sdmVyLlJlc29sdmVyKCkKCWRuc1Jlc29sdmVyLm5hbWVzZXJ2ZXJzID0gW29kRG5zU2VydmVyXQoJdHJ5OgoJCWFuc3dlcnMgCQkJPSBkbnNSZXNvbHZlci5yZXNvbHZlKCdteWlwLm9wZW5kbnMuY29tJywgJ0EnKQoJCWZvciBwdWJsaWNJcCBpbiBhbnN3ZXJzOgoJCQlwdWJsaWNJcCA9IHB1YmxpY0lwLnRvX3RleHQoKQoJZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgoJCWxvZ2dlci5lcnJvcihmJ0ZhaWxlZCB0byBnZXQgcHVibGljSVAgZnJvbSB7b2REbnNTZXJ2ZXJ9LiBSZWFzb246IHtlfScpCgkJcHVibGljSXAgPSBOb25lCglpZiBub3QgcHVibGljSXA6CgkJdHJ5OgoJCQlyIAkJCT0gcmVxdWVzdHMuZ2V0KGh0dHBEbnNTZXJ2ZXIpCgkJCWxvZ2dlci5pbmZvKGYncnRleHQ6IHtyLnRleHR9JykKCQkJcHVibGljSXAgCT0gci50ZXh0LnN0cmlwKCkKCQlleGNlcHQgRXhjZXB0aW9uIGFzIGU6CgkJCWxvZ2dlci5lcnJvcihmJ0ZhaWxlZCB0byBnZXQgcHVibGljSVAgZnJvbSB7aHR0cERuc1NlcnZlcn0uIFJlYXNvbjoge2V9JykKCQkJcHVibGljSXAgPSBOb25lCglpZiBub3QgcHVibGljSXA6CgkJcHVibGljSXAgPSAnMC4wLjAuMCcKCXJldHVybihwdWJsaWNJcCkKCmRlZiBnZXRVc2VySG9tZVBhdGgoKToKCXVzZXJIb21lUGF0aCAJPSBvcy5wYXRoLmV4cGFuZHVzZXIoIn4iKQoJbG9nZ2VyLmluZm8oZid1c2VySG9tZVBhdGg6IHt1c2VySG9tZVBhdGh9JykKCXJldHVybih1c2VySG9tZVBhdGgpCgpkZWYgZ2V0RGV2aWNlVXVpZChjb25maWdGaWxlKToKCWxvZ2dlci5pbmZvKGYnQXR0ZW1wdGluZyB0byByZWFkIGNvbmZpZyBmaWxlOiB7Y29uZmlnRmlsZX0uLi4nKQoJaWYgb3MucGF0aC5pc2ZpbGUoY29uZmlnRmlsZSk6CgkJdHJ5OgoJCQl3aXRoIG9wZW4oY29uZmlnRmlsZSwgJ3InKSBhcyBmOgoJCQkJY29uZmlnRGljdCA9IGpzb24ubG9hZChmKQoJCQlsb2dnZXIuaW5mbyhmJ1N1Y2Nlc3NmdWxseSByZWFkIHtjb25maWdGaWxlfScpCgkJZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgoJCQlsb2dnZXIuZXJyb3IoZidGYWlsZWQgdG8gcmVhZCB7Y29uZmlnRmlsZX0nKQoJCQlxdWl0KCdRdWl0dGluZy4nKQoJCWRldmljZVV1aWQgCT0gY29uZmlnRGljdFsnZGV2aWNldXVpZCddCgkJaWYgJ3NlcnZlckFkZHInIGluIGNvbmZpZ0RpY3Q6CgkJCWhvc3QgPSBjb25maWdEaWN0WydzZXJ2ZXJBZGRyJ10KCQllbHNlOgoJCQlob3N0ID0gJ2FwcC53ZWd3ZWlzZXIudGVjaCcKCWVsc2U6CgkJbG9nZ2VyLmVycm9yKGYne2NvbmZpZ0ZpbGV9IGRvZXMgbm90IGV4aXN0LiBRdWl0dGluZy4nKQoJcmV0dXJuKGRldmljZVV1aWQsIGhvc3QpCgojIGRlZiB3cml0ZVdlZ0NvbmZpZ0ZpbGUoZGV2aWNldXVpZCwgZ3JvdXB1dWlkKToKIyAJY29uZmlnRGljdCA9IHsnZGV2aWNldXVpZCc6ZGV2aWNldXVpZCwgJ2dyb3VwdXVpZCc6Z3JvdXB1dWlkfQojIAlsb2dnZXIuaW5mbyhmJ0F0dGVtcHRpbmcgdG8gd3JpdGUgdG8ge3dlZ0NvbmZpZ0ZpbGV9JykKIyAJd2l0aCBvcGVuKHdlZ0NvbmZpZ0ZpbGUsICd3JykgYXMgZjoKIyAJCWYud3JpdGUoanNvbi5kdW1wcyhjb25maWdEaWN0LCBpbmRlbnQ9NCkpCiMgCWxvZ2dlci5pbmZvKGYne3dlZ0NvbmZpZ0ZpbGV9IHdyaXR0ZW4gc3VjY2Vzc2Z1bGx5LicpCgojIGRlZiByZWdpc3RlckRldmljZShncm91cHV1aWQpOgojIAllbmRwb2ludCAJCT0gJy9kZXZpY2VzL3JlZ2lzdGVyJwojIAlkZXZpY2VOYW1lIAkJPSBzb2NrZXQuZ2V0aG9zdG5hbWUoKQojIAloYXJkd2FyZUluZm8gCT0gcGxhdGZvcm0uc3lzdGVtKCkKIyAJcGF5bG9hZCAJCT0geydncm91cHV1aWQnOiBncm91cHV1aWQsICdkZXZpY2VuYW1lJzogZGV2aWNlTmFtZSwgJ2hhcmR3YXJlaW5mbyc6IGhhcmR3YXJlSW5mb30KIyAJcmVzcG9uc2UgCQk9IHNlbmRKc29uUGF5bG9hZEZsYXNrKHBheWxvYWQsIGVuZHBvaW50KQojIAlsb2dnZXIuZGVidWcoZidyZXNwb25zZToge3Jlc3BvbnNlLnRleHR9JykKIyAJZGV2aWNlVXVpZCAJCT0ganNvbi5sb2FkcyhyZXNwb25zZS50ZXh0KVsnZGV2aWNldXVpZCddCiMgCWxvZ2dlci5kZWJ1ZyhmJ0RldmljZSBpc3N1ZWQgbmV3IGRldmljZVV1aWQ6IHtkZXZpY2VVdWlkfScpCiMgCXJldHVybihkZXZpY2VVdWlkKQoKZGVmIGdldERldmljZURhdGEoZGV2aWNlRGF0YURpY3QpOgoJZGV2aWNlRGF0YURpY3RbJ2RldmljZSddIAkJCQkJPSB7fQoJZGV2aWNlRGF0YURpY3RbJ2RldmljZSddWydkZXZpY2VVdWlkJ10JCT0gZid7ZGV2aWNlVXVpZH0nCiMJZGV2aWNlRGF0YURpY3RbJ2RldmljZSddWydncm91cFV1aWQnXQkJPSBmJ3tncm91cFV1aWR9JwoJZGV2aWNlRGF0YURpY3RbJ2RldmljZSddWydzeXN0ZW10aW1lJ10JCT0gaW50KHRpbWUudGltZSgpKQoJaWYgZGVidWdNb2RlID09IFRydWU6CgkJbG9nZ2VyLmRlYnVnKGpzb24uZHVtcHMoZGV2aWNlRGF0YURpY3QsIGluZGVudD00KSkKCXJldHVybihkZXZpY2VEYXRhRGljdCkKCmRlZiBnZXRTeXN0ZW1EYXRhKGRldmljZURhdGFEaWN0KToKCWRldmljZURhdGFEaWN0WydzeXN0ZW0nXSAJCQkJCT0ge30JCglkZXZpY2VEYXRhRGljdFsnc3lzdGVtJ11bJ2RldmljZVBsYXRmb3JtJ10gCT0gcGxhdGZvcm0ucGxhdGZvcm0oKQoJZGV2aWNlRGF0YURpY3RbJ3N5c3RlbSddWydzeXN0ZW1OYW1lJ10JCT0gc29ja2V0LmdldGhvc3RuYW1lKCkKCWRldmljZURhdGFEaWN0WydzeXN0ZW0nXVsnY3VycmVudFVzZXInXQkJPSBnZXRwYXNzLmdldHVzZXIoKQoJZGV2aWNlRGF0YURpY3RbJ3N5c3RlbSddWydjcHVVc2FnZSddCQk9IHBzdXRpbC5jcHVfcGVyY2VudCg0KQoJZGV2aWNlRGF0YURpY3RbJ3N5c3RlbSddWydjcHVDb3VudCddIAkJPSBwc3V0aWwuY3B1X2NvdW50KCkKCWRldmljZURhdGFEaWN0WydzeXN0ZW0nXVsncHVibGljSXAnXSAJCT0gZ2V0UHVibGljSXBBZGRyKCkKCXJldHVybihkZXZpY2VEYXRhRGljdCkKCmRlZiBnZXRDb2xsZWN0b3JEYXRhKGRldmljZURhdGFEaWN0KToKCWFnZW50VmVyc2lvbkZpbGUgPSBvcy5wYXRoLmpvaW4oY29uZmlnRGlyLCAnYWdlbnRWZXJzaW9uLnR4dCcpCgl3aXRoIG9wZW4oYWdlbnRWZXJzaW9uRmlsZSwgJ3InKSBhcyBmOgoJCWxvY2FsQWdlbnRWZXJzaW9uID0gZi5yZWFkKCkuc3RyaXAoKQoJbG9nZ2VyLmluZm8oZidsb2NhbEFnZW50VmVyc2lvbjoge2xvY2FsQWdlbnRWZXJzaW9ufScpCglkZXZpY2VEYXRhRGljdFsnY29sbGVjdG9yJ10gCQkJCQk9IHt9CglkZXZpY2VEYXRhRGljdFsnY29sbGVjdG9yJ11bJ2NvbGx2ZXJzaW9uJ10JCT0gbG9jYWxBZ2VudFZlcnNpb24KCWRldmljZURhdGFEaWN0Wydjb2xsZWN0b3InXVsnY29sbGluc3RhbGxkaXInXQk9IGFwcERpcgoJcmV0dXJuKGRldmljZURhdGFEaWN0KQoKZGVmIGdldFVwdGltZURhdGEoZGV2aWNlRGF0YURpY3QpOgoJaWYgJ3N5c3RlbScgbm90IGluIGRldmljZURhdGFEaWN0OgoJCWRldmljZURhdGFEaWN0WydzeXN0ZW0nXSA9IHt9CglkZXZpY2VEYXRhRGljdFsnc3lzdGVtJ11bJ2Jvb3RUaW1lJ10JCT0gaW50KHBzdXRpbC5ib290X3RpbWUoKSkKCXJldHVybihkZXZpY2VEYXRhRGljdCkKCmRlZiBnZXROZXR3b3JrRGF0YShkZXZpY2VEYXRhRGljdCk6CglkZXZpY2VEYXRhRGljdFsnbmV0d29ya0xpc3QnXQkJCQk9IFtdCglwc05ldERpY3QgCQkJCQkJCQkJPSBwc3V0aWwubmV0X2lmX3N0YXRzKCkKCWlmRGljdCAJCQkJCQkJCQkJPSB7fQoKCWZvciBpZk5hbWUsIGRhdGEgaW4gcHNOZXREaWN0Lml0ZW1zKCk6CgkJaWZEaWN0W2lmTmFtZV0gCQkJCT0ge30KCQlpZkRpY3RbaWZOYW1lXVsnaWZJc1VwJ10JPSBkYXRhLmlzdXAKCQlpZkRpY3RbaWZOYW1lXVsnaWZTcGVlZCddCT0gZGF0YS5zcGVlZAoJCWlmRGljdFtpZk5hbWVdWydpZk10dSddCQk9IGRhdGEubXR1CgoJcHNOZXREaWN0IAkJCQkJCQkJCT0gcHN1dGlsLm5ldF9pb19jb3VudGVycyhwZXJuaWM9VHJ1ZSkKCWZvciBpZk5hbWUsIGRhdGEgaW4gcHNOZXREaWN0Lml0ZW1zKCk6CgkJaWYgaWZOYW1lIGluIGlmRGljdDogICMgT25seSBwcm9jZXNzIGludGVyZmFjZXMgd2UgZm91bmQgYmVmb3JlCgkJCWlmRGljdFtpZk5hbWVdWydieXRlc1NlbnQnXSAJPSBkYXRhLmJ5dGVzX3JlY3YKCQkJaWZEaWN0W2lmTmFtZV1bJ2J5dGVzUmVjdiddIAk9IGRhdGEuYnl0ZXNfc2VudAoJCQlpZkRpY3RbaWZOYW1lXVsnZXJySW4nXSAJCT0gZGF0YS5lcnJpbgoJCQlpZkRpY3RbaWZOYW1lXVsnZXJyT3V0J10gCQk9IGRhdGEuZXJyb3V0CgoJcHNOZXREaWN0IAkJCQkJCQkJCT0gcHN1dGlsLm5ldF9pZl9hZGRycygpCglmb3IgaWZOYW1lLCBhZGRyZXNzZXMgaW4gcHNOZXREaWN0Lml0ZW1zKCk6CgkJaWYgaWZOYW1lIGluIGlmRGljdDogICMgT25seSBwcm9jZXNzIGludGVyZmFjZXMgd2UgZm91bmQgYmVmb3JlCgkJCWZvciBhZGRyZXNzIGluIGFkZHJlc3NlczoKCQkJCWlmIGFkZHJlc3MuZmFtaWx5ID09IHNvY2tldC5BRl9JTkVUOgoJCQkJCWlmRGljdFtpZk5hbWVdWydhZGRyZXNzNCddIAkJPSBhZGRyZXNzLmFkZHJlc3MKCQkJCQlpZkRpY3RbaWZOYW1lXVsnbmV0bWFzazQnXSAJCT0gYWRkcmVzcy5uZXRtYXNrCgkJCQkJaWZEaWN0W2lmTmFtZV1bJ2Jyb2FkY2FzdDQnXSAJPSBhZGRyZXNzLmJyb2FkY2FzdAoJCQkJZWxpZiBhZGRyZXNzLmZhbWlseSA9PSBzb2NrZXQuQUZfSU5FVDY6CgkJCQkJaWZEaWN0W2lmTmFtZV1bJ2FkZHJlc3M2J10gCQk9IGFkZHJlc3MuYWRkcmVzcwoJCQkJCWlmRGljdFtpZk5hbWVdWyduZXRtYXNrNiddIAkJPSBhZGRyZXNzLm5ldG1hc2sKCQkJCQlpZkRpY3RbaWZOYW1lXVsnYnJvYWRjYXN0NiddIAk9IGFkZHJlc3MuYnJvYWRjYXN0CglkZXZpY2VEYXRhRGljdFsnbmV0d29ya0xpc3QnXS5hcHBlbmQoaWZEaWN0KQkKCXJldHVybihkZXZpY2VEYXRhRGljdCkJCgkKZGVmIGdldFVzZXJEYXRhKGRldmljZURhdGFEaWN0KToKCXVzZXJzIAkJPSBwc3V0aWwudXNlcnMoKQoJZGV2aWNlRGF0YURpY3RbJ1VzZXJzJ10gCQkJCT0gW10KCXVzZXJEaWN0IAk9IHt9Cgl1c2VySWQgCQk9IDAKCWZvciB1c2VyIGluIHVzZXJzOgoJCXVzZXJEaWN0W3VzZXJJZF0gCQkJCT0ge30KCQl1c2VyRGljdFt1c2VySWRdWyd1c2VybmFtZSddIAk9IHVzZXIubmFtZQoJCWlmIG5vdCB1c2VyLnRlcm1pbmFsOgoJCQl1c2VyRGljdFt1c2VySWRdWyd0ZXJtaW5hbCddIAk9ICctMScKCQllbHNlOgoJCQl1c2VyRGljdFt1c2VySWRdWyd0ZXJtaW5hbCddIAk9IHVzZXIudGVybWluYWwKCQlpZiBub3QgdXNlci5ob3N0OgoJCQl1c2VyRGljdFt1c2VySWRdWydob3N0J10gCT0gJ2xvY2FsaG9zdCcKCQllbHNlOgoJCQl1c2VyRGljdFt1c2VySWRdWydob3N0J10gCQk9IHVzZXIuaG9zdAoJCXVzZXJEaWN0W3VzZXJJZF1bJ2xvZ2dlZEluJ10gCT0gdXNlci5zdGFydGVkCgkJaWYgbm90IHVzZXIucGlkOgoJCQl1c2VyRGljdFt1c2VySWRdWydwaWQnXQkJCT0gLTEKCQllbHNlOgoJCQl1c2VyRGljdFt1c2VySWRdWydwaWQnXSAJCT0gdXNlci5waWQKCQl1c2VySWQgKz0gMQoJZGV2aWNlRGF0YURpY3RbJ1VzZXJzJ10uYXBwZW5kKHVzZXJEaWN0KQoJcmV0dXJuKGRldmljZURhdGFEaWN0KQoKIyBXaW5kb3dzLXNwZWNpZmljIGZ1bmN0aW9uIHJlbW92ZWQgZm9yIG1hY09TLW9ubHkgc2NyaXB0CgpkZWYgZ2V0RGlza1N0YXRzKGRldmljZURhdGFEaWN0KToKCSIiIkdldCBkaXNrIHVzYWdlIHN0YXRpc3RpY3MgZm9yIG1hY09TIiIiCglkcml2ZURhdGEgPSB7fQoJc3RhdCA9IHNodXRpbC5kaXNrX3VzYWdlKCcvJykKCXRvdGFsID0gc3RhdC50b3RhbAoJdXNlZCA9IHN0YXQudXNlZAoJZnJlZSA9IHN0YXQuZnJlZQoJdXNlZFBlciA9ICh1c2VkIC8gdG90YWwpICogMTAwCglmcmVlUGVyID0gKGZyZWUgLyB0b3RhbCkgKiAxMDAKCWRldmljZURhdGFEaWN0Wydkcml2ZXMnXSA9IFtdCglkcml2ZURhdGFbJ25hbWUnXSA9ICcvJwoJZHJpdmVEYXRhWyd0b3RhbCddID0gdG90YWwKCWRyaXZlRGF0YVsndXNlZCddID0gdXNlZAoJZHJpdmVEYXRhWydmcmVlJ10gPSBmcmVlCglkcml2ZURhdGFbJ3VzZWRQZXInXSA9IHVzZWRQZXIKCWRyaXZlRGF0YVsnZnJlZVBlciddID0gZnJlZVBlcgoJZGV2aWNlRGF0YURpY3RbJ2RyaXZlcyddLmFwcGVuZChkcml2ZURhdGEpCglyZXR1cm4oZGV2aWNlRGF0YURpY3QpCgpkZWYgZ2V0QmF0dGVyeURhdGEoZGV2aWNlRGF0YURpY3QpOgogICAgYmF0dGVyeSA9IHBzdXRpbC5zZW5zb3JzX2JhdHRlcnkoKQogICAgZGV2aWNlRGF0YURpY3RbJ2JhdHRlcnknXSA9IHt9CiAgICBpZiBiYXR0ZXJ5OgogICAgICAgIGRldmljZURhdGFEaWN0WydiYXR0ZXJ5J11bJ2luc3RhbGxlZCddID0gVHJ1ZQogICAgICAgIGRldmljZURhdGFEaWN0WydiYXR0ZXJ5J11bJ3BjQ2hhcmdlZCddID0gYmF0dGVyeS5wZXJjZW50CiAgICAgICAgIyBGaXggZm9yIG1hY09TIGJhdHRlcnkgc2Vjb25kcyBsZWZ0IGhhbmRsaW5nCiAgICAgICAgaWYgYmF0dGVyeS5zZWNzbGVmdCA9PSAtMjogICMgUG93ZXIgY29ubmVjdGVkCiAgICAgICAgICAgIGRldmljZURhdGFEaWN0WydiYXR0ZXJ5J11bJ3NlY3NMZWZ0J10gPSAtMgogICAgICAgIGVsaWYgYmF0dGVyeS5zZWNzbGVmdCA9PSAtMTogICMgQ2FsY3VsYXRpbmcuLi4KICAgICAgICAgICAgZGV2aWNlRGF0YURpY3RbJ2JhdHRlcnknXVsnc2Vjc0xlZnQnXSA9IC0xCiAgICAgICAgZWxzZToKICAgICAgICAgICAgZGV2aWNlRGF0YURpY3RbJ2JhdHRlcnknXVsnc2Vjc0xlZnQnXSA9IGJhdHRlcnkuc2Vjc2xlZnQKICAgICAgICBkZXZpY2VEYXRhRGljdFsnYmF0dGVyeSddWydwb3dlclBsdWcnXSA9IGJhdHRlcnkucG93ZXJfcGx1Z2dlZAogICAgZWxzZToKICAgICAgICBkZXZpY2VEYXRhRGljdFsnYmF0dGVyeSddWydpbnN0YWxsZWQnXSA9IEZhbHNlCiAgICAgICAgZGV2aWNlRGF0YURpY3RbJ2JhdHRlcnknXVsncGNDaGFyZ2VkJ10gPSAwCiAgICAgICAgZGV2aWNlRGF0YURpY3RbJ2JhdHRlcnknXVsnc2Vjc0xlZnQnXSA9IDAKICAgICAgICBkZXZpY2VEYXRhRGljdFsnYmF0dGVyeSddWydwb3dlclBsdWcnXSA9IEZhbHNlCiAgICByZXR1cm4oZGV2aWNlRGF0YURpY3QpCgpkZWYgZ2V0UGFydGl0aW9uRGF0YShkZXZpY2VEYXRhRGljdCk6CglwYXJ0aXRpb25EaWN0IAkJCQkJPSB7fQoJZGV2aWNlRGF0YURpY3RbJ3BhcnRpdGlvbnMnXSAJPSBbXQoJcGFydGl0aW9uc0xpc3QJCQkJCT0gcHN1dGlsLmRpc2tfcGFydGl0aW9ucygpCglmb3IgcGFydGl0aW9uIGluIHBhcnRpdGlvbnNMaXN0OgoJCXBhcnRpdGlvbkRpY3RbcGFydGl0aW9uLm1vdW50cG9pbnRdIAkJCT0ge30KCQlwYXJ0aXRpb25EaWN0W3BhcnRpdGlvbi5tb3VudHBvaW50XVsnZGV2aWNlJ10JPSBwYXJ0aXRpb24uZGV2aWNlCgkJcGFydGl0aW9uRGljdFtwYXJ0aXRpb24ubW91bnRwb2ludF1bJ2ZzdHlwZSddCT0gcGFydGl0aW9uLmZzdHlwZQoJZGV2aWNlRGF0YURpY3RbJ3BhcnRpdGlvbnMnXS5hcHBlbmQocGFydGl0aW9uRGljdCkKCXJldHVybihkZXZpY2VEYXRhRGljdCkKCmRlZiBnZXRtZW1vcnlEYXRhKGRldmljZURhdGFEaWN0KToKCW1lbW9yeSAJCQkJCQkJCQk9IHBzdXRpbC52aXJ0dWFsX21lbW9yeSgpCglkZXZpY2VEYXRhRGljdFsnbWVtb3J5J10JIAkJCT0ge30KCWRldmljZURhdGFEaWN0WydtZW1vcnknXVsndG90YWwnXQkJPSBtZW1vcnkudG90YWwKCWRldmljZURhdGFEaWN0WydtZW1vcnknXVsnYXZhaWxhYmxlJ10JPSBtZW1vcnkuYXZhaWxhYmxlCglkZXZpY2VEYXRhRGljdFsnbWVtb3J5J11bJ3VzZWQnXQkJPSBtZW1vcnkudXNlZAoJZGV2aWNlRGF0YURpY3RbJ21lbW9yeSddWydmcmVlJ10JCT0gbWVtb3J5LmZyZWUKCXJldHVybihkZXZpY2VEYXRhRGljdCkKCgoKZGVmIGNoZWNrTW9kZShtb2RlKToKCXZhbGlkTW9kZXMgPSBbJ0FVRElUJywgJ0VWRU5UTE9HJywgJ1NUQVRVUycsICdXRUdMT0cnLCAnRlVMTEFVRElUJywgCgkJCSAgIAkJJ01TSU5GTycsICdVUERBVEUnLCAnSU5TVEFMTCcsICdSRVNFVEVWRU5UUyddCglpZiBtb2RlLnVwcGVyKCkgaW4gdmFsaWRNb2RlczoKCQlyZXR1cm4obW9kZSkKCWVsc2U6CgkJbG9nZ2VyLmVycm9yKGYnSW52YWxpZCBtb2RlIHNwZWNpZmllZDoge21vZGV9JykKCQlzeXMuZXhpdCgpCgpkZWYgZ2V0V2VnQ29uZmlnRmlsZVgoY29uZmlnRGlyKToKCSIiIkdldCBjb25maWcgZmlsZSBwYXRoIGZvciBtYWNPUyIiIgoJd2VnQ29uZmlnRmlsZSA9IGYne2NvbmZpZ0Rpcn1hZ2VudC5jb25maWcnCglyZXR1cm4od2VnQ29uZmlnRmlsZSkKCmRlZiBnZXRBcHBEaXJzKCk6CgkiIiJHZXQgYXBwbGljYXRpb24gZGlyZWN0b3JpZXMgZm9yIG1hY09TIiIiCglhcHBEaXIgPSAnL29wdC9XZWd3ZWlzZXIvJwoJbG9nRGlyID0gb3MucGF0aC5qb2luKGFwcERpciwgJ0xvZ3MnLCAnJykKCWNvbmZpZ0RpciA9IG9zLnBhdGguam9pbihhcHBEaXIsICdDb25maWcnLCAnJykKCXRlbXBEaXIgPSBvcy5wYXRoLmpvaW4oYXBwRGlyLCAnVGVtcCcsICcnKQoJZmlsZXNEaXIgPSBvcy5wYXRoLmpvaW4oYXBwRGlyLCAnRmlsZXMnLCAnJykKCWNoZWNrRGlycyhbYXBwRGlyLCBsb2dEaXIsIGNvbmZpZ0RpciwgdGVtcERpciwgZmlsZXNEaXJdKQoJcmV0dXJuKGFwcERpciwgbG9nRGlyLCBjb25maWdEaXIsIHRlbXBEaXIsIGZpbGVzRGlyKQoKZGVmIGNoZWNrRGlycyhkaXJzVG9DaGVjayk6Cglmb3IgZGlyVG9DaGVjayBpbiBkaXJzVG9DaGVjazoKCQlkaXJUb0NoZWNrID0gb3MucGF0aC5qb2luKGRpclRvQ2hlY2ssICcnKQoJCWlmIG5vdCBvcy5wYXRoLmlzZGlyKGRpclRvQ2hlY2spOgoJCQlsb2dnZXIuaW5mbyhmJ3tkaXJUb0NoZWNrfSBkb2VzIG5vdCBleGlzdC4gQ3JlYXRpbmcuLi4nKQoJCQl0cnk6CgkJCQlvcy5tYWtlZGlycyhkaXJUb0NoZWNrKQoJCQkJbG9nZ2VyLmluZm8oZid7ZGlyVG9DaGVja30gY3JlYXRlZC4nKQoJCQlleGNlcHQgRXhjZXB0aW9uIGFzIGU6CgkJCQlsb2dnZXIuZXJyb3IoZidGYWlsZWQgdG8gY3JlYXRlIHtkaXJUb0NoZWNrfS4gUmVhc29uOiB7ZX0nKQoJCQkJc3lzLmV4aXQoKQoKZGVmIGRlbEZpbGUoZmlsZVRvRGVsZXRlKToKCWxvZ2dlci5pbmZvKGYnQXR0ZW1wdGluZyB0byBkZWxldGUge2ZpbGVUb0RlbGV0ZX0uLi4nKQoJdHJ5OgoJCW9zLnJlbW92ZShmaWxlVG9EZWxldGUpCgkJbG9nZ2VyLmluZm8oZidTdWNjZXNzZnVsbHkgZGVsZXRlZCB7ZmlsZVRvRGVsZXRlfS4nKQoJZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgoJCWxvZ2dlci5lcnJvcihmJ0ZhaWxlZCB0byBkZWxldGUge2ZpbGVUb0RlbGV0ZX0uIFJlYXNvbjoge2V9JykKCiMgV2luZG93cyBNU0luZm8gZnVuY3Rpb25zIHJlbW92ZWQgLSBub3QgYXBwbGljYWJsZSBmb3IgbWFjT1MKIyBNU0luZm8gcHJvY2Vzc2luZyByZW1vdmVkIC0gbm90IGFwcGxpY2FibGUgZm9yIG1hY09TCgpkZWYgZ2V0Q3B1SW5mbyhkZXZpY2VEYXRhRGljdCk6CgkiIiJHZXQgQ1BVIGluZm9ybWF0aW9uIGZvciBtYWNPUyIiIgoJY29tbWFuZCA9IFsnc3lzY3RsJywgJy1uJywgJ21hY2hkZXAuY3B1LmJyYW5kX3N0cmluZyddCglyZXN1bHQgPSBzdWJwcm9jZXNzLnJ1bihjb21tYW5kLCBjYXB0dXJlX291dHB1dD1UcnVlLCB0ZXh0PVRydWUpCgljcHVOYW1lID0gcmVzdWx0LnN0ZG91dC5zdHJpcCgpCgoJbG9nZ2VyLmluZm8oZidjcHVOYW1lOiB7Y3B1TmFtZX0nKQoJZGV2aWNlRGF0YURpY3RbJ2NwdSddID0ge30KCWRldmljZURhdGFEaWN0WydjcHUnXVsnY3B1bmFtZSddID0gY3B1TmFtZQoJcmV0dXJuKGRldmljZURhdGFEaWN0KQoKZGVmIGNoZWNrQXBwSW5zdGFsbGVkKGFwcE5hbWUpOgoJbG9nZ2VyLmluZm8oZidDaGVja2luZyBpZiB7YXBwTmFtZX0gZXhpc3RzLi4uJykKCWNvbW1hbmQgCT0gWyJ3aGljaCIsIGFwcE5hbWVdCglyZXN1bHQgCQk9IHN1YnByb2Nlc3MuUG9wZW4oY29tbWFuZCwgc3Rkb3V0PXN1YnByb2Nlc3MuUElQRSkKCXJlc3VsdCAJCT0gcmVzdWx0LnN0ZG91dC5yZWFkKCkuZGVjb2RlKCJ1dGYtOCIpLnN0cmlwKCkKCWxvZ2dlci5pbmZvKGYnRToge3Jlc3VsdH0nKQoJaWYgbGVuKHJlc3VsdCkgPiAwOgoJCWxvZ2dlci5pbmZvKGYne2FwcE5hbWV9IGV4aXN0cycpCgkJcmV0dXJuKFRydWUpCgllbHNlOgoJCWxvZ2dlci5pbmZvKGYne2FwcE5hbWV9IGRvZXMgbm90IGV4aXN0JykKCQlyZXR1cm4oRmFsc2UpCgpkZWYgZ2V0R3B1SW5mbyhkZXZpY2VEYXRhRGljdCk6CgkiIiJHZXQgR1BVIGluZm9ybWF0aW9uIGZvciBtYWNPUyIiIgoJdmVuZG9yID0gJ05vIGRhdGEgZm91bmQnCglwcm9kdWN0ID0gJ05vIGRhdGEgZm91bmQnCgljb2xvdXJEZXB0aCA9IC0xCgloUmVzID0gLTEKCXZSZXMgPSAtMQoKCWNvbW1hbmQgPSBbJ3N5c3RlbV9wcm9maWxlcicsICdTUERpc3BsYXlzRGF0YVR5cGUnXQoJcmVzdWx0ID0gc3VicHJvY2Vzcy5ydW4oY29tbWFuZCwgY2FwdHVyZV9vdXRwdXQ9VHJ1ZSwgdGV4dD1UcnVlKQoJZm9yIGxpbmUgaW4gcmVzdWx0LnN0ZG91dC5zcGxpdGxpbmVzKCk6CgkJaWYgJ0NoaXBzZXQgTW9kZWwnIGluIGxpbmU6CgkJCXByb2R1Y3QgPSBsaW5lLnNwbGl0KCc6ICcpWzFdLnN0cmlwKCkKCQlpZiAnVmVuZG9yJyBpbiBsaW5lOgoJCQl2ZW5kb3IgPSBsaW5lLnNwbGl0KCc6ICcpWzFdLnN0cmlwKCkKCQlpZiAnUmVzb2x1dGlvbicgaW4gbGluZToKCQkJcmVzb2x1dGlvbiA9IGxpbmUuc3BsaXQoJzogJylbMV0uc3RyaXAoKQoJCQl0cnk6CgkJCQloUmVzLCB2UmVzID0gcmVzb2x1dGlvbi5zcGxpdCgnIHggJykKCQkJCWhSZXMgPSBpbnQoaFJlcykKCQkJCXZSZXMgPSAnJy5qb2luKGZpbHRlcihzdHIuaXNkaWdpdCwgdlJlcykpCgkJCQl2UmVzID0gaW50KHZSZXMpIGlmIHZSZXMuaXNkaWdpdCgpIGVsc2UgLTEKCQkJZXhjZXB0OgoJCQkJaFJlcyA9IC0xCgkJCQl2UmVzID0gLTEKCQlpZiAnRnJhbWVidWZmZXIgRGVwdGgnIGluIGxpbmU6CgkJCXRyeToKCQkJCWNvbG91ckRlcHRoID0gaW50KGxpbmUuc3BsaXQoJzogJylbMV0uc3RyaXAoKS5zcGxpdCgnLScpWzBdKQoJCQlleGNlcHQ6CgkJCQljb2xvdXJEZXB0aCA9IC0xCgoJZGV2aWNlRGF0YURpY3RbJ2dwdWluZm8nXSA9IHt9CglkZXZpY2VEYXRhRGljdFsnZ3B1aW5mbyddWydncHV2ZW5kb3InXSA9IHZlbmRvcgoJZGV2aWNlRGF0YURpY3RbJ2dwdWluZm8nXVsnZ3B1cHJvZHVjdCddID0gcHJvZHVjdAoJZGV2aWNlRGF0YURpY3RbJ2dwdWluZm8nXVsnZ3B1Y29sb3VyJ10gPSBjb2xvdXJEZXB0aAoJZGV2aWNlRGF0YURpY3RbJ2dwdWluZm8nXVsnZ3B1aHJlcyddID0gaFJlcwoJZGV2aWNlRGF0YURpY3RbJ2dwdWluZm8nXVsnZ3B1dnJlcyddID0gdlJlcwoJcmV0dXJuKGRldmljZURhdGFEaWN0KQoKZGVmIHppcEZpbGUoZmlsZVRvWmlwKToKCWltcG9ydCB6aXBmaWxlCglpbkZpbGUgCQk9IG9zLnBhdGguam9pbihmaWxlc0RpciwgZmlsZVRvWmlwKQoJb3V0WmlwRmlsZSAJPSBvcy5wYXRoLmpvaW4oZmlsZXNEaXIsIGYne2ZpbGVUb1ppcH0uemlwJykKCWxvZ2dlci5pbmZvKGYnWmlwcGluZyB7aW5GaWxlfSB0byB7b3V0WmlwRmlsZX0nKQoJdHJ5OgoJCXdpdGggemlwZmlsZS5aaXBGaWxlKG91dFppcEZpbGUsICd3JywgY29tcHJlc3Npb249emlwZmlsZS5aSVBfREVGTEFURUQpIGFzIHppcGY6CgkJCXppcGYud3JpdGUoaW5GaWxlLCBvcy5wYXRoLmJhc2VuYW1lKGluRmlsZSkpCgkJbG9nZ2VyLmluZm8oZidTdWNjZXNzZnVsbHkgemlwcGVkIHtpbkZpbGV9IHRvIHtvdXRaaXBGaWxlfScpCglleGNlcHQgRXhjZXB0aW9uIGFzIGU6CgkJbG9nZ2VyLmVycm9yKGYnRmFpbGVkIHRvIHppcCB7aW5GaWxlfSB0byB7b3V0WmlwRmlsZX0uIFJlYXNvbjoge2V9JykKCXJldHVybihvdXRaaXBGaWxlKQoKZGVmIHNlbmRQYXlsb2FkRmxhc2socm91dGUsIG91dFppcEZpbGUsIGRldmljZVV1aWQpOgoJcGF5bG9hZE5hbWUgCT0gb3MucGF0aC5iYXNlbmFtZShvdXRaaXBGaWxlKQoJdXJsIAkJCT0gZidodHRwczovL3tob3N0fXtyb3V0ZX0nCglsb2dnZXIuaW5mbyhmJ1JlcXVlc3QgdG8gc2VuZCB7b3V0WmlwRmlsZX0gfCBwYXlsb2FkTmFtZToge3BheWxvYWROYW1lfScpCglsb2dnZXIuaW5mbyhmJ0F0dGVtcHRpbmcgdG8gY29ubmVjdCB0byB7dXJsfScpCgl3aXRoIG9wZW4ob3V0WmlwRmlsZSwgJ3JiJykgYXMgZjoKCQlmaWxlcyA9IHsnZmlsZSc6IChwYXlsb2FkTmFtZSwgZil9CgkJaGVhZGVycyA9IHsnZGV2aWNldXVpZCc6IGRldmljZVV1aWR9CgkJcmVzcG9uc2UgPSByZXF1ZXN0cy5wb3N0KHVybCwgZmlsZXM9ZmlsZXMsIGhlYWRlcnM9aGVhZGVycykKCQlpZiByZXNwb25zZS5zdGF0dXNfY29kZSA9PSAyMDA6CgkJCWxvZ2dlci5pbmZvKGYnc3RhdHVzX2NvZGU6IHtyZXNwb25zZS5zdGF0dXNfY29kZX0nKQoJCQlyZXR1cm4oVHJ1ZSkKCQllbHNlOgoJCQlsb2dnZXIuZXJyb3IoZidzdGF0dXNfY29kZToge3Jlc3BvbnNlLnN0YXR1c19jb2RlfS4gUmVhc29uOiB7cmVzcG9uc2UudGV4dH0nKQoJCQlyZXR1cm4oRmFsc2UpCgpkZWYgZ2V0U21CaW9zSW5mbyhkZXZpY2VEYXRhRGljdCk6CgkiIiJHZXQgc3lzdGVtIGluZm9ybWF0aW9uIGZvciBtYWNPUyB1c2luZyBzeXN0ZW1fcHJvZmlsZXIiIiIKCXZlbmRvciA9ICdBcHBsZSBJbmMuJwoJc2VyaWFsTnVtYmVyID0gJ24vYScKCXZlcnNpb24gPSAnbi9hJwoKCXRyeToKCQljb21tYW5kID0gWydzeXN0ZW1fcHJvZmlsZXInLCAnU1BIYXJkd2FyZURhdGFUeXBlJ10KCQlyZXN1bHQgPSBzdWJwcm9jZXNzLnJ1bihjb21tYW5kLCBjYXB0dXJlX291dHB1dD1UcnVlLCB0ZXh0PVRydWUpCgkJZm9yIGxpbmUgaW4gcmVzdWx0LnN0ZG91dC5zcGxpdGxpbmVzKCk6CgkJCWlmICdTZXJpYWwgTnVtYmVyJyBpbiBsaW5lOgoJCQkJc2VyaWFsTnVtYmVyID0gbGluZS5zcGxpdCgnOiAnKVsxXS5zdHJpcCgpCgkJCWlmICdCb290IFJPTSBWZXJzaW9uJyBpbiBsaW5lOgoJCQkJdmVyc2lvbiA9IGxpbmUuc3BsaXQoJzogJylbMV0uc3RyaXAoKQoJZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgoJCWxvZ2dlci5lcnJvcihmJ0ZhaWxlZCB0byBnZXQgc3lzdGVtIGluZm86IHtlfScpCgoJbG9nZ2VyLmluZm8oZid2ZW5kb3I6IHt2ZW5kb3J9JykKCWxvZ2dlci5pbmZvKGYnc2VyaWFsTnVtYmVyOiB7c2VyaWFsTnVtYmVyfScpCglsb2dnZXIuaW5mbyhmJ3ZlcnNpb246IHt2ZXJzaW9ufScpCglkZXZpY2VEYXRhRGljdFsnYmlvcyddID0ge30KCWRldmljZURhdGFEaWN0WydiaW9zJ11bJ2Jpb3N2ZW5kb3InXSA9IHZlbmRvcgoJZGV2aWNlRGF0YURpY3RbJ2Jpb3MnXVsnc2VyaWFsbnVtYmVyJ10gPSBzZXJpYWxOdW1iZXIKCWRldmljZURhdGFEaWN0WydiaW9zJ11bJ2Jpb3N2ZXJzaW9uJ10gPSB2ZXJzaW9uCglyZXR1cm4oZGV2aWNlRGF0YURpY3QpCgpkZWYgZ2V0U3lzdGVtTW9kZWxGcm9tUHJvYygpOgoJc3lzdGVtTW9kZWwJPSAnbi9hJwoJY29tbWFuZAkJPSBbJ2NhdCcsICcvcHJvYy9jcHVpbmZvJ10KCXJlc3VsdCAJCT0gc3VicHJvY2Vzcy5Qb3Blbihjb21tYW5kLCBzdGRvdXQgPSBzdWJwcm9jZXNzLlBJUEUsIHVuaXZlcnNhbF9uZXdsaW5lcyA9IFRydWUpCglsb2dnZXIuZGVidWcoZidyZXN1bHQ6IHtyZXN1bHR9JykKCW91dHRleHQgCT0gcmVzdWx0LnN0ZG91dC5yZWFkKCkKCWxvZ2dlci5pbmZvKGYnb3V0dGV4dDoge291dHRleHR9JykKCWZvciBsaW5lIGluIG91dHRleHQuc3BsaXRsaW5lcygpOgoJCWlmICdNb2RlbCcgaW4gbGluZToKCQkJc3lzdGVtTW9kZWwgPSBsaW5lLnNwbGl0KCc6JylbMV0uc3RyaXAoKQoJbG9nZ2VyLmluZm8oZidzeXN0ZW1Nb2RlbDoge3N5c3RlbU1vZGVsfScpCQoJcmV0dXJuKHN5c3RlbU1vZGVsKQoKZGVmIGdldFN5c3RlbU1vZGVsKGRldmljZURhdGFEaWN0KToKCSIiIkdldCBzeXN0ZW0gbW9kZWwgZm9yIG1hY09TIiIiCglzeXN0ZW1Nb2RlbCA9ICduL2EnCgoJdHJ5OgoJCWNvbW1hbmQgPSBbJ3N5c3RlbV9wcm9maWxlcicsICdTUEhhcmR3YXJlRGF0YVR5cGUnXQoJCXJlc3VsdCA9IHN1YnByb2Nlc3MucnVuKGNvbW1hbmQsIGNhcHR1cmVfb3V0cHV0PVRydWUsIHRleHQ9VHJ1ZSkKCQlmb3IgbGluZSBpbiByZXN1bHQuc3Rkb3V0LnNwbGl0bGluZXMoKToKCQkJaWYgJ01vZGVsIE5hbWUnIGluIGxpbmU6CgkJCQlzeXN0ZW1Nb2RlbCA9IGxpbmUuc3BsaXQoJzogJylbMV0uc3RyaXAoKQoJCQkJYnJlYWsKCQkJZWxpZiAnTW9kZWwgSWRlbnRpZmllcicgaW4gbGluZToKCQkJCXN5c3RlbU1vZGVsID0gbGluZS5zcGxpdCgnOiAnKVsxXS5zdHJpcCgpCglleGNlcHQgRXhjZXB0aW9uIGFzIGU6CgkJbG9nZ2VyLmVycm9yKGYnRmFpbGVkIHRvIGdldCBzeXN0ZW0gbW9kZWw6IHtlfScpCgoJbG9nZ2VyLmluZm8oZidzeXN0ZW1Nb2RlbDoge3N5c3RlbU1vZGVsfScpCglkZXZpY2VEYXRhRGljdFsnc3lzdGVtJ11bJ3N5c3RlbW1vZGVsJ10gPSBzeXN0ZW1Nb2RlbAoJcmV0dXJuKGRldmljZURhdGFEaWN0KQoKZGVmIGdldFNlcnZpY2VzKCk6CgkiIiJHZXQgcnVubmluZyBzZXJ2aWNlcy9kYWVtb25zIGZvciBtYWNPUyB1c2luZyBsYXVuY2hjdGwiIiIKCWxvZ2dlci5pbmZvKCdBdHRlbXB0aW5nIHRvIGdldCBzZXJ2aWNlcy4uLicpCglzZXJ2aWNlc0RpY3QgPSB7fQoKCXRyeToKCQkjIEdldCBsaXN0IG9mIGxvYWRlZCBzZXJ2aWNlcwoJCWNvbW1hbmQgPSBbJ2xhdW5jaGN0bCcsICdsaXN0J10KCQlyZXN1bHQgPSBzdWJwcm9jZXNzLnJ1bihjb21tYW5kLCBjYXB0dXJlX291dHB1dD1UcnVlLCB0ZXh0PVRydWUpCgoJCWZvciBsaW5lIGluIHJlc3VsdC5zdGRvdXQuc3BsaXRsaW5lcygpOgoJCQlpZiBsaW5lLnN0YXJ0c3dpdGgoJ1BJRCcpIG9yIGxpbmUuc3RyaXAoKSA9PSAnJzoKCQkJCWNvbnRpbnVlCgkJCXBhcnRzID0gbGluZS5zcGxpdCgnXHQnKQoJCQlpZiBsZW4ocGFydHMpID49IDM6CgkJCQlwaWQgPSBwYXJ0c1swXS5zdHJpcCgpCgkJCQlzdGF0dXMgPSBwYXJ0c1sxXS5zdHJpcCgpCgkJCQlzZXJ2aWNlTmFtZSA9IHBhcnRzWzJdLnN0cmlwKCkKCgkJCQkjIERldGVybWluZSBmcmllbmRseSBzdGF0ZQoJCQkJaWYgcGlkID09ICctJzoKCQkJCQlmcmllbmRseVN0YXRlID0gJ1NUT1BQRUQnCgkJCQllbGlmIHBpZC5pc2RpZ2l0KCk6CgkJCQkJZnJpZW5kbHlTdGF0ZSA9ICdSVU5OSU5HJwoJCQkJZWxzZToKCQkJCQlmcmllbmRseVN0YXRlID0gJ09USEVSJwoKCQkJCXNlcnZpY2VzRGljdFtzZXJ2aWNlTmFtZV0gPSB7CgkJCQkJJ2Rpc3BsYXluYW1lJzogc2VydmljZU5hbWUsCgkJCQkJJ2N1cnJlbnRzdGF0ZSc6IDEgaWYgZnJpZW5kbHlTdGF0ZSA9PSAnU1RPUFBFRCcgZWxzZSA0LAoJCQkJCSdmcmllbmRseXN0YXRlJzogZnJpZW5kbHlTdGF0ZSwKCQkJCQkncGlkJzogcGlkIGlmIHBpZCAhPSAnLScgZWxzZSBOb25lCgkJCQl9CglleGNlcHQgRXhjZXB0aW9uIGFzIGU6CgkJbG9nZ2VyLmVycm9yKGYnRmFpbGVkIHRvIGdldCBzZXJ2aWNlczoge2V9JykKCglsb2dnZXIuaW5mbygnU3VjY2Vzc2Z1bGx5IGNvbGxlY3RlZCBzZXJ2aWNlcy4nKQoJc2VydmljZXNEaWN0RmlsZSA9IHdyaXRlU2VydmljZXNKc29uKHNlcnZpY2VzRGljdCkKCXJvdXRlID0gJy9wYXlsb2FkL3NlbmRmaWxlJwoJdXBsb2FkU3VjY2VzcyA9IHNlbmRQYXlsb2FkRmxhc2socm91dGUsIHNlcnZpY2VzRGljdEZpbGUsIGRldmljZVV1aWQpCglpZiB1cGxvYWRTdWNjZXNzOgoJCWRlbEZpbGUoc2VydmljZXNEaWN0RmlsZSkKCWVsc2U6CgkJbG9nZ2VyLmVycm9yKGYnVXBsb2FkIGZhaWxlZC4nKQoJcmV0dXJuKHNlcnZpY2VzRGljdCkKCmRlZiB3cml0ZVNlcnZpY2VzSnNvbihzZXJ2aWNlc0RpY3QpOgoJc2VydmljZXNEaWN0RmlsZSA9IGYne2ZpbGVzRGlyfXNlcnZpY2VzLmpzb24nCglsb2dnZXIuaW5mbyhmJ0F0dGVtcHRpbmcgdG8gd3JpdGUgc2VydmljZXMgdG8ge3NlcnZpY2VzRGljdEZpbGV9JykKCXRyeToKCQl3aXRoIG9wZW4oc2VydmljZXNEaWN0RmlsZSwgJ3cnKSBhcyBmOgoJCQlmLndyaXRlKGpzb24uZHVtcHMoc2VydmljZXNEaWN0LCBpbmRlbnQ9NCkpCglleGNlcHQgRXhjZXB0aW9uIGFzIGU6CgkJbG9nZ2VyLmVycm9yKGYnRmFpbGVkIHRvIHdyaXRlIHNlcnZpY2VzRGljdCB0byB7c2VydmljZXNEaWN0RmlsZX0uIFJlYXNvbjoge2V9JykKCXJldHVybihzZXJ2aWNlc0RpY3RGaWxlKQoKZGVmIGdldFByaW50ZXJzKGRldmljZURhdGFEaWN0KToKCSIiIkdldCBwcmludGVyIGluZm9ybWF0aW9uIGZvciBtYWNPUyIiIgoJcHJpbnRlckRpY3QgPSB7fQoJZGV2aWNlRGF0YURpY3RbJ3ByaW50ZXJzJ10gPSBbXQoKCXRyeToKCQkjIFVzZSBscHN0YXQgdG8gZ2V0IHByaW50ZXIgaW5mb3JtYXRpb24KCQljb21tYW5kID0gWydscHN0YXQnLCAnLXAnLCAnLWwnLCAnLXMnXQoJCXJlc3VsdCA9IHN1YnByb2Nlc3MucnVuKGNvbW1hbmQsIGNhcHR1cmVfb3V0cHV0PVRydWUsIHRleHQ9VHJ1ZSkKCgkJZm9yIGxpbmUgaW4gcmVzdWx0LnN0ZG91dC5zcGxpdGxpbmVzKCk6CgkJCWlmIGxpbmUuc3RyaXAoKS5zdGFydHN3aXRoKCdwcmludGVyJyk6CgkJCQlwcmludGVyTmFtZSA9IGxpbmUuc3BsaXQoJ3ByaW50ZXIgJylbMV0uc3BsaXQoJyAnKVswXS5zdHJpcCgpCgkJCQlpZiBwcmludGVyTmFtZSBub3QgaW4gcHJpbnRlckRpY3Q6CgkJCQkJcHJpbnRlckRpY3RbcHJpbnRlck5hbWVdID0ge30KCQkJZWxpZiBsaW5lLnN0cmlwKCkuc3RhcnRzd2l0aCgnc3lzdGVtIGRlZmF1bHQnKToKCQkJCWRlZmF1bHRQcmludGVyID0gbGluZS5zcGxpdCgnOicpWzFdLnN0cmlwKCkKCQkJCWlmIGRlZmF1bHRQcmludGVyIGluIHByaW50ZXJEaWN0OgoJCQkJCXByaW50ZXJEaWN0W2RlZmF1bHRQcmludGVyXVsnZGVmYXVsdCddID0gVHJ1ZQoJCQllbGlmIGxpbmUuc3RyaXAoKS5zdGFydHN3aXRoKCdkZXZpY2UnKToKCQkJCXByaW50ZXJOYW1lID0gbGluZS5zcGxpdCgnZGV2aWNlIGZvciAnKVsxXS5zcGxpdCgnOicpWzBdCgkJCQlwcmludGVyUG9ydCA9ICc6Jy5qb2luKGxpbmUuc3BsaXQoJzonKVsxOl0pLnN0cmlwKCkKCQkJCWlmIHByaW50ZXJOYW1lIGluIHByaW50ZXJEaWN0OgoJCQkJCXByaW50ZXJEaWN0W3ByaW50ZXJOYW1lXVsncG9ydG5hbWUnXSA9IHByaW50ZXJQb3J0CgoJCWRldmljZURhdGFEaWN0WydwcmludGVycyddID0gcHJpbnRlckRpY3QKCWV4Y2VwdCBFeGNlcHRpb24gYXMgZToKCQlsb2dnZXIuZXJyb3IoZidGYWlsZWQgdG8gZ2V0IHByaW50ZXIgaW5mbzoge2V9JykKCQlkZXZpY2VEYXRhRGljdFsncHJpbnRlcnMnXSA9IHt9CgoJcmV0dXJuKGRldmljZURhdGFEaWN0KQoKZGVmIGdldFBjaURldmljZXMoZGV2aWNlRGF0YURpY3QpOgoJIiIiR2V0IFBDSSBkZXZpY2UgaW5mb3JtYXRpb24gZm9yIG1hY09TIHVzaW5nIHN5c3RlbV9wcm9maWxlciIiIgoJcGNpRGV2aWNlRGljdCA9IHt9CgoJdHJ5OgoJCWNvbW1hbmQgPSBbJ3N5c3RlbV9wcm9maWxlcicsICdTUFBDSURhdGFUeXBlJ10KCQlyZXN1bHQgPSBzdWJwcm9jZXNzLnJ1bihjb21tYW5kLCBjYXB0dXJlX291dHB1dD1UcnVlLCB0ZXh0PVRydWUpCgoJCWN1cnJlbnRfZGV2aWNlID0gTm9uZQoJCWZvciBsaW5lIGluIHJlc3VsdC5zdGRvdXQuc3BsaXRsaW5lcygpOgoJCQlsaW5lID0gbGluZS5zdHJpcCgpCgkJCWlmICc6JyBpbiBsaW5lIGFuZCBub3QgbGluZS5zdGFydHN3aXRoKCcgJyk6CgkJCQkjIFRoaXMgaXMgYSBkZXZpY2UgbmFtZQoJCQkJY3VycmVudF9kZXZpY2UgPSBsaW5lLnJzdHJpcCgnOicpCgkJCQlwY2lEZXZpY2VEaWN0W2N1cnJlbnRfZGV2aWNlXSA9IHt9CgkJCWVsaWYgY3VycmVudF9kZXZpY2UgYW5kICdUeXBlOicgaW4gbGluZToKCQkJCWRldmljZV90eXBlID0gbGluZS5zcGxpdCgnVHlwZTonKVsxXS5zdHJpcCgpCgkJCQlwY2lEZXZpY2VEaWN0W2N1cnJlbnRfZGV2aWNlXVsncG5wY2xhc3MnXSA9IGRldmljZV90eXBlCgoJCWRldmljZURhdGFEaWN0WydwY2lkZXZpY2VzJ10gPSBwY2lEZXZpY2VEaWN0CglleGNlcHQgRXhjZXB0aW9uIGFzIGU6CgkJbG9nZ2VyLmVycm9yKGYnRmFpbGVkIHRvIGdldCBQQ0kgZGV2aWNlczoge2V9JykKCQlkZXZpY2VEYXRhRGljdFsncGNpZGV2aWNlcyddID0ge30KCglyZXR1cm4oZGV2aWNlRGF0YURpY3QpCgpkZWYgZ2V0VXNiRGV2aWNlcyhkZXZpY2VEYXRhRGljdCk6CgkiIiJHZXQgVVNCIGRldmljZSBpbmZvcm1hdGlvbiBmb3IgbWFjT1MgdXNpbmcgc3lzdGVtX3Byb2ZpbGVyIiIiCgl1c2JEZXZpY2VMaXN0ID0gW10KCgl0cnk6CgkJY29tbWFuZCA9IFsnc3lzdGVtX3Byb2ZpbGVyJywgJ1NQVVNCRGF0YVR5cGUnXQoJCXJlc3VsdCA9IHN1YnByb2Nlc3MucnVuKGNvbW1hbmQsIGNhcHR1cmVfb3V0cHV0PVRydWUsIHRleHQ9VHJ1ZSkKCgkJZm9yIGxpbmUgaW4gcmVzdWx0LnN0ZG91dC5zcGxpdGxpbmVzKCk6CgkJCWxpbmUgPSBsaW5lLnN0cmlwKCkKCQkJaWYgJzonIGluIGxpbmUgYW5kIG5vdCBsaW5lLnN0YXJ0c3dpdGgoJyAnKToKCQkJCSMgVGhpcyBpcyBhIGRldmljZSBuYW1lCgkJCQlkZXZpY2VfbmFtZSA9IGxpbmUucnN0cmlwKCc6JykKCQkJCWlmIGRldmljZV9uYW1lIG5vdCBpbiB1c2JEZXZpY2VMaXN0IGFuZCBkZXZpY2VfbmFtZSAhPSAnVVNCJzoKCQkJCQl1c2JEZXZpY2VMaXN0LmFwcGVuZChkZXZpY2VfbmFtZSkKCgkJZGV2aWNlRGF0YURpY3RbJ3VzYmRldmljZXMnXSA9IHVzYkRldmljZUxpc3QKCWV4Y2VwdCBFeGNlcHRpb24gYXMgZToKCQlsb2dnZXIuZXJyb3IoZidGYWlsZWQgdG8gZ2V0IFVTQiBkZXZpY2VzOiB7ZX0nKQoJCWRldmljZURhdGFEaWN0Wyd1c2JkZXZpY2VzJ10gPSBbXQoKCXJldHVybihkZXZpY2VEYXRhRGljdCkKCiMgV2luZG93cyBFdmVudCBMb2cgZnVuY3Rpb25zIHJlbW92ZWQgLSBub3QgYXBwbGljYWJsZSBmb3IgbWFjT1MKCiMgZGVmIGdldFNlcnZlckNvbGxWZXJzaW9uKGFwcFZlcnNpb24pOgojIAlsb2dnZXIuaW5mbyhmJ0NoZWNraW5nIGNvbGxlY3RvciB2ZXJzaW9uJykKIyAJbG9nZ2VyLmluZm8oZidsb2NhbCBjb2xsZWN0b3JWZXJzaW9uOiB7YXBwVmVyc2lvbn0nKQojIAlyIAkJPSByZXF1ZXN0cy5nZXQoZidodHRwczovL3tob3N0fS9kaWFncy9jb2xsZWN0b3JWZXJzaW9uJykKIyAJZGF0YSAJPSByLmpzb24oKQojIAlzZXJ2ZXJDb2xsZWN0b3JWZXJzaW9uID0gZGF0YVsnc2VydmVyQ29sbGVjdG9yVmVyc2lvbiddCiMgCWNvbGxIYXNoUHkgCT0gZGF0YVsnc2VydmVySGFzaFB5J10KIyAJY29sbEhhc2hXaW4JPSBkYXRhWydzZXJ2ZXJIYXNoV2luJ10KIyAJbG9nZ2VyLmluZm8oZidzZXJ2ZXIgY29sbGVjdG9yVmVyc2lvbjoge3NlcnZlckNvbGxlY3RvclZlcnNpb259JykKIyAJaWYgaW50KGFwcFZlcnNpb24pIDwgaW50KHNlcnZlckNvbGxlY3RvclZlcnNpb24pOgojIAkJbG9nZ2VyLmluZm8oJ0xvY2FsIGNvbGxlY3RvciBuZWVkcyB1cGRhdGluZy4uLicpCiMgCQljb2xsZWN0b3JVcGRhdGVSZXFkID0gVHJ1ZQojIAllbHNlOgojIAkJbG9nZ2VyLmluZm8oJ0xvY2FsIGNvbGxlY3RvciBpcyB1cCB0byBkYXRlLicpCiMgCQljb2xsZWN0b3JVcGRhdGVSZXFkID0gRmFsc2UKIyAJcmV0dXJuKGNvbGxlY3RvclVwZGF0ZVJlcWQsIGNvbGxIYXNoUHksIGNvbGxIYXNoV2luKQoKZGVmIGdldFNoYTI1Nkhhc2goZmlsZVRvSGFzaCk6CglzaGEyNTZIYXNoID0gaGFzaGxpYi5zaGEyNTYoKQoJd2l0aCBvcGVuKGZpbGVUb0hhc2gsICdyYicpIGFzIGY6CgkJZm9yIGJ5dGVCbG9jayBpbiBpdGVyKGxhbWJkYTogZi5yZWFkKDQwOTYpLCBiIiIpOgoJCQlzaGEyNTZIYXNoLnVwZGF0ZShieXRlQmxvY2spCglsb2dnZXIuaW5mbyhmJ3NoYTI1NiBvZiB7ZmlsZVRvSGFzaH06IHtzaGEyNTZIYXNoLmhleGRpZ2VzdCgpfScpCglyZXR1cm4oc2hhMjU2SGFzaC5oZXhkaWdlc3QoKSkKCiMgZGVmIHVwZGF0ZUNvbGxlY3Rvcihjb2xsSGFzaFB5LCBjb2xsSGFzaFdpbik6CiMgCWlmIHBsYXRmb3JtLnN5c3RlbSgpID09ICdMaW51eCc6CiMgCQljb2xsZWN0b3JVcmwgPSBmJ2h0dHBzOi8ve2hvc3R9L2Rvd25sb2FkL2NvbGxlY3Rvci5weScKIyAJCWNodW5rU2l6ZSA9IDQwOTYKIyAJCXNhdmVUb0ZpbGUgPSBmJ3tzeXMuYXJndlswXX0ubmV3JwojIAkJbG9nZ2VyLmluZm8oZidBdHRlbXB0aW5nIHRvIGRvd25sb2FkIHtjb2xsZWN0b3JVcmx9IHRvIHtzYXZlVG9GaWxlfS4uLicpCiMgCQl0cnk6CiMgCQkJciA9IHJlcXVlc3RzLmdldChjb2xsZWN0b3JVcmwsIHN0cmVhbT1UcnVlKQojIAkJCWlmIHIuc3RhdHVzX2NvZGUgIT0gMjAwOgojIAkJCQlsb2dnZXIuZXJyb3IoZidGYWlsZWQgdG8gZG93bmxvYWQge2NvbGxlY3RvclVybH0uIFN0YXR1cyBDb2RlOiB7ci5zdGF0dXNfY29kZX0nKQojIAkJCQlyZXR1cm4oRmFsc2UpCiMgCQkJd2l0aCBvcGVuKHNhdmVUb0ZpbGUsICd3YicpIGFzIGY6CiMgCQkJCWZvciBjaHVuayBpbiByLml0ZXJfY29udGVudChjaHVua19zaXplPWNodW5rU2l6ZSk6CiMgCQkJCQlpZiBjaHVuazoKIyAJCQkJCQlmLndyaXRlKGNodW5rKQojIAkJZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgojIAkJCWxvZ2dlci5lcnJvcihmJ0ZhaWxlZCB0byBkb3dubG9hZCB7Y29sbGVjdG9yVXJsfSB0byB7c2F2ZVRvRmlsZX0uIFJlYXNvbjoge2V9JykKIyAJCW5ld0NvbGxIYXNoID0gZ2V0U2hhMjU2SGFzaChzYXZlVG9GaWxlKQojIAkJbG9nZ2VyLmluZm8oZidEb3dubG9hZGVkIEhhc2g6IHtuZXdDb2xsSGFzaH0gfCBTZXJ2ZXIgSGFzaDoge2NvbGxIYXNoUHl9JykKIyAJCWlmIG5ld0NvbGxIYXNoID09IGNvbGxIYXNoUHk6CiMgCQkJbG9nZ2VyLmluZm8oZidBdHRlbXB0aW5nIHRvIHJlbmFtZSB7c2F2ZVRvRmlsZX0gdG8ge3N5cy5hcmd2WzBdfScpCiMgCQkJdHJ5OgojIAkJCQlvcy5yZW5hbWUoc2F2ZVRvRmlsZSwgc3lzLmFyZ3ZbMF0pCiMgCQkJCWxvZ2dlci5pbmZvKGYnU3VjY2Vzc2Z1bGx5IHVwZ3JhZGVkIHtjb2xsZWN0b3JVcmx9IHRvIHtzYXZlVG9GaWxlfScpCiMgCQkJCWxvZ2dlci5pbmZvKCdOZXcgY29sbGVjdG9yIHdpbGwgcnVuIG9uIG5leHQgY3ljbGUnKQojIAkJCWV4Y2VwdCBFeGNlcHRpb24gYXMgZToKIyAJCQkJbG9nZ2VyLmVycm9yKGYnRmFpbGVkIHRvIHJlbmFtZSB7c2F2ZVRvRmlsZX0gdG8ge3N5cy5hcmd2WzBdfS4gUmVhc29uOiB7ZX0nKQojIAkJZWxzZToKIyAJCQlsb2dnZXIuZXJyb3IoJ0hhc2hlcyBkbyBub3QgbWF0Y2guIERlbGV0aW5nIGRvd25sb2FkLicpCiMgCQkJdHJ5OgojIAkJCQlvcy5yZW1vdmUoc2F2ZVRvRmlsZSkKIyAJCQlleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiMgCQkJCWxvZ2dlci5lcnJvcihmJ0ZhaWxlZCB0byBkZWxldGUge3NhdmVUb0ZpbGV9LiBSZWFzb246IHtlfScpCgkJCiMgCWVsaWYgcGxhdGZvcm0uc3lzdGVtKCkgPT0gJ1dpbmRvd3MnOgojIAkJY29tbWFuZCA9IGYnKE5ldy1PYmplY3QgU3lzdGVtLk5ldC5XZWJDbGllbnQpLkRvd25sb2FkRmlsZSgiaHR0cHM6Ly9hcHAud2Vnd2Vpc2VyLnRlY2gvZG93bmxvYWQvd2Vnd2Vpc2VyLmV4ZSIsIiRlbnY6VEVNUC93ZWd3ZWlzZXIuZXhlIik7IFwKIyBTdGFydC1Qcm9jZXNzIC1GaWxlUGF0aCAiJGVudjpURU1QL3dlZ3dlaXNlci5leGUiIC1Bcmd1bWVudExpc3QgIi9ncm91cHV1aWQ9e2dyb3VwVXVpZH0iLCAiL0xPRz0kZW52OlRFTVAvV2Vnd2Vpc2VyU2V0dXAubG9nIiwgIi9TSUxFTlQiJwojIAkJbG9nZ2VyLmluZm8oZidBdHRlbXB0aW5nIHRvIHJ1bjoge2NvbW1hbmR9JykKIyAJCXJlc3VsdCA9IHN1YnByb2Nlc3MucnVuKFsicG93ZXJzaGVsbCIsICItQ29tbWFuZCIsIGNvbW1hbmRdLCBzdGRvdXQgPSBzdWJwcm9jZXNzLlBJUEUsIHVuaXZlcnNhbF9uZXdsaW5lcyA9IFRydWUpCiMgCQlsb2dnZXIuaW5mbyhmJ3Jlc3VsdDoge3Jlc3VsdC5zdGRvdXR9JykKCmRlZiBwYXJzZVRpbWUodGltZVN0cik6CiAgICByZXR1cm4gKGRhdGV0aW1lLmRhdGV0aW1lLnN0cnB0aW1lKHRpbWVTdHIsICIlWS0lbS0lZC0lSDolTTolUyIpKQoKZGVmIHBhcnNlVGltZTIodGltZVN0cik6CiAgICByZXR1cm4gKGRhdGV0aW1lLmRhdGV0aW1lLnN0cnB0aW1lKHRpbWVTdHIsICIlWS0lbS0lZCAlSDolTTolUyIpKQoKZGVmIHJlYWRFdmVudEpzb24oanNvbkZpbGUpOgogICAgd2l0aCBvcGVuKGpzb25GaWxlLCAncicpIGFzIGY6CiAgICAgICAgZXZlbnRzRGljdCA9IGpzb24ubG9hZChmKQogICAgcmV0dXJuKGV2ZW50c0RpY3QpCgojIFdpbmRvd3MvTGludXggbG9nIGZpbHRlcmluZyBmdW5jdGlvbnMgcmVtb3ZlZCAtIG5vdCBhcHBsaWNhYmxlIGZvciBtYWNPUwoKZGVmIHNlbmRFdmVudE1ldGFkYXRhKGRldmljZVV1aWQpOgoJdXJsID0gZidodHRwczovL3tob3N0fS9haS9kZXZpY2UvbWV0YWRhdGEnCglsb2dOYW1lcyA9IFsnQXBwbGljYXRpb24nLCAnU3lzdGVtJywgJ1NlY3VyaXR5J10KCWZvciBsb2dOYW1lIGluIGxvZ05hbWVzOgoJCXdpdGggb3Blbihvcy5wYXRoLmpvaW4oZmlsZXNEaXIsICdldmVudHNGaWx0ZXJlZC0nICsgbG9nTmFtZSArJy5qc29uJyksICdyJykgYXMgZjoKCQkJZGF0YSA9IGpzb24ubG9hZChmKQoJCWJvZHkgPSB7CgkJCSdkZXZpY2V1dWlkJzpkZXZpY2VVdWlkLAoJCQknbWV0YWxvZ29zX3R5cGUnOmYnZXZlbnRzRmlsdGVyZWQte2xvZ05hbWV9JywKCQkJJ21ldGFsb2dvcyc6ZGF0YQoJCQl9CgkJCgkJaGVhZGVycyAJPSB7J0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ30KCQlsb2dnZXIuaW5mbyhmJ0F0dGVtcHRpbmcgdG8gUE9TVCB0bzoge3VybH0nKQoJCXJlc3BvbnNlIAk9IHJlcXVlc3RzLnBvc3QodXJsLCBoZWFkZXJzPWhlYWRlcnMsIGRhdGE9anNvbi5kdW1wcyhib2R5KSkKCQlsb2dnZXIuaW5mbyhmJ3Jlc3BvbnNlOiB7cmVzcG9uc2Uuc3RhdHVzX2NvZGV9JykKCQlpZiByZXNwb25zZS5zdGF0dXNfY29kZSAhPSAyMDE6CgkJCWxvZ2dlci5lcnJvcihmJ0ZhaWxlZCB0byBQT1NUIGRhdGEuIFJlYXNvbjoge3Jlc3BvbnNlLnRleHR9JykKCmRlZiBzZW5kTGludXhMb2dNZXRhZGF0YShkZXZpY2VVdWlkLCBsb2dUb1NlbmQpOgoJdXJsID0gZidodHRwczovL3tob3N0fS9haS9kZXZpY2UvbWV0YWRhdGEnCgl3aXRoIG9wZW4ob3MucGF0aC5qb2luKGZpbGVzRGlyLCBmJ3tsb2dUb1NlbmR9RmlsdGVyZWQuanNvbicpLCAncicpIGFzIGY6CgkJZGF0YSA9IGpzb24ubG9hZChmKQoJYm9keSA9IHsKCQknZGV2aWNldXVpZCc6ZGV2aWNlVXVpZCwKCQknbWV0YWxvZ29zX3R5cGUnOmYne2xvZ1RvU2VuZH1GaWx0ZXJlZCcsCgkJJ21ldGFsb2dvcyc6ZGF0YQoJCX0KCWhlYWRlcnMgCT0geydDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbid9Cglsb2dnZXIuaW5mbyhmJ0F0dGVtcHRpbmcgdG8gUE9TVCB0bzoge3VybH0gZm9yIHtsb2dUb1NlbmR9JykKCXJlc3BvbnNlIAk9IHJlcXVlc3RzLnBvc3QodXJsLCBoZWFkZXJzPWhlYWRlcnMsIGRhdGE9anNvbi5kdW1wcyhib2R5KSkKCWxvZ2dlci5pbmZvKGYncmVzcG9uc2U6IHtyZXNwb25zZS5zdGF0dXNfY29kZX0nKQoJaWYgcmVzcG9uc2Uuc3RhdHVzX2NvZGUgIT0gMjAxOgoJCWxvZ2dlci5lcnJvcihmJ0ZhaWxlZCB0byBQT1NUIGRhdGEuIFJlYXNvbjoge3Jlc3BvbnNlLnRleHR9JykKCmRlZiBnZXREYXRlRm9ybWF0KGRhdGVTdHJpbmcpOgoJaWYgKCctJyBpbiBkYXRlU3RyaW5nKSBhbmQgKCcrJyBpbiBkYXRlU3RyaW5nKToKCQlldmVudFRpbWUgPSBkYXRldGltZS5kYXRldGltZS5mcm9taXNvZm9ybWF0KGRhdGVTdHJpbmcpCgllbHNlOgoJCWV2ZW50VGltZSA9IGRhdGV0aW1lLmRhdGV0aW1lLnN0cnB0aW1lKGRhdGVTdHJpbmcsICIlYiAlZCAlSDolTTolUyIpCgkJZXZlbnRUaW1lID0gZXZlbnRUaW1lLnJlcGxhY2UoeWVhcj1kYXRldGltZS5kYXRldGltZS5ub3coKS55ZWFyKQoJcmV0dXJuKGV2ZW50VGltZSkJCQoJCiMgZGVmIGNoZWNrQXJncyhhcmdzKToKIyAJaWYgYXJncy52ZXJzaW9uOgojIAkJcHJpbnQoZid7YXBwTmFtZX0gVmVyc2lvbjoge2FwcFZlcnNpb259JykKIyAJCXN5cy5leGl0KCkKIyAJaWYgYXJncy5ncm91cFV1aWQ6CiMgCQlncm91cFV1aWQgCQk9IGFyZ3MuZ3JvdXBVdWlkCiMgCWVsc2U6CiMgCQlncm91cFV1aWQJCT0gTm9uZQojIAlpZiBhcmdzLm1vZGU6CiMgCQltb2RlID0gYXJncy5tb2RlCiMgCWVsc2U6CiMgCQltb2RlID0gJ0FVRElUJwojIAlyZXR1cm4oZ3JvdXBVdWlkLCBtb2RlKQoKIyBMaW51eCBsb2cgcHJvY2Vzc2luZyByZW1vdmVkIC0gbm90IGFwcGxpY2FibGUgZm9yIG1hY09TCgpkZWYgZ2V0T3NMYW5nKGRldmljZURhdGFEaWN0KToKCSIiIkdldCBzeXN0ZW0gbG9jYWxlIGZvciBtYWNPUyIiIgoJc3lzdGVtTG9jYWxlID0gJ05vdCBkZXRlY3RlZCcKCgl0cnk6CgkJIyBHZXQgc3lzdGVtIGxvY2FsZSB1c2luZyBkZWZhdWx0cyBjb21tYW5kCgkJY29tbWFuZCA9IFsnZGVmYXVsdHMnLCAncmVhZCcsICctZycsICdBcHBsZUxvY2FsZSddCgkJcmVzdWx0ID0gc3VicHJvY2Vzcy5ydW4oY29tbWFuZCwgY2FwdHVyZV9vdXRwdXQ9VHJ1ZSwgdGV4dD1UcnVlKQoJCWlmIHJlc3VsdC5yZXR1cm5jb2RlID09IDA6CgkJCXN5c3RlbUxvY2FsZSA9IHJlc3VsdC5zdGRvdXQuc3RyaXAoKQoJCWVsc2U6CgkJCSMgRmFsbGJhY2sgdG8gZW52aXJvbm1lbnQgdmFyaWFibGUKCQkJc3lzdGVtTG9jYWxlID0gb3MuZ2V0ZW52KCdMQU5HJywgJ05vdCBkZXRlY3RlZCcpCglleGNlcHQgRXhjZXB0aW9uIGFzIGU6CgkJbG9nZ2VyLmVycm9yKGYnRmFpbGVkIHRvIGdldCBzeXN0ZW0gbG9jYWxlOiB7ZX0nKQoJCXN5c3RlbUxvY2FsZSA9IG9zLmdldGVudignTEFORycsICdOb3QgZGV0ZWN0ZWQnKQoKCWxvZ2dlci5kZWJ1ZyhmJ3N5c3RlbUxvY2FsZToge3N5c3RlbUxvY2FsZX0nKQoJZGV2aWNlRGF0YURpY3RbJ3N5c3RlbSddWydzeXN0ZW1sb2NhbGUnXSA9IHN5c3RlbUxvY2FsZQoJcmV0dXJuKGRldmljZURhdGFEaWN0KQoKZGVmIGdldE1hbnVmYWN0dXJlcihkZXZpY2VEYXRhRGljdCk6CiAgICAiIiJHZXQgc3lzdGVtIG1hbnVmYWN0dXJlciBmb3IgbWFjT1MiIiIKICAgIHN5c3RlbU1hbnVmYWN0dXJlciA9ICdBcHBsZSBJbmMuJyAgIyBtYWNPUyBkZXZpY2VzIGFyZSBhbHdheXMgQXBwbGUKCiAgICBsb2dnZXIuZGVidWcoZidzeXN0ZW1NYW51ZmFjdHVyZXI6IHtzeXN0ZW1NYW51ZmFjdHVyZXJ9JykKICAgIGRldmljZURhdGFEaWN0WydzeXN0ZW0nXVsnc3lzdGVtbWFudWZhY3R1cmVyJ10gPSBzeXN0ZW1NYW51ZmFjdHVyZXIKICAgIHJldHVybihkZXZpY2VEYXRhRGljdCkKCiMgV2luZG93cy1zcGVjaWZpYyBmdW5jdGlvbnMgcmVtb3ZlZCAtIG5vdCBhcHBsaWNhYmxlIGZvciBtYWNPUwoKZGVmIGdldEZpbGVWZXJzaW9uKHBhdGgsIEdldEZpbGVWZXJzaW9uSW5mbywgTE9XT1JELCBISVdPUkQpOgoJdHJ5OgoJCWluZm8gPSBHZXRGaWxlVmVyc2lvbkluZm8gKHBhdGgsICJcXCIpCgkJbXMgPSBpbmZvWydGaWxlVmVyc2lvbk1TJ10KCQlscyA9IGluZm9bJ0ZpbGVWZXJzaW9uTFMnXQoJZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgoJCWxvZ2dlci5lcnJvcihmJ1ZlcnNpb24gRGF0YSBub3QgZm91bmQuIFJlYXNvbjoge2V9JykKCXRyeToKCQlpbnN0YWxsZWRWZXJzaW9uID0gc3RyKEhJV09SRCAobXMpKSArICcuJyArIFwKCQkJCQkJc3RyKExPV09SRCAobXMpKSArICcuJyArIFwKCQkJCQkJc3RyKEhJV09SRCAobHMpKSArICcuJyArIFwKCQkJCQkJc3RyKExPV09SRCAobHMpKQoJCXJldHVybihpbnN0YWxsZWRWZXJzaW9uKQoJZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgoJCWxvZ2dlci5lcnJvcihmJ2Vycm9yOiB7ZX0nKQoJCXJldHVybignMC4wLjAuMCcpCgpkZWYgZ2V0RmlsZU1vZGlmaWVkRGF0ZShwYXRoKToKCW1vZERhdGUgPSBpbnQob3MucGF0aC5nZXRtdGltZShwYXRoKSkKCXJldHVybihtb2REYXRlKQoKIyBnZXREcml2ZXJzKCkgZnVuY3Rpb24gcmVtb3ZlZCAtIG5vdCBhcHBsaWNhYmxlIGZvciBtYWNPUwoKZGVmIHNlbmRNZXRhTWV0YWRhdGEoZGV2aWNlVXVpZCwgZGF0YSwgbWV0YU5hbWUpOgoJdXJsID0gZidodHRwczovL3tob3N0fS9tZXRhZGF0YScKCWJvZHkgPSB7CgkJJ2RldmljZXV1aWQnOmRldmljZVV1aWQsCgkJJ21ldGFsb2dvc190eXBlJzogbWV0YU5hbWUsCgkJJ21ldGFsb2dvcyc6ZGF0YQoJCX0KCQoJaGVhZGVycyAJPSB7J0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ30KCWxvZ2dlci5pbmZvKGYnQXR0ZW1wdGluZyB0byBQT1NUIHRvOiB7dXJsfScpCglyZXNwb25zZSAJPSByZXF1ZXN0cy5wb3N0KHVybCwgaGVhZGVycz1oZWFkZXJzLCBkYXRhPWpzb24uZHVtcHMoYm9keSkpCglsb2dnZXIuaW5mbyhmJ3Jlc3BvbnNlOiB7cmVzcG9uc2Uuc3RhdHVzX2NvZGV9JykKCWlmIHJlc3BvbnNlLnN0YXR1c19jb2RlICE9IDIwMToKCQlsb2dnZXIuZXJyb3IoZidGYWlsZWQgdG8gUE9TVCBkYXRhLiBSZWFzb246IHtyZXNwb25zZS50ZXh0fScpCgojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIE1BSU4gIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKZGVidWdNb2RlIAkJCT0gVHJ1ZQpob3N0IAkJCQk9ICdhcHAud2Vnd2Vpc2VyLnRlY2gnCnBvcnQgCQkJCT0gNDQzCiNhcmdzCQkJCT0gcGFyc2VBcmdzKCkKCmlmIGRlYnVnTW9kZSA9PSBUcnVlOgoJbG9nZ2VyLmluZm8oJ2Z1bGxBdWRpdCBTdGFydGluZy4uLicpCgphcHBEaXIsIFwKCWxvZ0RpciwgXAoJY29uZmlnRGlyLCBcCgl0ZW1wRGlyLCBcCglmaWxlc0RpcgkJPSBnZXRBcHBEaXJzKCkKI2xvZ0ZpbGUgCQkJPSBmJ3tsb2dEaXJ9LmxvZycKI2xvZ2ZpbGUobG9nRmlsZSkKI2xvZ2dlci5kZWJ1ZyhmJ2xvZ0ZpbGU6IHtsb2dGaWxlfScpCmFnZW50Q29uZmlnRmlsZSAJPSBmJ3tjb25maWdEaXJ9YWdlbnQuY29uZmlnJwpkZXZpY2VVdWlkLCBcCglob3N0CQk9IGdldERldmljZVV1aWQoYWdlbnRDb25maWdGaWxlKQptc2luZm9PdXRwdXQgCQk9IGYne2ZpbGVzRGlyfW1zaW5mby50eHQnCgoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyBNQUNPUyBBVURJVCAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgpkZXZpY2VEYXRhRGljdCA9IHt9CmRldmljZURhdGFEaWN0ID0gZ2V0RGV2aWNlRGF0YShkZXZpY2VEYXRhRGljdCkKZGV2aWNlRGF0YURpY3QgPSBnZXRTeXN0ZW1EYXRhKGRldmljZURhdGFEaWN0KQpkZXZpY2VEYXRhRGljdCA9IGdldERpc2tTdGF0cyhkZXZpY2VEYXRhRGljdCkKZGV2aWNlRGF0YURpY3QgPSBnZXROZXR3b3JrRGF0YShkZXZpY2VEYXRhRGljdCkKZGV2aWNlRGF0YURpY3QgPSBnZXRVc2VyRGF0YShkZXZpY2VEYXRhRGljdCkKZGV2aWNlRGF0YURpY3QgPSBnZXRVcHRpbWVEYXRhKGRldmljZURhdGFEaWN0KQpkZXZpY2VEYXRhRGljdCA9IGdldEJhdHRlcnlEYXRhKGRldmljZURhdGFEaWN0KQpkZXZpY2VEYXRhRGljdCA9IGdldG1lbW9yeURhdGEoZGV2aWNlRGF0YURpY3QpCmRldmljZURhdGFEaWN0ID0gZ2V0Q29sbGVjdG9yRGF0YShkZXZpY2VEYXRhRGljdCkKZGV2aWNlRGF0YURpY3QgPSBnZXRNYW51ZmFjdHVyZXIoZGV2aWNlRGF0YURpY3QpCmRldmljZURhdGFEaWN0ID0gZ2V0T3NMYW5nKGRldmljZURhdGFEaWN0KQpkZXZpY2VEYXRhRGljdCA9IGdldENwdUluZm8oZGV2aWNlRGF0YURpY3QpCmRldmljZURhdGFEaWN0ID0gZ2V0R3B1SW5mbyhkZXZpY2VEYXRhRGljdCkKZGV2aWNlRGF0YURpY3QgPSBnZXRTbUJpb3NJbmZvKGRldmljZURhdGFEaWN0KQpkZXZpY2VEYXRhRGljdCA9IGdldFN5c3RlbU1vZGVsKGRldmljZURhdGFEaWN0KQpkZXZpY2VEYXRhRGljdCA9IGdldFByaW50ZXJzKGRldmljZURhdGFEaWN0KQpkZXZpY2VEYXRhRGljdCA9IGdldFBjaURldmljZXMoZGV2aWNlRGF0YURpY3QpCmRldmljZURhdGFEaWN0ID0gZ2V0VXNiRGV2aWNlcyhkZXZpY2VEYXRhRGljdCkKZGV2aWNlRGF0YURpY3QgPSBnZXRQYXJ0aXRpb25EYXRhKGRldmljZURhdGFEaWN0KQojIGdldERyaXZlcnMoKSByZW1vdmVkIC0gbm90IGFwcGxpY2FibGUgZm9yIG1hY09TCnNlcnZpY2VzRGljdCA9IGdldFNlcnZpY2VzKCkKCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMgU0VORCBSRVNVTFRTICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCnJvdXRlID0gJy9wYXlsb2FkL3NlbmRhdWRpdCcKcGF5bG9hZCA9IHsKCSJkYXRhIjogZGV2aWNlRGF0YURpY3QKfQoKaWYgZGVidWdNb2RlID09IFRydWU6CglwcmludChmJ3BheWxvYWQgZHVtcHM6IHtqc29uLmR1bXBzKHBheWxvYWQsIGluZGVudD00KX0nKQoJd2l0aCBvcGVuKGYne2xvZ0Rpcn1mdWxsQXVkaXQubG9nJywgJ2EnKSBhcyBmOgoJCWYud3JpdGUoanNvbi5kdW1wcyhkZXZpY2VEYXRhRGljdCwgaW5kZW50PTQpKQpyZXNwb25zZSAJPSBzZW5kSnNvblBheWxvYWRGbGFzayhwYXlsb2FkLCByb3V0ZSkKbG9nZ2VyLmluZm8oZidTZXJ2ZXIgcmVzcG9uc2U6IHtyZXNwb25zZX0gfCB7cmVzcG9uc2UudGV4dH0nKQoKCgoKCgoKCgoKCg=="}, "resigned_at": 1761308234}