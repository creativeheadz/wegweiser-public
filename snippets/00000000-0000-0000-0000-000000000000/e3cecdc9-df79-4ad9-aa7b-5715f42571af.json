{"settings": {"snippetUuid": "e3cecdc9-df79-4ad9-aa7b-5715f42571af", "snippetname": "MacOSMeta", "snippettype": ".py", "created_at": 1750450364}, "payload": {"payloadsig": "aS8b7VZ++B914RSuRZ0hRnAbV/9qODBfCo4SBVeDsPrBR5XJDYlD6IYc8B8/tmTrY+PZ5RBKo5tLDfWSjjujNGPsVtmm6ygVkJz7XFSVN93VfiR3k4xbofhPV3zJtd3la2BM8mg9md+fZBPlH0TVAFp/+6mZPXv/REa2d1IlPY6EaM0WGFVcc+p2FPlCXsA1MoJ6c0fsst2ycSsrI7NJ/ZhaRANti/XF9/JKTZDFOU2kms6aWn16SnRsOlenrIy62Zcr22yIgELMRw1DgNNADGnGouWU5TlfzlnMEKxF6kxJohbUMhiLKP1Bi9f6k6VEy3p7aBwBQFjKXMSa3pfxC9cqmi4HSjMUC12MYYbEyac1VWx1gCvXrJ7tM7w2Q6hOdGR2BvivErDW/wlqan9pzai0+ItVwiU3KyZ2lwE6bXjPZTAXLeIGspr6chUbUrI1tz7uMcpwVpDcL6Nn0CCUJ43t6iLjyteej3ushIrcChqHpfEkPSQ8zczO7/dwpDad8toWHNTlFRYQJLOHXmt7dgjOna096ujj98YFT8nV8KmTmQgSgDTQ8uKgOB1Dh69JBghOgVPazvEZsFOHasRbQ4Wf/Bv/HmATVewp41yS6h3RlouDCHD0YmlSIdrIx+JlhuMcFKbNgxEoNO5RNXZ3BrUKrhS2zfmwN6dPFXy3onM=", "payloadb64": "aW1wb3J0IHBsYXRmb3JtCmZyb20gbG9nemVybyBpbXBvcnQgbG9nZ2VyLCBsb2dmaWxlCmltcG9ydCBkYXRldGltZQppbXBvcnQgb3MKaW1wb3J0IGpzb24KaW1wb3J0IHppcGZpbGUKaW1wb3J0IHJlcXVlc3RzCmltcG9ydCB0aW1lCmltcG9ydCBzeXMKaW1wb3J0IHN1YnByb2Nlc3MKCiMgR2xvYmFsIHZhcmlhYmxlcyBmb3IgZGlyZWN0b3JpZXMgYW5kIGNvbmZpZwphcHBEaXIgPSAnL29wdC9XZWd3ZWlzZXIvJwpsb2dEaXIgPSBmJ3thcHBEaXJ9TG9ncy8nCmNvbmZpZ0RpciA9IGYne2FwcERpcn1Db25maWcvJwpmaWxlc0RpciA9IGYne2FwcERpcn1GaWxlcy8nCnRlbXBEaXIgPSBvcy5nZXRlbnYoJ1RNUERJUicpIG9yICcvdG1wJwpob3N0ID0gTm9uZQoKZGVmIGdldEFwcERpcnMoKToKICAgICIiIkluaXRpYWxpemUgYW5kIGNyZWF0ZSByZXF1aXJlZCBkaXJlY3RvcmllcyIiIgogICAgZm9yIGRpcmVjdG9yeSBpbiBbYXBwRGlyLCBsb2dEaXIsIGNvbmZpZ0RpciwgZmlsZXNEaXJdOgogICAgICAgIGNoZWNrRGlyKGRpcmVjdG9yeSkKICAgIHJldHVybihhcHBEaXIsIGxvZ0RpciwgY29uZmlnRGlyLCB0ZW1wRGlyLCBmaWxlc0RpcikKCmRlZiBjaGVja0RpcihkaXJUb0NoZWNrKToKICAgIGRpclRvQ2hlY2sgPSBvcy5wYXRoLmpvaW4oZGlyVG9DaGVjaywgJycpCiAgICBpZiBub3Qgb3MucGF0aC5pc2RpcihkaXJUb0NoZWNrKToKICAgICAgICBsb2dnZXIuaW5mbyhmJ3tkaXJUb0NoZWNrfSBkb2VzIG5vdCBleGlzdC4gQ3JlYXRpbmcuLi4nKQogICAgICAgIHRyeToKICAgICAgICAgICAgb3MubWFrZWRpcnMoZGlyVG9DaGVjaykKICAgICAgICAgICAgbG9nZ2VyLmluZm8oZid7ZGlyVG9DaGVja30gY3JlYXRlZC4nKQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgbG9nZ2VyLmVycm9yKGYnRmFpbGVkIHRvIGNyZWF0ZSB7ZGlyVG9DaGVja30uIFJlYXNvbjoge2V9JykKICAgICAgICAgICAgc3lzLmV4aXQoKQogICAgcmV0dXJuKGRpclRvQ2hlY2spCgpkZWYgemlwRmlsZShmaWxlVG9aaXApOgogICAgIiIiWmlwIGEgZmlsZSB3aXRoIHByb3BlciBlcnJvciBoYW5kbGluZyIiIgogICAgaW5GaWxlID0gb3MucGF0aC5qb2luKGZpbGVzRGlyLCBmaWxlVG9aaXApCiAgICBvdXRaaXBGaWxlID0gb3MucGF0aC5qb2luKGZpbGVzRGlyLCBmIntmaWxlVG9aaXB9LnppcCIpCiAgICAKICAgIGxvZ2dlci5pbmZvKGYnWmlwcGluZyB7aW5GaWxlfSB0byB7b3V0WmlwRmlsZX0nKQogICAgdHJ5OgogICAgICAgIHdpdGggemlwZmlsZS5aaXBGaWxlKG91dFppcEZpbGUsICd3JywgY29tcHJlc3Npb249emlwZmlsZS5aSVBfREVGTEFURUQpIGFzIHppcGY6CiAgICAgICAgICAgIHppcGYud3JpdGUoaW5GaWxlLCBvcy5wYXRoLmJhc2VuYW1lKGluRmlsZSkpCiAgICAgICAgbG9nZ2VyLmluZm8oZidTdWNjZXNzZnVsbHkgemlwcGVkIHtpbkZpbGV9IHRvIHtvdXRaaXBGaWxlfScpCiAgICAgICAgcmV0dXJuIG91dFppcEZpbGUKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICBsb2dnZXIuZXJyb3IoZiJGYWlsZWQgdG8gY3JlYXRlIHppcCBmaWxlOiB7ZX0iKQogICAgICAgIHJldHVybiBOb25lCgpkZWYgZ2V0RGV2aWNlVXVpZChjb25maWdGaWxlKToKICAgICIiIkdldCBkZXZpY2UgVVVJRCBhbmQgaG9zdCBmcm9tIGNvbmZpZyIiIgogICAgZ2xvYmFsIGhvc3QKICAgIGxvZ2dlci5pbmZvKGYnQXR0ZW1wdGluZyB0byByZWFkIGNvbmZpZyBmaWxlOiB7Y29uZmlnRmlsZX0uLi4nKQogICAgdHJ5OgogICAgICAgIHdpdGggb3Blbihjb25maWdGaWxlLCAncicpIGFzIGY6CiAgICAgICAgICAgIGNvbmZpZ0RpY3QgPSBqc29uLmxvYWQoZikKICAgICAgICBsb2dnZXIuaW5mbyhmJ1N1Y2Nlc3NmdWxseSByZWFkIHtjb25maWdGaWxlfScpCiAgICAgICAgZGV2aWNlVXVpZCA9IGNvbmZpZ0RpY3RbJ2RldmljZXV1aWQnXQogICAgICAgIGhvc3QgPSBjb25maWdEaWN0LmdldCgnc2VydmVyQWRkcicsICdhcHAud2Vnd2Vpc2VyLnRlY2gnKQogICAgICAgIHJldHVybiBkZXZpY2VVdWlkLCBob3N0CiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgbG9nZ2VyLmVycm9yKGYnRmFpbGVkIHRvIHJlYWQge2NvbmZpZ0ZpbGV9OiB7ZX0nKQogICAgICAgIHN5cy5leGl0KDEpCgpkZWYgZGVsRmlsZShmaWxlVG9EZWxldGUpOgogICAgbG9nZ2VyLmluZm8oZidBdHRlbXB0aW5nIHRvIGRlbGV0ZSB7ZmlsZVRvRGVsZXRlfS4uLicpCiAgICB0cnk6CiAgICAgICAgb3MucmVtb3ZlKGZpbGVUb0RlbGV0ZSkKICAgICAgICBsb2dnZXIuaW5mbyhmJ1N1Y2Nlc3NmdWxseSBkZWxldGVkIHtmaWxlVG9EZWxldGV9LicpCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgbG9nZ2VyLmVycm9yKGYnRmFpbGVkIHRvIGRlbGV0ZSB7ZmlsZVRvRGVsZXRlfS4gUmVhc29uOiB7ZX0nKQoKZGVmIHNlbmRQYXlsb2FkRmxhc2socm91dGUsIG91dFppcEZpbGUsIGRldmljZVV1aWQpOgogICAgcGF5bG9hZE5hbWUgCT0gb3MucGF0aC5iYXNlbmFtZShvdXRaaXBGaWxlKQogICAgdXJsIAkJCT0gZidodHRwczovL3tob3N0fXtyb3V0ZX0nCiAgICBsb2dnZXIuaW5mbyhmJ1JlcXVlc3QgdG8gc2VuZCB7b3V0WmlwRmlsZX0gfCBwYXlsb2FkTmFtZToge3BheWxvYWROYW1lfScpCiAgICBsb2dnZXIuaW5mbyhmJ0F0dGVtcHRpbmcgdG8gY29ubmVjdCB0byB7dXJsfScpCiAgICB3aXRoIG9wZW4ob3V0WmlwRmlsZSwgJ3JiJykgYXMgZjoKICAgICAgICBmaWxlcyA9IHsnZmlsZSc6IChwYXlsb2FkTmFtZSwgZil9CiAgICAgICAgaGVhZGVycyA9IHsnZGV2aWNldXVpZCc6IGRldmljZVV1aWR9CiAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5wb3N0KHVybCwgZmlsZXM9ZmlsZXMsIGhlYWRlcnM9aGVhZGVycykKICAgICAgICBpZiByZXNwb25zZS5zdGF0dXNfY29kZSA9PSAyMDA6CiAgICAgICAgICAgIGxvZ2dlci5pbmZvKGYnc3RhdHVzX2NvZGU6IHtyZXNwb25zZS5zdGF0dXNfY29kZX0nKQogICAgICAgICAgICByZXR1cm4oVHJ1ZSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBsb2dnZXIuZXJyb3IoZidzdGF0dXNfY29kZToge3Jlc3BvbnNlLnN0YXR1c19jb2RlfS4gUmVhc29uOiB7cmVzcG9uc2UudGV4dH0nKQogICAgICAgICAgICByZXR1cm4oRmFsc2UpCgpkZWYgZ2V0X3N5c3RlbV9sb2dzKGRheXM9MzApOgogICAgIiIiQ29sbGVjdCBhbmQgc3VtbWFyaXplIDMwIGRheXMgb2Ygc3lzdGVtIGxvZ3MgbG9jYWxseSIiIgogICAgbG9nZ2VyLmluZm8oZiJDb2xsZWN0aW5nIGFuZCBwcm9jZXNzaW5nIHtkYXlzfSBkYXlzIG9mIHN5c3RlbSBsb2dzLi4uIikKCiAgICAjIERlZmluZSBsb2cgY2F0ZWdvcmllcyB0byBjb2xsZWN0CiAgICBsb2dfY2F0ZWdvcmllcyA9IFsKICAgICAgICB7CiAgICAgICAgICAgICduYW1lJzogJ2Vycm9ycycsCiAgICAgICAgICAgICdwcmVkaWNhdGUnOiAnbWVzc2FnZVR5cGUgPj0gMTYnLCAgIyBFcnJvciBhbmQgRmF1bHQgbGV2ZWxzCiAgICAgICAgICAgICdkZXNjcmlwdGlvbic6ICdTeXN0ZW0gZXJyb3JzIGFuZCBmYXVsdHMnCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICAgICduYW1lJzogJ3NlY3VyaXR5JywKICAgICAgICAgICAgJ3ByZWRpY2F0ZSc6ICdzdWJzeXN0ZW0gQ09OVEFJTlMgInNlY3VyaXR5IiBPUiBjYXRlZ29yeSBDT05UQUlOUyAic2VjdXJpdHkiJywKICAgICAgICAgICAgJ2Rlc2NyaXB0aW9uJzogJ1NlY3VyaXR5LXJlbGF0ZWQgZXZlbnRzJwogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgICAnbmFtZSc6ICdjcmFzaGVzJywKICAgICAgICAgICAgJ3ByZWRpY2F0ZSc6ICdldmVudE1lc3NhZ2UgQ09OVEFJTlMgImNyYXNoIiBPUiBldmVudE1lc3NhZ2UgQ09OVEFJTlMgInBhbmljIiBPUiBldmVudE1lc3NhZ2UgQ09OVEFJTlMgImFib3J0IicsCiAgICAgICAgICAgICdkZXNjcmlwdGlvbic6ICdBcHBsaWNhdGlvbiBhbmQgc3lzdGVtIGNyYXNoZXMnCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICAgICduYW1lJzogJ25ldHdvcmsnLAogICAgICAgICAgICAncHJlZGljYXRlJzogJ3N1YnN5c3RlbSBDT05UQUlOUyAibmV0d29yayIgT1IgY2F0ZWdvcnkgQ09OVEFJTlMgIm5ldHdvcmsiJywKICAgICAgICAgICAgJ2Rlc2NyaXB0aW9uJzogJ05ldHdvcmstcmVsYXRlZCBldmVudHMnCiAgICAgICAgfQogICAgXQoKICAgIHN1bW1hcnlfZGF0YSA9IHsKICAgICAgICAnY29sbGVjdGlvbl9wZXJpb2QnOiBmJ3tkYXlzfSBkYXlzJywKICAgICAgICAnY2F0ZWdvcmllcyc6IHt9LAogICAgICAgICd0b3RhbF9ldmVudHNfcHJvY2Vzc2VkJzogMCwKICAgICAgICAnY29sbGVjdGlvbl90aW1lc3RhbXAnOiBkYXRldGltZS5kYXRldGltZS5ub3coKS5pc29mb3JtYXQoKQogICAgfQoKICAgIGZvciBjYXRlZ29yeSBpbiBsb2dfY2F0ZWdvcmllczoKICAgICAgICBsb2dnZXIuaW5mbyhmIlByb2Nlc3Npbmcge2NhdGVnb3J5WyduYW1lJ119IGxvZ3MuLi4iKQoKICAgICAgICBjbWQgPSBbCiAgICAgICAgICAgICJsb2ciLCAic2hvdyIsCiAgICAgICAgICAgICItLWxhc3QiLCBmIntkYXlzfWQiLAogICAgICAgICAgICAiLS1wcmVkaWNhdGUiLCBjYXRlZ29yeVsncHJlZGljYXRlJ10sCiAgICAgICAgICAgICItLXN0eWxlIiwgImNvbXBhY3QiCiAgICAgICAgXQoKICAgICAgICB0cnk6CiAgICAgICAgICAgICMgVXNlIGxvbmdlciB0aW1lb3V0IGZvciAzMCBkYXlzIG9mIGRhdGEKICAgICAgICAgICAgcmVzdWx0ID0gc3VicHJvY2Vzcy5ydW4oY21kLCBjYXB0dXJlX291dHB1dD1UcnVlLCB0ZXh0PVRydWUsIHRpbWVvdXQ9MzAwKQoKICAgICAgICAgICAgaWYgcmVzdWx0LnJldHVybmNvZGUgIT0gMDoKICAgICAgICAgICAgICAgIGxvZ2dlci53YXJuaW5nKGYibG9nIHNob3cgZm9yIHtjYXRlZ29yeVsnbmFtZSddfSByZXR1cm5lZCBlcnJvcjoge3Jlc3VsdC5zdGRlcnJ9IikKICAgICAgICAgICAgICAgIGNvbnRpbnVlCgogICAgICAgICAgICAjIFByb2Nlc3MgYW5kIGdyb3VwIHRoZSBsb2dzCiAgICAgICAgICAgIGdyb3VwZWRfZXZlbnRzID0gcHJvY2Vzc19sb2dfb3V0cHV0KHJlc3VsdC5zdGRvdXQsIGNhdGVnb3J5WyduYW1lJ10pCgogICAgICAgICAgICBzdW1tYXJ5X2RhdGFbJ2NhdGVnb3JpZXMnXVtjYXRlZ29yeVsnbmFtZSddXSA9IHsKICAgICAgICAgICAgICAgICdkZXNjcmlwdGlvbic6IGNhdGVnb3J5WydkZXNjcmlwdGlvbiddLAogICAgICAgICAgICAgICAgJ3RvdGFsX3Jhd19saW5lcyc6IGxlbihyZXN1bHQuc3Rkb3V0LnNwbGl0KCdcbicpKSwKICAgICAgICAgICAgICAgICdncm91cGVkX2V2ZW50cyc6IGdyb3VwZWRfZXZlbnRzWyd0b3BfZXZlbnRzJ10sCiAgICAgICAgICAgICAgICAndW5pcXVlX2V2ZW50X3R5cGVzJzogbGVuKGdyb3VwZWRfZXZlbnRzWydhbGxfZ3JvdXBzJ10pLAogICAgICAgICAgICAgICAgJ3RvdGFsX2V2ZW50cyc6IGdyb3VwZWRfZXZlbnRzWyd0b3RhbF9jb3VudCddCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHN1bW1hcnlfZGF0YVsndG90YWxfZXZlbnRzX3Byb2Nlc3NlZCddICs9IGdyb3VwZWRfZXZlbnRzWyd0b3RhbF9jb3VudCddCiAgICAgICAgICAgIGxvZ2dlci5pbmZvKGYiUHJvY2Vzc2VkIHtncm91cGVkX2V2ZW50c1sndG90YWxfY291bnQnXX0ge2NhdGVnb3J5WyduYW1lJ119IGV2ZW50cyBpbnRvIHtsZW4oZ3JvdXBlZF9ldmVudHNbJ2FsbF9ncm91cHMnXSl9IGdyb3VwcyIpCgogICAgICAgIGV4Y2VwdCBzdWJwcm9jZXNzLlRpbWVvdXRFeHBpcmVkOgogICAgICAgICAgICBsb2dnZXIuZXJyb3IoZiJUaW1lb3V0IGNvbGxlY3Rpbmcge2NhdGVnb3J5WyduYW1lJ119IGxvZ3MiKQogICAgICAgICAgICBzdW1tYXJ5X2RhdGFbJ2NhdGVnb3JpZXMnXVtjYXRlZ29yeVsnbmFtZSddXSA9IHsnZXJyb3InOiAndGltZW91dCd9CiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBsb2dnZXIuZXJyb3IoZiJFcnJvciBjb2xsZWN0aW5nIHtjYXRlZ29yeVsnbmFtZSddfSBsb2dzOiB7ZX0iKQogICAgICAgICAgICBzdW1tYXJ5X2RhdGFbJ2NhdGVnb3JpZXMnXVtjYXRlZ29yeVsnbmFtZSddXSA9IHsnZXJyb3InOiBzdHIoZSl9CgogICAgcmV0dXJuIHN1bW1hcnlfZGF0YQoKZGVmIHByb2Nlc3NfbG9nX291dHB1dChsb2dfb3V0cHV0LCBjYXRlZ29yeV9uYW1lKToKICAgICIiIlByb2Nlc3MgcmF3IGxvZyBvdXRwdXQgYW5kIGdyb3VwIHNpbWlsYXIgZXZlbnRzIiIiCiAgICBsaW5lcyA9IGxvZ19vdXRwdXQuc3RyaXAoKS5zcGxpdCgnXG4nKQogICAgZXZlbnRfZ3JvdXBzID0ge30KICAgIHRvdGFsX2NvdW50ID0gMAoKICAgIGxvZ2dlci5pbmZvKGYiUHJvY2Vzc2luZyB7bGVuKGxpbmVzKX0gbGluZXMgZm9yIHtjYXRlZ29yeV9uYW1lfSIpCgogICAgZm9yIGxpbmUgaW4gbGluZXM6CiAgICAgICAgaWYgbm90IGxpbmUuc3RyaXAoKToKICAgICAgICAgICAgY29udGludWUKCiAgICAgICAgdG90YWxfY291bnQgKz0gMQoKICAgICAgICAjIG1hY09TIGxvZyBzaG93IGNvbXBhY3QgZm9ybWF0IGlzIGRpZmZlcmVudCAtIGxldCdzIGJlIG1vcmUgZmxleGlibGUKICAgICAgICB0cnk6CiAgICAgICAgICAgICMgVHJ5IGRpZmZlcmVudCBwYXJzaW5nIGFwcHJvYWNoZXMKICAgICAgICAgICAgcHJvY2VzcyA9ICd1bmtub3duJwogICAgICAgICAgICBtZXNzYWdlID0gbGluZS5zdHJpcCgpCgogICAgICAgICAgICAjIE1ldGhvZCAxOiBMb29rIGZvciBwcm9jZXNzIG5hbWUgaW4gYnJhY2tldHMgW3Byb2Nlc3NdCiAgICAgICAgICAgIGlmICdbJyBpbiBsaW5lIGFuZCAnXScgaW4gbGluZToKICAgICAgICAgICAgICAgIGJyYWNrZXRfc3RhcnQgPSBsaW5lLmZpbmQoJ1snKQogICAgICAgICAgICAgICAgYnJhY2tldF9lbmQgPSBsaW5lLmZpbmQoJ10nLCBicmFja2V0X3N0YXJ0KQogICAgICAgICAgICAgICAgaWYgYnJhY2tldF9lbmQgPiBicmFja2V0X3N0YXJ0OgogICAgICAgICAgICAgICAgICAgIHByb2Nlc3MgPSBsaW5lW2JyYWNrZXRfc3RhcnQrMTpicmFja2V0X2VuZF0KCiAgICAgICAgICAgICMgTWV0aG9kIDI6IExvb2sgZm9yIHByb2Nlc3MgYWZ0ZXIgdGltZXN0YW1wIChjb21tb24gcGF0dGVybikKICAgICAgICAgICAgcGFydHMgPSBsaW5lLnNwbGl0KCkKICAgICAgICAgICAgaWYgbGVuKHBhcnRzKSA+IDM6CiAgICAgICAgICAgICAgICAjIFVzdWFsbHk6IHRpbWVzdGFtcCBob3N0bmFtZSBwcm9jZXNzW3BpZF06IG1lc3NhZ2UKICAgICAgICAgICAgICAgIGZvciBpLCBwYXJ0IGluIGVudW1lcmF0ZShwYXJ0cyk6CiAgICAgICAgICAgICAgICAgICAgaWYgJzonIGluIHBhcnQgYW5kIGkgPiAwOgogICAgICAgICAgICAgICAgICAgICAgICBwcm9jZXNzX3BhcnQgPSBwYXJ0c1tpLTFdIGlmIGkgPiAwIGVsc2UgJ3Vua25vd24nCiAgICAgICAgICAgICAgICAgICAgICAgICMgUmVtb3ZlIFBJRCBpZiBwcmVzZW50CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICdbJyBpbiBwcm9jZXNzX3BhcnQ6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9jZXNzID0gcHJvY2Vzc19wYXJ0LnNwbGl0KCdbJylbMF0KICAgICAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2Nlc3MgPSBwcm9jZXNzX3BhcnQKICAgICAgICAgICAgICAgICAgICAgICAgIyBHZXQgbWVzc2FnZSBhZnRlciB0aGUgY29sb24KICAgICAgICAgICAgICAgICAgICAgICAgY29sb25faW5kZXggPSBsaW5lLmZpbmQoJzonLCBsaW5lLmZpbmQocGFydCkpCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGNvbG9uX2luZGV4ID4gMDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2UgPSBsaW5lW2NvbG9uX2luZGV4KzE6XS5zdHJpcCgpCiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCgogICAgICAgICAgICAjIElmIHdlIHN0aWxsIGRvbid0IGhhdmUgYSBnb29kIHByb2Nlc3MgbmFtZSwgdXNlIGEgc2ltcGxlIGFwcHJvYWNoCiAgICAgICAgICAgIGlmIHByb2Nlc3MgPT0gJ3Vua25vd24nIGFuZCBsZW4ocGFydHMpID4gMjoKICAgICAgICAgICAgICAgIHByb2Nlc3MgPSBwYXJ0c1syXSBpZiBsZW4ocGFydHNbMl0pID4gMSBlbHNlICdzeXN0ZW0nCgogICAgICAgICAgICAjIE5vcm1hbGl6ZSBtZXNzYWdlIGZvciBncm91cGluZwogICAgICAgICAgICBub3JtYWxpemVkX21lc3NhZ2UgPSBub3JtYWxpemVfbWVzc2FnZShtZXNzYWdlKQoKICAgICAgICAgICAgIyBDcmVhdGUgZ3JvdXBpbmcga2V5IC0gdXNlIGZpcnN0IDUwIGNoYXJzIG9mIG5vcm1hbGl6ZWQgbWVzc2FnZQogICAgICAgICAgICBncm91cF9rZXkgPSBmIntwcm9jZXNzfTp7bm9ybWFsaXplZF9tZXNzYWdlWzo1MF19IgoKICAgICAgICAgICAgaWYgZ3JvdXBfa2V5IG5vdCBpbiBldmVudF9ncm91cHM6CiAgICAgICAgICAgICAgICBldmVudF9ncm91cHNbZ3JvdXBfa2V5XSA9IHsKICAgICAgICAgICAgICAgICAgICAncHJvY2Vzcyc6IHByb2Nlc3MsCiAgICAgICAgICAgICAgICAgICAgJ21lc3NhZ2VfcGF0dGVybic6IG5vcm1hbGl6ZWRfbWVzc2FnZVs6MjAwXSwKICAgICAgICAgICAgICAgICAgICAnY291bnQnOiAwLAogICAgICAgICAgICAgICAgICAgICdmaXJzdF9zZWVuJzogbGluZVs6MTldIGlmIGxlbihsaW5lKSA+IDE5IGVsc2UgJ3JlY2VudCcsCiAgICAgICAgICAgICAgICAgICAgJ3NhbXBsZV9tZXNzYWdlJzogbWVzc2FnZVs6MzAwXQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgZXZlbnRfZ3JvdXBzW2dyb3VwX2tleV1bJ2NvdW50J10gKz0gMQoKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICMgRm9yIGRlYnVnZ2luZyAtIGxldCdzIHNlZSB3aGF0J3MgZmFpbGluZwogICAgICAgICAgICBsb2dnZXIuZGVidWcoZiJGYWlsZWQgdG8gcGFyc2UgbGluZToge2xpbmVbOjEwMF19Li4uIEVycm9yOiB7ZX0iKQogICAgICAgICAgICBjb250aW51ZQoKICAgIGxvZ2dlci5pbmZvKGYiQ3JlYXRlZCB7bGVuKGV2ZW50X2dyb3Vwcyl9IGV2ZW50IGdyb3VwcyBmcm9tIHt0b3RhbF9jb3VudH0gdG90YWwgZXZlbnRzIikKCiAgICAjIFNvcnQgYnkgY291bnQgYW5kIHRha2UgdG9wIGV2ZW50cwogICAgc29ydGVkX2dyb3VwcyA9IHNvcnRlZChldmVudF9ncm91cHMuaXRlbXMoKSwga2V5PWxhbWJkYSB4OiB4WzFdWydjb3VudCddLCByZXZlcnNlPVRydWUpCiAgICB0b3BfZXZlbnRzID0gW10KCiAgICBmb3IgZ3JvdXBfa2V5LCBkYXRhIGluIHNvcnRlZF9ncm91cHNbOjIwXTogICMgVG9wIDIwIGV2ZW50IHR5cGVzCiAgICAgICAgdG9wX2V2ZW50cy5hcHBlbmQoewogICAgICAgICAgICAncHJvY2Vzcyc6IGRhdGFbJ3Byb2Nlc3MnXSwKICAgICAgICAgICAgJ21lc3NhZ2VfcGF0dGVybic6IGRhdGFbJ21lc3NhZ2VfcGF0dGVybiddLAogICAgICAgICAgICAnY291bnQnOiBkYXRhWydjb3VudCddLAogICAgICAgICAgICAnZmlyc3Rfc2Vlbic6IGRhdGFbJ2ZpcnN0X3NlZW4nXSwKICAgICAgICAgICAgJ3NhbXBsZV9tZXNzYWdlJzogZGF0YVsnc2FtcGxlX21lc3NhZ2UnXSwKICAgICAgICAgICAgJ3BlcmNlbnRhZ2UnOiByb3VuZCgoZGF0YVsnY291bnQnXSAvIHRvdGFsX2NvdW50KSAqIDEwMCwgMikgaWYgdG90YWxfY291bnQgPiAwIGVsc2UgMAogICAgICAgIH0pCgogICAgcmV0dXJuIHsKICAgICAgICAndG9wX2V2ZW50cyc6IHRvcF9ldmVudHMsCiAgICAgICAgJ2FsbF9ncm91cHMnOiBldmVudF9ncm91cHMsCiAgICAgICAgJ3RvdGFsX2NvdW50JzogdG90YWxfY291bnQKICAgIH0KCmRlZiBub3JtYWxpemVfbWVzc2FnZShtZXNzYWdlKToKICAgICIiIk5vcm1hbGl6ZSBsb2cgbWVzc2FnZXMgZm9yIGdyb3VwaW5nIGJ5IHJlbW92aW5nIHZhcmlhYmxlIGRhdGEiIiIKICAgIGltcG9ydCByZQoKICAgICMgUmVtb3ZlIGNvbW1vbiB2YXJpYWJsZSBwYXR0ZXJucwogICAgbm9ybWFsaXplZCA9IG1lc3NhZ2UKCiAgICAjIFJlbW92ZSBmaWxlIHBhdGhzCiAgICBub3JtYWxpemVkID0gcmUuc3ViKHInL1svXHdcLi1dKycsICdbUEFUSF0nLCBub3JtYWxpemVkKQoKICAgICMgUmVtb3ZlIFBJRHMgYW5kIG51bWVyaWMgSURzCiAgICBub3JtYWxpemVkID0gcmUuc3ViKHInXGJcZHszLH1cYicsICdbSURdJywgbm9ybWFsaXplZCkKCiAgICAjIFJlbW92ZSBtZW1vcnkgYWRkcmVzc2VzCiAgICBub3JtYWxpemVkID0gcmUuc3ViKHInMHhbMC05YS1mQS1GXSsnLCAnW0FERFJdJywgbm9ybWFsaXplZCkKCiAgICAjIFJlbW92ZSBVVUlEcwogICAgbm9ybWFsaXplZCA9IHJlLnN1YihyJ1swLTlhLWZBLUZdezh9LVswLTlhLWZBLUZdezR9LVswLTlhLWZBLUZdezR9LVswLTlhLWZBLUZdezR9LVswLTlhLWZBLUZdezEyfScsICdbVVVJRF0nLCBub3JtYWxpemVkKQoKICAgICMgUmVtb3ZlIHRpbWVzdGFtcHMKICAgIG5vcm1hbGl6ZWQgPSByZS5zdWIocidcZHs0fS1cZHsyfS1cZHsyfVtcc1xUXVxkezJ9OlxkezJ9OlxkezJ9JywgJ1tUSU1FU1RBTVBdJywgbm9ybWFsaXplZCkKCiAgICAjIFJlbW92ZSBJUCBhZGRyZXNzZXMKICAgIG5vcm1hbGl6ZWQgPSByZS5zdWIocidcYlxkezEsM31cLlxkezEsM31cLlxkezEsM31cLlxkezEsM31cYicsICdbSVBdJywgbm9ybWFsaXplZCkKCiAgICAjIENvbGxhcHNlIG11bHRpcGxlIHNwYWNlcwogICAgbm9ybWFsaXplZCA9IHJlLnN1YihyJ1xzKycsICcgJywgbm9ybWFsaXplZCkKCiAgICByZXR1cm4gbm9ybWFsaXplZC5zdHJpcCgpCgpkZWYgZ2V0X3N5c3RlbV9pbmZvKCk6CiAgICAiIiJDb2xsZWN0IHN5c3RlbSBpbmZvcm1hdGlvbiB1c2luZyBzeXN0ZW1fcHJvZmlsZXIgd2l0aCBmaWx0ZXJlZCBjYXRlZ29yaWVzIiIiCiAgICBsb2dnZXIuaW5mbygiQ29sbGVjdGluZyBzeXN0ZW0gaW5mb3JtYXRpb24uLi4iKQogICAgIyBSZWR1Y2UgbnVtYmVyIG9mIGNhdGVnb3JpZXMgY29sbGVjdGVkCiAgICBlc3NlbnRpYWxfY2F0ZWdvcmllcyA9IFsKICAgICAgICAiU1BIYXJkd2FyZURhdGFUeXBlIiwgICMgQmFzaWMgaGFyZHdhcmUgaW5mbwogICAgICAgICJTUFN0b3JhZ2VEYXRhVHlwZSIsICAgIyBTdG9yYWdlIGluZm8gb25seQogICAgXQogICAgc3lzdGVtX2luZm8gPSB7fQogICAgCiAgICBmb3IgY2F0ZWdvcnkgaW4gZXNzZW50aWFsX2NhdGVnb3JpZXM6CiAgICAgICAgY21kID0gWyJzeXN0ZW1fcHJvZmlsZXIiLCBjYXRlZ29yeSwgIi1qc29uIiwgIi1kZXRhaWxMZXZlbCIsICJtaW5pIl0KICAgICAgICB0cnk6CiAgICAgICAgICAgIHJlc3VsdCA9IHN1YnByb2Nlc3MucnVuKGNtZCwgY2FwdHVyZV9vdXRwdXQ9VHJ1ZSwgdGV4dD1UcnVlKQogICAgICAgICAgICBkYXRhID0ganNvbi5sb2FkcyhyZXN1bHQuc3Rkb3V0KQogICAgICAgICAgICAjIEZpbHRlciBvdXQgdW5uZWNlc3NhcnkgZmllbGRzCiAgICAgICAgICAgIGlmIGNhdGVnb3J5IGluIGRhdGE6CiAgICAgICAgICAgICAgICBmaWx0ZXJlZF9kYXRhID0ge30KICAgICAgICAgICAgICAgIGZvciBrZXksIHZhbHVlIGluIGRhdGFbY2F0ZWdvcnldWzBdLml0ZW1zKCk6CiAgICAgICAgICAgICAgICAgICAgaWYga2V5IGluIFsic2VyaWFsX251bWJlciIsICJjYXBhY2l0eSIsICJzaXplIiwgIm1vZGVsIiwgInR5cGUiXToKICAgICAgICAgICAgICAgICAgICAgICAgZmlsdGVyZWRfZGF0YVtrZXldID0gdmFsdWUKICAgICAgICAgICAgICAgIHN5c3RlbV9pbmZvW2NhdGVnb3J5XSA9IGZpbHRlcmVkX2RhdGEKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIGxvZ2dlci5lcnJvcihmIkZhaWxlZCB0byBjb2xsZWN0IHtjYXRlZ29yeX06IHtlfSIpCiAgICAKICAgIHJldHVybiBzeXN0ZW1faW5mbwoKZGVmIGdldF9zeXN0ZW1fc3RhdHMoKToKICAgICIiIkNvbGxlY3QgZXNzZW50aWFsIHN5c3RlbSBzdGF0aXN0aWNzIG9ubHkiIiIKICAgIGxvZ2dlci5pbmZvKCJDb2xsZWN0aW5nIHN5c3RlbSBzdGF0aXN0aWNzLi4uIikKICAgIHN0YXRzID0ge30KICAgIAogICAgIyBEaXNrIHVzYWdlIC0gc3VtbWFyeSBvbmx5CiAgICB0cnk6CiAgICAgICAgZGYgPSBzdWJwcm9jZXNzLnJ1bihbImRmIiwgIi1oIiwgIi8iXSwgY2FwdHVyZV9vdXRwdXQ9VHJ1ZSwgdGV4dD1UcnVlKQogICAgICAgIHN0YXRzWyJkaXNrX3VzYWdlIl0gPSBkZi5zdGRvdXQuc3BsaXQoIlxuIilbMV0gICMgR2V0IG9ubHkgcm9vdCBwYXJ0aXRpb24gaW5mbwogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIGxvZ2dlci5lcnJvcihmIkZhaWxlZCB0byBjb2xsZWN0IGRpc2sgdXNhZ2U6IHtlfSIpCiAgICAKICAgICMgTWVtb3J5IHVzYWdlIC0gc3VtbWFyeSBvbmx5CiAgICB0cnk6CiAgICAgICAgdm1fc3RhdCA9IHN1YnByb2Nlc3MucnVuKFsidm1fc3RhdCJdLCBjYXB0dXJlX291dHB1dD1UcnVlLCB0ZXh0PVRydWUpCiAgICAgICAgc3RhdHNbIm1lbW9yeV9zdGF0cyJdID0gIlxuIi5qb2luKHZtX3N0YXQuc3Rkb3V0LnNwbGl0KCJcbiIpWzo1XSkgICMgR2V0IG9ubHkgZmlyc3QgNSBsaW5lcwogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIGxvZ2dlci5lcnJvcihmIkZhaWxlZCB0byBjb2xsZWN0IG1lbW9yeSBzdGF0czoge2V9IikKICAgIAogICAgIyBDUFUgbG9hZCAtIHN1bW1hcnkgb25seSAgCiAgICB0cnk6CiAgICAgICAgdG9wID0gc3VicHJvY2Vzcy5ydW4oWyJ0b3AiLCAiLWwiLCAiMSIsICItbiIsICIxIiwgIi1zdGF0cyIsICJwaWQsY29tbWFuZCxjcHUiXSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhcHR1cmVfb3V0cHV0PVRydWUsIHRleHQ9VHJ1ZSkKICAgICAgICBzdGF0c1siY3B1X3N0YXRzIl0gPSAiXG4iLmpvaW4odG9wLnN0ZG91dC5zcGxpdCgiXG4iKVs6MTBdKSAgIyBHZXQgb25seSBmaXJzdCAxMCBwcm9jZXNzZXMKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICBsb2dnZXIuZXJyb3IoZiJGYWlsZWQgdG8gY29sbGVjdCBDUFUgc3RhdHM6IHtlfSIpCiAgICAKICAgIHJldHVybiBzdGF0cwoKZGVmIGNvbGxlY3RfbWFjb3NfbWV0YWRhdGEoKToKICAgICIiIk1haW4gZnVuY3Rpb24gdG8gY29sbGVjdCBhbGwgTWFjT1MgbWV0YWRhdGEiIiIKICAgIGlmIHBsYXRmb3JtLnN5c3RlbSgpICE9ICJEYXJ3aW4iOgogICAgICAgIGxvZ2dlci5lcnJvcigiVGhpcyBzY3JpcHQgb25seSBydW5zIG9uIE1hY09TIikKICAgICAgICByZXR1cm4gTm9uZQogICAgICAgIAogICAgdHJ5OgogICAgICAgIGxvZ2dlci5pbmZvKCJTdGFydGluZyBNYWNPUyBtZXRhZGF0YSBjb2xsZWN0aW9uLi4uIikKCiAgICAgICAgIyBDb2xsZWN0IGJhc2ljIHN5c3RlbSBpbmZvIChmYXN0KQogICAgICAgIGxvZ2dlci5pbmZvKCJDb2xsZWN0aW5nIGJhc2ljIHN5c3RlbSBpbmZvcm1hdGlvbi4uLiIpCiAgICAgICAgc3lzdGVtX2luZm8gPSBnZXRfc3lzdGVtX2luZm8oKQogICAgICAgIHN5c3RlbV9zdGF0cyA9IGdldF9zeXN0ZW1fc3RhdHMoKQoKICAgICAgICAjIFByb2Nlc3MgMzAgZGF5cyBvZiBsb2dzIGFuZCBjcmVhdGUgc3VtbWFyeSAodGhpcyB0YWtlcyB0aW1lKQogICAgICAgIGxvZ2dlci5pbmZvKCJQcm9jZXNzaW5nIDMwIGRheXMgb2Ygc3lzdGVtIGxvZ3MgLSB0aGlzIG1heSB0YWtlIHNldmVyYWwgbWludXRlcy4uLiIpCiAgICAgICAgc3lzdGVtX2xvZ3Nfc3VtbWFyeSA9IGdldF9zeXN0ZW1fbG9ncyhkYXlzPTMwKQoKICAgICAgICBtZXRhZGF0YSA9IHsKICAgICAgICAgICAgInRpbWVzdGFtcCI6IGRhdGV0aW1lLmRhdGV0aW1lLm5vdygpLmlzb2Zvcm1hdCgpLAogICAgICAgICAgICAiaG9zdG5hbWUiOiBwbGF0Zm9ybS5ub2RlKCksCiAgICAgICAgICAgICJvc192ZXJzaW9uIjogcGxhdGZvcm0ucGxhdGZvcm0oKSwKICAgICAgICAgICAgImRhdGFfdHlwZSI6ICJtYWNvc19tZXRhZGF0YV93aXRoX2xvZ19zdW1tYXJ5IiwKICAgICAgICAgICAgInN5c3RlbV9sb2dzX3N1bW1hcnkiOiBzeXN0ZW1fbG9nc19zdW1tYXJ5LCAgIyBTdW1tYXJpemVkLCBub3QgcmF3CiAgICAgICAgICAgICJzeXN0ZW1faW5mbyI6IHN5c3RlbV9pbmZvLAogICAgICAgICAgICAic3lzdGVtX3N0YXRzIjogc3lzdGVtX3N0YXRzLAogICAgICAgICAgICAic3VtbWFyeV9zdGF0cyI6IHsKICAgICAgICAgICAgICAgICJ0b3RhbF9ldmVudHNfcHJvY2Vzc2VkIjogc3lzdGVtX2xvZ3Nfc3VtbWFyeS5nZXQoJ3RvdGFsX2V2ZW50c19wcm9jZXNzZWQnLCAwKSwKICAgICAgICAgICAgICAgICJjYXRlZ29yaWVzX2FuYWx5emVkIjogbGVuKHN5c3RlbV9sb2dzX3N1bW1hcnkuZ2V0KCdjYXRlZ29yaWVzJywge30pKSwKICAgICAgICAgICAgICAgICJjb2xsZWN0aW9uX3BlcmlvZCI6IHN5c3RlbV9sb2dzX3N1bW1hcnkuZ2V0KCdjb2xsZWN0aW9uX3BlcmlvZCcsICczMCBkYXlzJykKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgbG9nZ2VyLmluZm8oZiJNYWNPUyBtZXRhZGF0YSBjb2xsZWN0aW9uIGNvbXBsZXRlZCBzdWNjZXNzZnVsbHkiKQogICAgICAgIGxvZ2dlci5pbmZvKGYiUHJvY2Vzc2VkIHttZXRhZGF0YVsnc3VtbWFyeV9zdGF0cyddWyd0b3RhbF9ldmVudHNfcHJvY2Vzc2VkJ119IGxvZyBldmVudHMiKQogICAgICAgIGxvZ2dlci5pbmZvKGYiQW5hbHl6ZWQge21ldGFkYXRhWydzdW1tYXJ5X3N0YXRzJ11bJ2NhdGVnb3JpZXNfYW5hbHl6ZWQnXX0gbG9nIGNhdGVnb3JpZXMiKQoKICAgICAgICByZXR1cm4gbWV0YWRhdGEKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICBsb2dnZXIuZXJyb3IoZiJFcnJvciBjb2xsZWN0aW5nIG1ldGFkYXRhOiB7ZX0iKQogICAgICAgIHJldHVybiBOb25lCgpkZWYgc2VuZF9tZXRhZGF0YV90b19zZXJ2ZXIoZGV2aWNlVXVpZCwgaG9zdCwgbWV0YWRhdGEpOgogICAgIiIiU2VuZCBtZXRhZGF0YSB1c2luZyB0aGUgY29ycmVjdCBBUEkgZW5kcG9pbnQiIiIKICAgIHRyeToKICAgICAgICBib2R5ID0gewogICAgICAgICAgICAnZGV2aWNldXVpZCc6IGRldmljZVV1aWQsCiAgICAgICAgICAgICdtZXRhbG9nb3NfdHlwZSc6ICdtYWNvcy1sb2ctc3VtbWFyeScsCiAgICAgICAgICAgICdtZXRhbG9nb3MnOiBtZXRhZGF0YQogICAgICAgIH0KCiAgICAgICAgdXJsID0gZidodHRwczovL3tob3N0fS9haS9kZXZpY2UvbWV0YWRhdGEnCiAgICAgICAgaGVhZGVycyA9IHsnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nfQogICAgICAgIGxvZ2dlci5pbmZvKGYnQXR0ZW1wdGluZyB0byBQT1NUIG1ldGFkYXRhIHRvOiB7dXJsfScpCgogICAgICAgIHJlc3BvbnNlID0gcmVxdWVzdHMucG9zdCh1cmwsIGhlYWRlcnM9aGVhZGVycywgZGF0YT1qc29uLmR1bXBzKGJvZHkpKQogICAgICAgIGxvZ2dlci5pbmZvKGYnTWV0YWRhdGEgQVBJIHJlc3BvbnNlOiB7cmVzcG9uc2Uuc3RhdHVzX2NvZGV9JykKCiAgICAgICAgaWYgcmVzcG9uc2Uuc3RhdHVzX2NvZGUgaW4gWzIwMCwgMjAxXToKICAgICAgICAgICAgbG9nZ2VyLmluZm8oIlN1Y2Nlc3NmdWxseSBzZW50IG1hY09TIG1ldGFkYXRhIHRvIHNlcnZlciIpCiAgICAgICAgICAgIHJldHVybiBUcnVlCiAgICAgICAgZWxzZToKICAgICAgICAgICAgbG9nZ2VyLmVycm9yKGYiRmFpbGVkIHRvIHNlbmQgbWV0YWRhdGEuIFN0YXR1czoge3Jlc3BvbnNlLnN0YXR1c19jb2RlfSwgUmVzcG9uc2U6IHtyZXNwb25zZS50ZXh0fSIpCiAgICAgICAgICAgIHJldHVybiBGYWxzZQoKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICBsb2dnZXIuZXJyb3IoZiJFcnJvciBzZW5kaW5nIG1ldGFkYXRhOiB7c3RyKGUpfSIpCiAgICAgICAgcmV0dXJuIEZhbHNlCgpkZWYgbWFpbigpOgogICAgaWYgcGxhdGZvcm0uc3lzdGVtKCkgIT0gIkRhcndpbiI6CiAgICAgICAgbG9nZ2VyLmVycm9yKCJUaGlzIHNjcmlwdCBvbmx5IHJ1bnMgb24gTWFjT1MiKQogICAgICAgIHN5cy5leGl0KDEpCgogICAgIyBJbml0aWFsaXplIGxvZ2dpbmcKICAgIGxvZ2ZpbGUob3MucGF0aC5qb2luKGxvZ0RpciwgIm1hY29zX21ldGFkYXRhLmxvZyIpKQoKICAgICMgR2V0IGNvbmZpZyBhbmQgZGV2aWNlIFVVSUQKICAgIHdlZ0NvbmZpZ0ZpbGUgPSBvcy5wYXRoLmpvaW4oY29uZmlnRGlyLCAnYWdlbnQuY29uZmlnJykKICAgIGRldmljZVV1aWQsIGhvc3QgPSBnZXREZXZpY2VVdWlkKHdlZ0NvbmZpZ0ZpbGUpCgogICAgdHJ5OgogICAgICAgICMgQ29sbGVjdCBtZXRhZGF0YQogICAgICAgIG1ldGFkYXRhID0gY29sbGVjdF9tYWNvc19tZXRhZGF0YSgpCiAgICAgICAgaWYgbWV0YWRhdGEgaXMgTm9uZToKICAgICAgICAgICAgcmFpc2UgRXhjZXB0aW9uKCJGYWlsZWQgdG8gY29sbGVjdCBtZXRhZGF0YSIpCgogICAgICAgICMgU2F2ZSBtZXRhZGF0YSB0byBmaWxlIGZvciBkZWJ1Z2dpbmcKICAgICAgICBvdXRwdXRfZmlsZSA9IG9zLnBhdGguam9pbihmaWxlc0RpciwgIm1hY29zX21ldGFkYXRhLmpzb24iKQogICAgICAgIHdpdGggb3BlbihvdXRwdXRfZmlsZSwgInciKSBhcyBmOgogICAgICAgICAgICBqc29uLmR1bXAobWV0YWRhdGEsIGYsIGluZGVudD00KQogICAgICAgIGxvZ2dlci5pbmZvKGYiTWV0YWRhdGEgc2F2ZWQgdG8ge291dHB1dF9maWxlfSIpCgogICAgICAgICMgU2VuZCBtZXRhZGF0YSB1c2luZyB0aGUgY29ycmVjdCBBUEkgZW5kcG9pbnQKICAgICAgICBpZiBzZW5kX21ldGFkYXRhX3RvX3NlcnZlcihkZXZpY2VVdWlkLCBob3N0LCBtZXRhZGF0YSk6CiAgICAgICAgICAgIGxvZ2dlci5pbmZvKCJNYWNPUyBtZXRhZGF0YSBjb2xsZWN0aW9uIGFuZCB1cGxvYWQgY29tcGxldGVkIHN1Y2Nlc3NmdWxseSIpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgbG9nZ2VyLmVycm9yKCJGYWlsZWQgdG8gdXBsb2FkIG1ldGFkYXRhIHRvIHNlcnZlciIpCgogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIGxvZ2dlci5lcnJvcihmIkZhaWxlZCB0byBjb2xsZWN0IE1hY09TIG1ldGFkYXRhOiB7ZX0iKQogICAgICAgIHN5cy5leGl0KDEpCgppZiBfX25hbWVfXyA9PSAiX19tYWluX18iOgogICAgbWFpbigp"}, "resigned_at": 1761308227}