{"settings": {"snippetUuid": "5b193a4a-0af6-493e-a16c-8228d0ab2579", "snippetname": "eventLogAudit", "snippettype": ".py", "created_at": 1761217163}, "payload": {"payloadsig": "s696kRMJCGBB5CcN/VlRGe+P36ZdGTDXVQlKpGw9QInMKcYbr7HFNSSm+0RqycFErvS4IA1vwMLh52P1a2+Wwammo/zEWWL3ijqpe91x1TQjgnPFUwCUKSDwHy9P6oLdoaZQ31+v1bYpvLfkz3byBI/b7bJljD7NlUHU2QufQEhdA7bMjRByuOMVYyiKTpfn0SNHIhsW7zwUvEyb2PBSNMWBpMZg5ugyq2LWZH3awVNLh7xPWtyHRTSlPLKRNfWqqoegU/snhEaAne+EF5ljNVZ9txK5MW6JLks8orBQeFdC28tmCYwP2CL3IB+gF4p62DBIV0dEU48Q/WGFtYOLmX5zvY1n8vBg8ubEepdQeSdAtqc2HVpohIpsga3P8Hg/lVqNS1C6JefXIbANhy0D9ztVEicl5gi1XJmPcWQ/aBFtvmuxjhoCftTE+9BFn8qO8/Qhma/elkLu7MhQq3BP4vrfa7jUk+zgByW5nyz2EYliFQx9kzwYknX0BWhT+Fx6+sqVXoA1/A4z9GqxTt+4g7QvJ5PtNtpDSr2c4r3fkcI60GtVDp1o/RHavUyDjR0WnFmVmIXZVqaG8E8Vlb048LbMqNAYFjaMSgo09tB4RNGcrUnkT15wGxZJBIP/Rrm3gIqpQfq9RFYvSnq/1hlAZIndaM+PhttI4Mmr4nS+HJs=", "payloadb64": "IyBGaWxlcGF0aDogc25pcHBldHMvdW5TaWduZWQvZXZlbnRMb2dBdWRpdC5weQojIEZpbGVwYXRoOiBzbmlwcGV0cy91blNpZ25lZC9ldmVudExvZy1hdWRpdC5weQppbXBvcnQgcGxhdGZvcm0KZnJvbSBsb2d6ZXJvIGltcG9ydCBsb2dnZXIsIGxvZ2ZpbGUKaW1wb3J0IGRhdGV0aW1lCmltcG9ydCBvcwppbXBvcnQganNvbgppbXBvcnQgemlwZmlsZQppbXBvcnQgcmVxdWVzdHMKaW1wb3J0IHRpbWUKaW1wb3J0IHN5cwppbXBvcnQgc3VicHJvY2VzcwoKIyBXaW5kb3dzLXNwZWNpZmljIGltcG9ydHMgKG9ubHkgYXZhaWxhYmxlIG9uIFdpbmRvd3MpCmlmIHBsYXRmb3JtLnN5c3RlbSgpID09ICdXaW5kb3dzJzoKICAgIGltcG9ydCB3aW4zMmV2dGxvZwogICAgaW1wb3J0IHdpbjMyZXZ0bG9ndXRpbAoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIEZVTkNUSU9OUyAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCmRlZiByZWFkTG9nKGxvZyk6CiAgICAjIFJlYWQgV2luZG93cyBldmVudCBsb2dzIHN0YXJ0aW5nIGZyb20gdGhlIGxhc3QgcHJvY2Vzc2VkIHJlY29yZCBudW1iZXIKICAgIGxvZ2dlci5pbmZvKGYnUmVhZGluZyB7bG9nfSBldmVudCBsb2cgZnJvbSByZWNvcmROdW1iZXIge2xhdGVzdEV2ZW50fS4uLicpCiAgICBvYmplY3RMaXN0IAk9IFtdCiAgICBoCQkJPSB3aW4zMmV2dGxvZy5PcGVuRXZlbnRMb2coTm9uZSwgbG9nKQogICAgbG9nZ2VyLmRlYnVnKGYnVG90YWwgbnVtYmVyIG9mIHJlY29yZHMgaW4ge2xvZ30gbG9nOiB7d2luMzJldnRsb2cuR2V0TnVtYmVyT2ZFdmVudExvZ1JlY29yZHMoaCl9JykKICAgIHdoaWxlIFRydWU6CiAgICAgICAgIyBSZWFkIGV2ZW50cyBpbiByZXZlcnNlIGNocm9ub2xvZ2ljYWwgb3JkZXIKICAgICAgICBvYmplY3RzIAk9IHdpbjMyZXZ0bG9nLlJlYWRFdmVudExvZyhoLCB3aW4zMmV2dGxvZy5FVkVOVExPR19CQUNLV0FSRFNfUkVBRHx3aW4zMmV2dGxvZy5FVkVOVExPR19TRVFVRU5USUFMX1JFQUQsIDApCiAgICAgICAgaWYgbm90IG9iamVjdHM6CiAgICAgICAgICAgIGxvZ2dlci5pbmZvKCdFbmQgb2YgZXZlbnRzLi4uJykKICAgICAgICAgICAgYnJlYWsKICAgICAgICBmb3Igb2JqZWN0IGluIG9iamVjdHM6CQogICAgICAgICAgICAjIE9ubHkgaW5jbHVkZSBldmVudHMgdGhhdCB3ZSBoYXZlbid0IHByb2Nlc3NlZCB5ZXQKICAgICAgICAgICAgaWYgb2JqZWN0LlJlY29yZE51bWJlciA+IGxhdGVzdEV2ZW50OgogICAgICAgICAgICAgICAgb2JqZWN0TGlzdC5hcHBlbmQob2JqZWN0KQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcGFzcwogICAgcmV0dXJuKG9iamVjdExpc3QpCgpkZWYgZ2V0RGF0ZUZvcm1hdChkYXRlU3RyaW5nKToKICAgICMgQ29udmVydCBkaWZmZXJlbnQgZGF0ZSBmb3JtYXRzIHRvIGRhdGV0aW1lIG9iamVjdHMKICAgIGlmICgnLScgaW4gZGF0ZVN0cmluZykgYW5kICgnKycgaW4gZGF0ZVN0cmluZyk6CiAgICAgICAgIyBJU08gZm9ybWF0IHdpdGggdGltZXpvbmUKICAgICAgICBldmVudFRpbWUgPSBkYXRldGltZS5kYXRldGltZS5mcm9taXNvZm9ybWF0KGRhdGVTdHJpbmcpCiAgICBlbHNlOgogICAgICAgICMgU3RhbmRhcmQgc3lzbG9nIGZvcm1hdCAobm8geWVhcikKICAgICAgICBldmVudFRpbWUgPSBkYXRldGltZS5kYXRldGltZS5zdHJwdGltZShkYXRlU3RyaW5nLCAiJWIgJWQgJUg6JU06JVMiKQogICAgICAgICMgQWRkIGN1cnJlbnQgeWVhciBhcyBpdCdzIG5vdCBpbiB0aGUgbG9nIGVudHJ5CiAgICAgICAgZXZlbnRUaW1lID0gZXZlbnRUaW1lLnJlcGxhY2UoeWVhcj1kYXRldGltZS5kYXRldGltZS5ub3coKS55ZWFyKQogICAgcmV0dXJuKGV2ZW50VGltZSkJCgpkZWYgZ2V0RXZlbnRWYWx1ZVRvU3RyaW5nKGV2ZW50VmFsdWUpOgogICAgIyBDb252ZXJ0IFdpbmRvd3MgZXZlbnQgbnVtZXJpYyB0eXBlcyB0byBodW1hbiByZWFkYWJsZSBzdHJpbmdzCiAgICBpZiBldmVudFZhbHVlID09IDA6CiAgICAgICAgcmV0dXJuKCdTVUNDRVNTJykKICAgIGVsaWYgZXZlbnRWYWx1ZSA9PSAxOgogICAgICAgIHJldHVybignRVJST1InKQogICAgZWxpZiBldmVudFZhbHVlID09IDI6CiAgICAgICAgcmV0dXJuKCdXQVJOSU5HJykKICAgIGVsaWYgZXZlbnRWYWx1ZSA9PSA0OgogICAgICAgIHJldHVybignSU5GT1JNQVRJT04nKQogICAgZWxpZiBldmVudFZhbHVlID09IDg6CiAgICAgICAgcmV0dXJuKCdBVURJVCBTVUNDRVNTJykKICAgIGVsc2U6CiAgICAgICAgbG9nZ2VyLmluZm8oZidPVEhFUjoge2V2ZW50VmFsdWV9JykKICAgICAgICByZXR1cm4oZidPVEhFUicpCgpkZWYgZml4RXZlbnRJZChiYWRJZCk6CiAgICAjIEZpeCBuZWdhdGl2ZSBldmVudCBJRHMgd2hpY2ggY2FuIG9jY3VyIGluIFdpbmRvd3MgZXZlbnQgbG9ncwogICAgaWYgYmFkSWQgPCAwOgogICAgICAgIGJhZElkICs9IDIqKjE2CiAgICBmaXhlZEV2ZW50SWQgPSBiYWRJZCAmIDB4RkZGRgogICAgcmV0dXJuIChmaXhlZEV2ZW50SWQpCQoKZGVmIHByb2Nlc3NFdmVudHMobG9nLCBvYmplY3RMaXN0LCBldmVudERpY3QpOgogICAgIyBQcm9jZXNzIGFuZCBmaWx0ZXIgV2luZG93cyBldmVudCBsb2cgb2JqZWN0cwogICAgbm93IAkJCQk9IGRhdGV0aW1lLmRhdGV0aW1lLm5vdygpCiAgICB0aGlydHlEYXlzQWdvCQk9IG5vdyAtIGRhdGV0aW1lLnRpbWVkZWx0YShkYXlzPTMwKQogICAgZm9yIG9iamVjdCBpbiBvYmplY3RMaXN0OgogICAgICAgICMgU2tpcCBldmVudHMgb2xkZXIgdGhhbiAzMCBkYXlzCiAgICAgICAgaWYgb2JqZWN0LlRpbWVHZW5lcmF0ZWQgPCB0aGlydHlEYXlzQWdvOgogICAgICAgICAgICBsb2dnZXIuZGVidWcoZidTa2lwcGluZzoge29iamVjdC5SZWNvcmROdW1iZXJ9IHwge29iamVjdC5UaW1lR2VuZXJhdGVkfScpCiAgICAgICAgICAgIGJyZWFrCiAgICAgICAgZWxzZToKICAgICAgICAgICAgIyBDcmVhdGUgc3RhbmRhcmRpemVkIGV2ZW50IGRpY3Rpb25hcnkgZW50cmllcwogICAgICAgICAgICBldmVudERpY3Rbb2JqZWN0LlJlY29yZE51bWJlcl0gPSB7CiAgICAgICAgICAgICAgICAndGltZWdlbmVyYXRlZCc6IG9iamVjdC5UaW1lR2VuZXJhdGVkLnN0cmZ0aW1lKCIlWS0lbS0lZC0lSDolTTolUyIpLCAKICAgICAgICAgICAgICAgICdzb3VyY2VuYW1lJzogb2JqZWN0LlNvdXJjZU5hbWUsIAogICAgICAgICAgICAgICAgJ2V2ZW50aWQnOiBmaXhFdmVudElkKG9iamVjdC5FdmVudElEKSwKICAgICAgICAgICAgICAgICdldmVudHR5cGUnOiBnZXRFdmVudFZhbHVlVG9TdHJpbmcob2JqZWN0LkV2ZW50VHlwZSksCiAgICAgICAgICAgICAgICAnbWVzc2FnZSc6IHdpbjMyZXZ0bG9ndXRpbC5TYWZlRm9ybWF0TWVzc2FnZShvYmplY3QsIGxvZykKICAgICAgICAgICAgfQogICAgcmV0dXJuKGV2ZW50RGljdCkKCmRlZiByZWFkRXhpc3RpbmdMb2dKc29uKGxvZyk6CiAgICAjIFJlYWQgcHJldmlvdXNseSBwcm9jZXNzZWQgZXZlbnRzIGZyb20gSlNPTiBmaWxlIG9yIGNyZWF0ZSBuZXcgZGljdCBpZiBmaWxlIGRvZXNuJ3QgZXhpc3QKICAgIGV2ZW50RGljdEZpbGUgPSBmJ3tmaWxlc0Rpcn1ldmVudHMte2xvZ30uanNvbicKICAgIGxvZ2dlci5pbmZvKGYnQ2hlY2tpbmcgdG8gc2VlIGlmIHtldmVudERpY3RGaWxlfSBleGlzdHMuLi4nKQogICAgaWYgb3MucGF0aC5pc2ZpbGUoZXZlbnREaWN0RmlsZSk6CiAgICAgICAgbG9nZ2VyLmluZm8oZid7ZXZlbnREaWN0RmlsZX0gZXhpc3RzLiBSZWFkaW5nIGRhdGEuLi4nKQogICAgICAgIHdpdGggb3BlbihldmVudERpY3RGaWxlLCAncicpIGFzIGY6CiAgICAgICAgICAgIGV2ZW50RGljdCA9IGpzb24ubG9hZChmKQogICAgICAgIGxvZ2dlci5pbmZvKGYnZXZlbnREaWN0IHJlYWQgZnJvbSBmaWxlLicpCiAgICBlbHNlOgogICAgICAgIGxvZ2dlci5pbmZvKGYne2V2ZW50RGljdEZpbGV9IGRvZXMgbm90IGV4aXN0LiBDcmVhdGluZyBlbXB0eSBldmVudERpY3QuLi4nKQogICAgICAgIGV2ZW50RGljdCA9IHt9CiAgICByZXR1cm4oZXZlbnREaWN0KQoKZGVmIHdyaXRlTG9nSnNvbihldmVudERpY3QsIGxvZyk6CiAgICAjIFNhdmUgcHJvY2Vzc2VkIGV2ZW50cyB0byBKU09OIGZpbGUKICAgIGV2ZW50RGljdEZpbGUgPSBmJ3tmaWxlc0Rpcn1ldmVudHMte2xvZ30uanNvbicKICAgIHdpdGggb3BlbihldmVudERpY3RGaWxlLCAndycpIGFzIGY6CiAgICAgICAgZi53cml0ZShqc29uLmR1bXBzKGV2ZW50RGljdCwgaW5kZW50PTQpKQoKZGVmIHdyaXRlUmVjb3JkU3RhcnRQb2ludChsb2cpOgogICAgIyBSZWNvcmQgdGhlIGxhdGVzdCBldmVudCBudW1iZXIgdG8gc3RhcnQgZnJvbSBpbiBuZXh0IGV4ZWN1dGlvbgogICAgbGF0ZXN0RXZ0RmlsZQkJPSBmJ3tjb25maWdEaXJ9bGF0ZXN0RXZ0LXtsb2d9LnR4dCcKICAgIG9iamVjdExpc3QgCQkJPSBbXQogICAgaAkJCQkJPSB3aW4zMmV2dGxvZy5PcGVuRXZlbnRMb2coTm9uZSwgbG9nKQogICAgbG9nZ2VyLmRlYnVnKGYnbnVtYmVyIG9mIHJlY29yZHM6IHt3aW4zMmV2dGxvZy5HZXROdW1iZXJPZkV2ZW50TG9nUmVjb3JkcyhoKX0nKQogICAgd2hpbGUgVHJ1ZToKICAgICAgICBvYmplY3RzIAk9IHdpbjMyZXZ0bG9nLlJlYWRFdmVudExvZyhoLCB3aW4zMmV2dGxvZy5FVkVOVExPR19CQUNLV0FSRFNfUkVBRHx3aW4zMmV2dGxvZy5FVkVOVExPR19TRVFVRU5USUFMX1JFQUQsIDApCiAgICAgICAgaWYgbm90IG9iamVjdHM6CiAgICAgICAgICAgIGJyZWFrCiAgICAgICAgZm9yIG9iamVjdCBpbiBvYmplY3RzOgogICAgICAgICAgICBvYmplY3RMaXN0LmFwcGVuZChvYmplY3QpCiAgICBsYXRlc3RFdmVudCA9IG9iamVjdExpc3RbMF0uUmVjb3JkTnVtYmVyCiAgICBsb2dnZXIuaW5mbyhmJ05ldyBsYXRlc3QgRXZlbnQ6IHtsYXRlc3RFdmVudH0nKQogICAgd2l0aCBvcGVuKGxhdGVzdEV2dEZpbGUsICd3JykgYXMgZjoKICAgICAgICBmLndyaXRlKGYne2xhdGVzdEV2ZW50fScpCiAgICByZXR1cm4obGF0ZXN0RXZlbnQpCgpkZWYgZ2V0TGF0ZXN0RXZlbnQobGF0ZXN0RXZ0RmlsZSk6CiAgICAjIEdldCB0aGUgbGF0ZXN0IHByb2Nlc3NlZCBldmVudCBudW1iZXIgZnJvbSB0cmFja2luZyBmaWxlCiAgICBsb2dnZXIuZGVidWcoZidHZXR0aW5nIGxhdGVzdCBldmVudCBmcm9tIHtsYXRlc3RFdnRGaWxlfS4uLicpCiAgICBpZiBub3Qgb3MucGF0aC5pc2ZpbGUobGF0ZXN0RXZ0RmlsZSk6CiAgICAgICAgbG9nZ2VyLmluZm8oZidsYXRlc3RFdnRGaWxlOiB7bGF0ZXN0RXZ0RmlsZX0gZG9lcyBub3QgZXhpc3QuIFNldHRpbmcgbmV3IHN0YXJ0IHBvaW50LicpCiAgICAgICAgbGF0ZXN0RXZlbnQgPSAwCiAgICBlbHNlOgogICAgICAgIHdpdGggb3BlbihsYXRlc3RFdnRGaWxlLCAncicpIGFzIGY6CiAgICAgICAgICAgIGxhdGVzdEV2ZW50ID0gZi5yZWFkbGluZSgpCiAgICBsb2dnZXIuaW5mbyhmJ1ByZXZpb3VzIGxhdGVzdEV2ZW50OiB7bGF0ZXN0RXZlbnR9JykJCiAgICByZXR1cm4oaW50KGxhdGVzdEV2ZW50KSkKCmRlZiB3cml0ZUxhdGVzdEV2ZW50KGxhdGVzdEV2ZW50LCBsb2csIG9iamVjdExpc3QpOgogICAgIyBVcGRhdGUgdGhlIGxhdGVzdCBldmVudCB0cmFja2luZyBmaWxlIHdpdGggbmV3ZXN0IGV2ZW50IG51bWJlcgogICAgbGF0ZXN0RXZ0RmlsZQkJPSBmJ3tjb25maWdEaXJ9bGF0ZXN0RXZ0LXtsb2d9LnR4dCcKICAgIGxvZ2dlci5kZWJ1ZyhmJ1dyaXRpbmcgbGF0ZXN0IGV2ZW50IHRvIHtsYXRlc3RFdnRGaWxlfS4uLicpCiAgICBpZiBsZW4ob2JqZWN0TGlzdCkgPiAwOgogICAgICAgIGxhdGVzdEV2ZW50ID0gb2JqZWN0TGlzdFswXS5SZWNvcmROdW1iZXIKICAgICAgICBsb2dnZXIuaW5mbyhmJ05ldyBsYXRlc3QgRXZlbnQ6IHtsYXRlc3RFdmVudH0nKQogICAgICAgIHdpdGggb3BlbihsYXRlc3RFdnRGaWxlLCAndycpIGFzIGY6CiAgICAgICAgICAgIGYud3JpdGUoZid7bGF0ZXN0RXZlbnR9JykKICAgIGVsc2U6CiAgICAgICAgbG9nZ2VyLmluZm8oJ05vIG5ldyBldmVudHMuJykKICAgICAgICBsb2dnZXIuaW5mbyhmJ05ldyBsYXRlc3QgRXZlbnQ6IHtsYXRlc3RFdmVudH0gKE5vIGNoYW5nZSknKQkKCmRlZiBzZW5kUGF5bG9hZEZsYXNrKHJvdXRlLCBvdXRaaXBGaWxlLCBkZXZpY2VVdWlkKToKICAgICMgU2VuZCB6aXBwZWQgbG9nIGRhdGEgdG8gc2VydmVyIHVzaW5nIEhUVFAgUE9TVAogICAgcGF5bG9hZE5hbWUgCT0gb3MucGF0aC5iYXNlbmFtZShvdXRaaXBGaWxlKQogICAgdXJsIAkJCT0gZidodHRwczovL3tob3N0fXtyb3V0ZX0nCiAgICBsb2dnZXIuaW5mbyhmJ1JlcXVlc3QgdG8gc2VuZCB7b3V0WmlwRmlsZX0gfCBwYXlsb2FkTmFtZToge3BheWxvYWROYW1lfScpCiAgICBsb2dnZXIuaW5mbyhmJ0F0dGVtcHRpbmcgdG8gY29ubmVjdCB0byB7dXJsfScpCiAgICB3aXRoIG9wZW4ob3V0WmlwRmlsZSwgJ3JiJykgYXMgZjoKICAgICAgICBmaWxlcyA9IHsnZmlsZSc6IChwYXlsb2FkTmFtZSwgZil9CiAgICAgICAgaGVhZGVycyA9IHsnZGV2aWNldXVpZCc6IGRldmljZVV1aWR9CiAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5wb3N0KHVybCwgZmlsZXM9ZmlsZXMsIGhlYWRlcnM9aGVhZGVycykKICAgICAgICBpZiByZXNwb25zZS5zdGF0dXNfY29kZSA9PSAyMDA6CiAgICAgICAgICAgIGxvZ2dlci5pbmZvKGYnc3RhdHVzX2NvZGU6IHtyZXNwb25zZS5zdGF0dXNfY29kZX0nKQogICAgICAgICAgICByZXR1cm4oVHJ1ZSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBsb2dnZXIuZXJyb3IoZidzdGF0dXNfY29kZToge3Jlc3BvbnNlLnN0YXR1c19jb2RlfS4gUmVhc29uOiB7cmVzcG9uc2UudGV4dH0nKQogICAgICAgICAgICByZXR1cm4oRmFsc2UpCgpkZWYgaXNKb3VybmFsVXNlZCgpOgogICAgIyBEZXRlcm1pbmUgaWYgdGhlIHN5c3RlbSB1c2VzIHN5c3RlbWQgam91cm5hbCBvciB0cmFkaXRpb25hbCBsb2cgZmlsZXMKICAgIGxpbnV4TG9nc0xpc3QgPSBbJ2F1dGgnLCAna2VybicsICdzeXNsb2cnXQogICAgam91cm5hbFVzZWQgPSBUcnVlCiAgICBmb3IgbGludXhMb2cgaW4gbGludXhMb2dzTGlzdDoKICAgICAgICBpZiBsaW51eExvZyA9PSAnc3lzbG9nJzoKICAgICAgICAgICAgbGludXhMb2dGaWxlIAk9IGYnL3Zhci9sb2cve2xpbnV4TG9nfScKICAgICAgICBlbHNlOgogICAgICAgICAgICBsaW51eExvZ0ZpbGUgCQk9IGYnL3Zhci9sb2cve2xpbnV4TG9nfS5sb2cnCQogICAgICAgIGlmIG9zLnBhdGguaXNmaWxlKGxpbnV4TG9nKToKICAgICAgICAgICAgam91cm5hbFVzZWQgPSBGYWxzZQogICAgcmV0dXJuKGpvdXJuYWxVc2VkKQoKZGVmIGZvcm1hdEpvdXJuYWxEYXRlKGpvdXJuYWxEYXRlKToKICAgICMgRm9ybWF0IGpvdXJuYWwgZGF0ZXMgY29uc2lzdGVudGx5IGFuZCBoYW5kbGUgeWVhciB0cmFuc2l0aW9ucwogICAgZGF0ZU9iaiA9IGRhdGV0aW1lLmRhdGV0aW1lLnN0cnB0aW1lKGpvdXJuYWxEYXRlLCAiJVktJW0tJWQgJUg6JU06JVMiKQogICAgbm93IAk9IGRhdGV0aW1lLmRhdGV0aW1lLm5vdygpCiAgICAjIEhhbmRsZSB5ZWFyIHRyYW5zaXRpb24gZm9yIGRhdGVzIHRoYXQgYXBwZWFyIHRvIGJlIGluIHRoZSBmdXR1cmUKICAgIGlmIGRhdGVPYmoubW9udGggPiBub3cubW9udGg6CiAgICAgICAgeWVhciA9IG5vdy55ZWFyIC0gMSAgIyBqb3VybmFsRGF0ZSBpcyBmcm9tIHRoZSBwcmV2aW91cyB5ZWFyCiAgICBlbHNlOgogICAgICAgIHllYXIgPSBub3cueWVhciAgIyBqb3VybmFsRGF0ZSBpcyBmcm9tIHRoZSBjdXJyZW50IHllYXIKICAgIGpvdXJuYWxEYXRlU3RkID0gZGF0ZU9iai5yZXBsYWNlKHllYXI9eWVhcikuc3RyZnRpbWUoIiVZLSVtLSVkICVIOiVNOiVTIikKICAgIHJldHVybihqb3VybmFsRGF0ZVN0ZCkKCmRlZiB3cml0ZUxhc3RKb3VybmFsKGxhc3RKb3VybmFsRXBvY2gpOgogICAgIyBTYXZlIHRoZSB0aW1lc3RhbXAgb2YgdGhlIGxhc3Qgam91cm5hbCBlbnRyeSBwcm9jZXNzZWQKICAgIGxhc3RKb3VybmFsRXBvY2hGaWxlID0gb3MucGF0aC5qb2luKGNvbmZpZ0RpciwgJ2xhdGVzdEpvdXJuYWwudHh0JykKICAgIGxvZ2dlci5pbmZvKGYnV3JpdGluZyB7bGFzdEpvdXJuYWxFcG9jaH0gdG8ge2xhc3RKb3VybmFsRXBvY2hGaWxlfScpCiAgICB3aXRoIG9wZW4obGFzdEpvdXJuYWxFcG9jaEZpbGUsICd3JykgYXMgZjoKICAgICAgICBmLndyaXRlKGYne2xhc3RKb3VybmFsRXBvY2h9JykKCmRlZiBnZXRMYXN0Sm91cm5hbCgpOgogICAgIyBHZXQgdGhlIHRpbWVzdGFtcCBvZiB0aGUgbGFzdCBwcm9jZXNzZWQgam91cm5hbCBlbnRyeSBvciBkZWZhdWx0IHRvIDcgZGF5cyBhZ28KICAgIGxhc3RKb3VybmFsRXBvY2hGaWxlID0gb3MucGF0aC5qb2luKGNvbmZpZ0RpciwgJ2xhdGVzdEpvdXJuYWwudHh0JykKICAgIGlmIG9zLnBhdGguaXNmaWxlKGxhc3RKb3VybmFsRXBvY2hGaWxlKToKICAgICAgICBsb2dnZXIuZGVidWcoZid7bGFzdEpvdXJuYWxFcG9jaEZpbGV9IGV4aXN0cy4uLicpCiAgICAgICAgd2l0aCBvcGVuKGxhc3RKb3VybmFsRXBvY2hGaWxlLCAncicpIGFzIGY6CiAgICAgICAgICAgIGpvdXJuYWxTaW5jZSA9IGYucmVhZCgpCiAgICAgICAgbG9nZ2VyLmRlYnVnKGYnam91cm5hbFNpbmNlOiB7am91cm5hbFNpbmNlfScpCiAgICBlbHNlOgogICAgICAgICMgRGVmYXVsdCB0byA3IGRheXMgYWdvIGlmIG5vIHJlY29yZCBleGlzdHMKICAgICAgICBqb3VybmFsU2luY2UgPSBpbnQodGltZS50aW1lKCkgLSAoNjAgKiA2MCAqIDI0ICogNykpCiAgICByZXR1cm4oam91cm5hbFNpbmNlKQoKZGVmIHByb2Nlc3NMaW51eEpvdXJuYWwoZGF5cyk6CiAgICAjIFByb2Nlc3MgTGludXggc3lzdGVtZCBqb3VybmFsIGxvZ3MKICAgIGxpbnV4TG9nCQkJPSAnam91cm5hbCcKICAgIGxpbnV4bG9nRGljdCAJCT0ge30KICAgIHN0YXJ0RGF0ZQkJCT0gZ2V0TGFzdEpvdXJuYWwoKQogICAgbGFzdEpvdXJuYWxFcG9jaAk9IGludCh0aW1lLnRpbWUoKSkKICAgIAogICAgIyBVc2Ugam91cm5hbGN0bCB0byBnZXQgbG9ncyBzaW5jZSBsYXN0IHByb2Nlc3NlZCB0aW1lc3RhbXAKICAgIGNvbW1hbmQgCQkJPSBbImpvdXJuYWxjdGwiLCAiLS1zaW5jZSIsIGYnQHtzdGFydERhdGV9JywgJy0tbm8tcGFnZXInXQogICAgcHJvY2VzcyAJCQk9IHN1YnByb2Nlc3MuUG9wZW4oY29tbWFuZCwgc3Rkb3V0PXN1YnByb2Nlc3MuUElQRSwgc3RkZXJyPXN1YnByb2Nlc3MuUElQRSwgdGV4dD1UcnVlKQogICAgb3V0cHV0LCBcCiAgICAgICAgZXJyb3IgCQkJPSBwcm9jZXNzLmNvbW11bmljYXRlKCkKICAgIGlmIHByb2Nlc3MucmV0dXJuY29kZSAhPSAwOgogICAgICAgIGxvZ2dlci5lcnJvcihmIkVycm9yIHJ1bm5pbmcgam91cm5hbGN0bDoge2Vycm9yfSIpCiAgICAgICAgcmV0dXJuIFtdCiAgICBlbHNlOgogICAgICAgIGxvZ2dlci5pbmZvKGYnUHJvY2Vzc2luZzogam91cm5hbC4uLicpCiAgICAKICAgICMgUGFyc2Ugam91cm5hbCBlbnRyaWVzCiAgICBpID0gMAogICAgZm9yIGxpbmUgaW4gb3V0cHV0LnNwbGl0bGluZXMoKToKICAgICAgICBsaW51eGxvZ0RpY3RbaV0gPSB7fQogICAgICAgIGlmIG5vdCBsaW5lWzBdLmlzYWxwaGEoKToKICAgICAgICAgICAgcGFzcwogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHBhcnRzIAkJCT0gbGluZS5zcGxpdCgnICcpCiAgICAgICAgICAgIGpvdXJuYWxEYXRlIAk9IGRhdGV0aW1lLmRhdGV0aW1lLnN0cnB0aW1lKGYne3BhcnRzWzBdfSB7cGFydHNbMV19IHtwYXJ0c1syXX0nLCAiJWIgJWQgJUg6JU06JVMiKQogICAgICAgICAgICBqb3VybmFsRGF0ZVN0ZAk9IGZvcm1hdEpvdXJuYWxEYXRlKHN0cihqb3VybmFsRGF0ZSkpCiAgICAgICAgICAgIHByb2Nlc3MgCT0gcGFydHNbNF0uc3BsaXQoJzonKVswXQogICAgICAgICAgICBtZXNzYWdlIAk9ICcgJy5qb2luKHBhcnRzWzU6XSkuc3RyaXAoKQogICAgICAgICAgICBsaW51eGxvZ0RpY3RbaV1bJ3RpbWVnZW5lcmF0ZWQnXSAJPSBqb3VybmFsRGF0ZVN0ZAogICAgICAgICAgICBsaW51eGxvZ0RpY3RbaV1bJ3NvdXJjZW5hbWUnXSAJCT0gcHJvY2VzcwogICAgICAgICAgICBsaW51eGxvZ0RpY3RbaV1bJ21lc3NhZ2UnXSAJCQk9IG1lc3NhZ2UKICAgICAgICAgICAgaSArPSAxCiAgICAKICAgICMgU2F2ZSBqb3VybmFsIHRvIEpTT04sIGNvbXByZXNzIGFuZCB1cGxvYWQKICAgIGxpbnV4TG9nSnNvbkZpbGUJPSBvcy5wYXRoLmpvaW4oZmlsZXNEaXIsIGYne2xpbnV4TG9nfS5qc29uJykKICAgIHdpdGggb3BlbihsaW51eExvZ0pzb25GaWxlLCAndycpIGFzIGY6CiAgICAgICAgZi53cml0ZShqc29uLmR1bXBzKGxpbnV4bG9nRGljdCwgaW5kZW50PTQsIGRlZmF1bHQ9c3RyKSkKICAgIG91dFppcEZpbGUgCQkJPSB6aXBGaWxlKGYne2xpbnV4TG9nfS5qc29uJykKICAgIHVwbG9hZFN1Y2Nlc3MgCQk9IHNlbmRQYXlsb2FkRmxhc2socm91dGUsIG91dFppcEZpbGUsIGRldmljZVV1aWQpCiAgICBpZiB1cGxvYWRTdWNjZXNzID09IFRydWU6CiAgICAgICAgd3JpdGVMYXN0Sm91cm5hbChsYXN0Sm91cm5hbEVwb2NoKQogICAgICAgIGRlbEZpbGUob3V0WmlwRmlsZSkKICAgIGVsc2U6CiAgICAgICAgbG9nZ2VyLmVycm9yKGYnVXBsb2FkIGZhaWxlZC4nKQogICAgCiAgICAjIENyZWF0ZSBmaWx0ZXJlZCB2ZXJzaW9uIHdpdGggdG9wIGV2ZW50cwogICAgZmlsdGVyZWRsaW51eGxvZ0RpY3QgCT0gZmlsdGVyTGludXhMb2cobGludXhMb2cpCiAgICBldmVudHMgCQkJCQk9IGZpbHRlcmVkbGludXhsb2dEaWN0WyJTb3VyY2VzIl1bIlRvcEV2ZW50cyJdCiAgICB0b3RhbENvdW50IAkJCQk9IHN1bShldmVudFsiQ291bnQiXSBmb3IgZXZlbnQgaW4gZXZlbnRzKQogICAgZmlsdGVyZWRsaW51eGxvZ0RpY3RbJ1NvdXJjZXMnXVsnVG90YWxFdmVudHMnXSA9IHRvdGFsQ291bnQKICAgIGxvZ2dlci5kZWJ1Zyhqc29uLmR1bXBzKGZpbHRlcmVkbGludXhsb2dEaWN0LCBpbmRlbnQ9NCkpCiAgICB3aXRoIG9wZW4ob3MucGF0aC5qb2luKGZpbGVzRGlyLCBmJ3tsaW51eExvZ31GaWx0ZXJlZC5qc29uJyksICd3JykgYXMgZjoKICAgICAgICBmLndyaXRlKGpzb24uZHVtcHMoZmlsdGVyZWRsaW51eGxvZ0RpY3QsIGluZGVudD00KSkKICAgIHNlbmRMaW51eExvZ01ldGFkYXRhKGRldmljZVV1aWQsIGxpbnV4TG9nKQogICAgaWYgZGVidWdNb2RlID09IFRydWU6CiAgICAgICAgbG9nZ2VyLmRlYnVnKGYne2pzb24uZHVtcHMobGludXhsb2dEaWN0LCBpbmRlbnQ9NCl9JykJCgpkZWYgZmlsdGVyTGludXhMb2cobG9nVHlwZSk6CiAgICAjIENyZWF0ZSBzdW1tYXJ5IG9mIExpbnV4IGxvZ3MgYnkgZ3JvdXBpbmcgYW5kIGNvdW50aW5nIGV2ZW50cyBieSBzb3VyY2UKICAgIGdyb3VwZWREYXRhID0ge30KICAgIGpzb25GaWxlIAk9IG9zLnBhdGguam9pbihmaWxlc0RpciwgZid7bG9nVHlwZX0uanNvbicpCiAgICBsb2dnZXIuaW5mbyhmJ0ZpbHRlcmluZyB7anNvbkZpbGV9JykKICAgIGRhdGEgCQk9IHJlYWRFdmVudEpzb24oanNvbkZpbGUpCgogICAgIyBHcm91cCBldmVudHMgYnkgc291cmNlIG5hbWUKICAgIGZvciByZWNvcmRfaWQsIHJlY29yZCBpbiBkYXRhLml0ZW1zKCk6CiAgICAgICAgdGltZUdlbmVyYXRlZCAJPSAocmVjb3JkWyJ0aW1lZ2VuZXJhdGVkIl0pCiAgICAgICAgbWVzc2FnZSAJCT0gcmVjb3JkWyJtZXNzYWdlIl0KICAgICAgICBzb3VyY2VOYW1lIAkJPSByZWNvcmRbJ3NvdXJjZW5hbWUnXQoKICAgICAgICBpZiBzb3VyY2VOYW1lIG5vdCBpbiBncm91cGVkRGF0YToKICAgICAgICAgICAgZ3JvdXBlZERhdGFbc291cmNlTmFtZV0gPSB7CiAgICAgICAgICAgICAgICAiY291bnQiOiAwLAogICAgICAgICAgICAgICAgIm1lc3NhZ2UiOiBtZXNzYWdlLAogICAgICAgICAgICAgICAgIm1vc3RyZWNlbnR0aW1lIjogdGltZUdlbmVyYXRlZAogICAgICAgICAgICB9CiAgICAgICAgZ3JvdXBlZERhdGFbc291cmNlTmFtZV1bImNvdW50Il0gKz0gMQogICAgICAgIGlmIHRpbWVHZW5lcmF0ZWQgPiBncm91cGVkRGF0YVtzb3VyY2VOYW1lXVsibW9zdHJlY2VudHRpbWUiXToKICAgICAgICAgICAgZ3JvdXBlZERhdGFbc291cmNlTmFtZV1bIm1vc3RyZWNlbnR0aW1lIl0gPSB0aW1lR2VuZXJhdGVkCiAgICBlbHNlOgogICAgICAgIHBhc3MKICAgIAogICAgIyBTb3J0IGJ5IGNvdW50IGFuZCBnZXQgdG9wIDEwIGV2ZW50cwogICAgIyBMSU1JVEFUSU9OOiBDaGFuZ2UgdGhlIHZhbHVlIDEwIGJlbG93IHRvIGluY3JlYXNlIHRoZSBudW1iZXIgb2YgdG9wIGV2ZW50cyBjb2xsZWN0ZWQKICAgIHNvcnRlZEdyb3VwZWREYXRhID0gc29ydGVkKGdyb3VwZWREYXRhLml0ZW1zKCksIGtleT1sYW1iZGEgeDogeFsxXVsiY291bnQiXSwgcmV2ZXJzZT1UcnVlKVs6NTBdCgogICAgdG9wRXZlbnRzID0gW10KICAgIGZvciBzb3VyY2VOYW1lLCBkZXRhaWxzIGluIHNvcnRlZEdyb3VwZWREYXRhOgogICAgICAgIGN1cnJlbnRUb3BFdmVudCA9IHsKICAgICAgICAgICAgJ01lc3NhZ2UnOiBkZXRhaWxzWydtZXNzYWdlJ10sIAogICAgICAgICAgICAnU291cmNlTmFtZSc6IHNvdXJjZU5hbWUsCiAgICAgICAgICAgICdDb3VudCc6IGRldGFpbHNbJ2NvdW50J10sIAogICAgICAgICAgICAnTGF0ZXN0T2NjdXJyZW5jZSc6ZGV0YWlsc1snbW9zdHJlY2VudHRpbWUnXQogICAgICAgICAgICB9CiAgICAgICAgdG9wRXZlbnRzLmFwcGVuZChjdXJyZW50VG9wRXZlbnQpCgogICAgIyBDcmVhdGUgc3VtbWFyeSBzdHJ1Y3R1cmUKICAgIGZpbHRlcmVkU3lzbG9nRGljdAkJCQkJCQk9IHt9CiAgICBmaWx0ZXJlZFN5c2xvZ0RpY3RbJ0xvZ05hbWUnXSAJCQkJPSBsb2dUeXBlCiAgICBmaWx0ZXJlZFN5c2xvZ0RpY3RbJ1NvdXJjZXMnXSAJCQkJPSB7fQogICAgZmlsdGVyZWRTeXNsb2dEaWN0WydTb3VyY2VzJ11bJ1RvcEV2ZW50cyddIAk9IHRvcEV2ZW50cwogICAgIyBMSU1JVEFUSU9OOiBDaGFuZ2UgdGhlIHZhbHVlIDEwIGJlbG93IHRvIG1hdGNoIHRoZSBudW1iZXIgb2YgdG9wIGV2ZW50cyBjb2xsZWN0ZWQgYWJvdmUKICAgIGZpbHRlcmVkU3lzbG9nRGljdFsnU291cmNlcyddWydUb3RhbEV2ZW50cyddID0gNTAKICAgIGlmIGRlYnVnTW9kZSA9PSBUcnVlOgogICAgICAgIGxvZ2dlci5kZWJ1ZyhmJ2ZpbHRlcmVkU3lzbG9nRGljdDpcbntqc29uLmR1bXBzKGZpbHRlcmVkU3lzbG9nRGljdCwgaW5kZW50PTQpfScpCiAgICByZXR1cm4oZmlsdGVyZWRTeXNsb2dEaWN0KQoKZGVmIHByb2Nlc3NMaW51eExvZ3MoZGF5cyk6CiAgICAjIFByb2Nlc3MgdHJhZGl0aW9uYWwgTGludXggbG9nIGZpbGVzCiAgICBsaW51eExvZ3NMaXN0ID0gWydhdXRoJywgJ2tlcm4nLCAnc3lzbG9nJ10KICAgIGZvciBsaW51eExvZyBpbiBsaW51eExvZ3NMaXN0OgogICAgICAgIGlmIGxpbnV4TG9nID09ICdzeXNsb2cnOgogICAgICAgICAgICBsaW51eExvZ0ZpbGUgCT0gZicvdmFyL2xvZy97bGludXhMb2d9JwogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGxpbnV4TG9nRmlsZSAJCT0gZicvdmFyL2xvZy97bGludXhMb2d9LmxvZycKICAgICAgICBpZiBvcy5wYXRoLmlzZmlsZShsaW51eExvZ0ZpbGUpOgogICAgICAgICAgICAjIFByb2Nlc3MgZWFjaCBsb2cgZmlsZSBpZiBpdCBleGlzdHMKICAgICAgICAgICAgbG9nZ2VyLmluZm8oZidQcm9jZXNzaW5nOiB7bGludXhMb2dGaWxlfScpCiAgICAgICAgICAgIG5vdyAJCQkJPSBkYXRldGltZS5kYXRldGltZS5ub3coKQogICAgICAgICAgICB0aGlydHlEYXlzQWdvCQk9IG5vdyAtIGRhdGV0aW1lLnRpbWVkZWx0YShkYXlzPWRheXMpCiAgICAgICAgICAgIGxpbnV4bG9nRGljdCAJCT0ge30KICAgICAgICAgICAgd2l0aCBvcGVuKGxpbnV4TG9nRmlsZSwgJ3InLCBlbmNvZGluZz0ndXRmLTgnLCBlcnJvcnM9J2lnbm9yZScpIGFzIGY6CiAgICAgICAgICAgICAgICBpID0gMAogICAgICAgICAgICAgICAgZm9yIGxpbmUgaW4gZi5yZWFkbGluZXMoKToKICAgICAgICAgICAgICAgICAgICBsaW51eGxvZ0RpY3RbaV0gPSB7fQogICAgICAgICAgICAgICAgICAgIHBhcnRzID0gbGluZS5yZXBsYWNlKCcgICcsICcgJykuc3BsaXQoJyAnKQogICAgICAgICAgICAgICAgICAgICMgSGFuZGxlIGRpZmZlcmVudCBsb2cgZm9ybWF0IHN0eWxlcwogICAgICAgICAgICAgICAgICAgIGlmIGxlbihwYXJ0c1swXSkgPiAzOgogICAgICAgICAgICAgICAgICAgICAgICBldmVudFRpbWUgCT0gZ2V0RGF0ZUZvcm1hdChwYXJ0c1swXSkKICAgICAgICAgICAgICAgICAgICAgICAgaWYgZXZlbnRUaW1lIDwgdGhpcnR5RGF5c0FnbzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRldmljZU5hbWUgCT0gcGFydHNbMV0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2Nlc3MgCT0gcGFydHNbMl0uc3BsaXQoJ1snKVswXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZSAJPSAnICcuam9pbihwYXJ0c1szOl0pLnN0cmlwKCkKICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICBldmVudFRpbWUgCT0gZ2V0RGF0ZUZvcm1hdChmJ3twYXJ0c1swXX0ge3BhcnRzWzFdfSB7cGFydHNbMl19JykKICAgICAgICAgICAgICAgICAgICAgICAgaWYgZXZlbnRUaW1lIDwgdGhpcnR5RGF5c0FnbzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KGYndG9vIG9sZDoge2V2ZW50VGltZX0nKQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlOgkJCQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGV2aWNlTmFtZSAJPSBwYXJ0c1szXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvY2VzcyAJPSBwYXJ0c1s0XS5zcGxpdCgnWycpWzBdCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlIAk9ICcgJy5qb2luKHBhcnRzWzU6XSkuc3RyaXAoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGludXhsb2dEaWN0W2ldWyd0aW1lZ2VuZXJhdGVkJ10gCT0gZXZlbnRUaW1lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW51eGxvZ0RpY3RbaV1bJ3NvdXJjZW5hbWUnXSAJCT0gcHJvY2VzcwogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGludXhsb2dEaWN0W2ldWydtZXNzYWdlJ10gCQkJPSBtZXNzYWdlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpICs9IDEKICAgICAgICBlbHNlOgogICAgICAgICAgICBsb2dnZXIud2FybmluZyhmJ3tsaW51eExvZ0ZpbGV9IGRvZXMgbm90IGV4aXN0LiBTa2lwcGluZycpCiAgICAKICAgICMgU2F2ZSwgY29tcHJlc3MgYW5kIHVwbG9hZCBsb2dzCiAgICBsaW51eExvZ0pzb25GaWxlCT0gb3MucGF0aC5qb2luKGZpbGVzRGlyLCBmJ3tsaW51eExvZ30uanNvbicpCiAgICB3aXRoIG9wZW4obGludXhMb2dKc29uRmlsZSwgJ3cnKSBhcyBmOgogICAgICAgIGYud3JpdGUoanNvbi5kdW1wcyhsaW51eGxvZ0RpY3QsIGluZGVudD00LCBkZWZhdWx0PXN0cikpCiAgICBvdXRaaXBGaWxlIAkJCT0gemlwRmlsZShmJ3tsaW51eExvZ30uanNvbicpCiAgICB1cGxvYWRTdWNjZXNzIAkJPSBzZW5kUGF5bG9hZEZsYXNrKHJvdXRlLCBvdXRaaXBGaWxlLCBkZXZpY2VVdWlkKQogICAgaWYgdXBsb2FkU3VjY2VzcyA9PSBUcnVlOgogICAgICAgIGRlbEZpbGUob3V0WmlwRmlsZSkKICAgIGVsc2U6CiAgICAgICAgbG9nZ2VyLmVycm9yKGYnVXBsb2FkIGZhaWxlZC4nKQogICAgCiAgICAjIENyZWF0ZSBmaWx0ZXJlZCB2ZXJzaW9uIHdpdGggdG9wIGV2ZW50cwogICAgZmlsdGVyZWRsaW51eGxvZ0RpY3QgCT0gZmlsdGVyTGludXhMb2cobGludXhMb2cpCiAgICBldmVudHMgCQkJCQk9IGZpbHRlcmVkbGludXhsb2dEaWN0WyJTb3VyY2VzIl1bIlRvcEV2ZW50cyJdCiAgICB0b3RhbENvdW50IAkJCQk9IHN1bShldmVudFsiQ291bnQiXSBmb3IgZXZlbnQgaW4gZXZlbnRzKQogICAgZmlsdGVyZWRsaW51eGxvZ0RpY3RbJ1NvdXJjZXMnXVsnVG90YWxFdmVudHMnXSA9IHRvdGFsQ291bnQKICAgIGxvZ2dlci5kZWJ1Zyhqc29uLmR1bXBzKGZpbHRlcmVkbGludXhsb2dEaWN0LCBpbmRlbnQ9NCkpCiAgICB3aXRoIG9wZW4ob3MucGF0aC5qb2luKGZpbGVzRGlyLCBmJ3tsaW51eExvZ31GaWx0ZXJlZC5qc29uJyksICd3JykgYXMgZjoKICAgICAgICBmLndyaXRlKGpzb24uZHVtcHMoZmlsdGVyZWRsaW51eGxvZ0RpY3QsIGluZGVudD00KSkKICAgIHNlbmRMaW51eExvZ01ldGFkYXRhKGRldmljZVV1aWQsIGxpbnV4TG9nKQoKCmRlZiBnZXRBcHBEaXJzKCk6CiAgICAjIFNldHVwIGFwcGxpY2F0aW9uIGRpcmVjdG9yaWVzIGJhc2VkIG9uIE9TIHBsYXRmb3JtCiAgICBpZiBwbGF0Zm9ybS5zeXN0ZW0oKSA9PSAnV2luZG93cyc6CiAgICAgICAgYXBwRGlyIAkJPSAnYzpcXHByb2dyYW0gZmlsZXMgKHg4NilcXFdlZ3dlaXNlclxcJwogICAgICAgIGxvZ0RpciAJCT0gZid7YXBwRGlyfUxvZ3NcXCcKICAgICAgICBjb25maWdEaXIgCT0gZid7YXBwRGlyfUNvbmZpZ1xcJwogICAgICAgIHRlbXBEaXIgCT0gb3MuZ2V0ZW52KCdURU1QJykKICAgICAgICBmaWxlc0Rpcgk9IGYne2FwcERpcn1GaWxlc1xcJwogICAgZWxzZToKICAgICAgICBhcHBEaXIgCQk9ICcvb3B0L1dlZ3dlaXNlci8nCiAgICAgICAgbG9nRGlyIAkJPSBmJ3thcHBEaXJ9TG9ncy8nCiAgICAgICAgY29uZmlnRGlyIAk9IGYne2FwcERpcn1Db25maWcvJwogICAgICAgIGZpbGVzRGlyCT0gZid7YXBwRGlyfUZpbGVzLycKICAgICAgICB0ZW1wRGlyIAk9IG9zLmdldGVudignVE1QRElSJykgb3Igb3MuZ2V0ZW52KCdURU1QJykgb3Igb3MuZ2V0ZW52KCdUTVAnKSBvciAnL3RtcCcKICAgIAogICAgIyBFbnN1cmUgYWxsIHJlcXVpcmVkIGRpcmVjdG9yaWVzIGV4aXN0CiAgICBjaGVja0RpcihhcHBEaXIpCiAgICBjaGVja0Rpcihsb2dEaXIpCiAgICBjaGVja0Rpcihjb25maWdEaXIpCiAgICBjaGVja0Rpcih0ZW1wRGlyKQogICAgY2hlY2tEaXIoZmlsZXNEaXIpCiAgICByZXR1cm4oYXBwRGlyLCBsb2dEaXIsIGNvbmZpZ0RpciwgdGVtcERpciwgZmlsZXNEaXIpCgpkZWYgY2hlY2tEaXIoZGlyVG9DaGVjayk6CiAgICAjIENyZWF0ZSBkaXJlY3RvcnkgaWYgaXQgZG9lc24ndCBleGlzdAogICAgZGlyVG9DaGVjayA9IG9zLnBhdGguam9pbihkaXJUb0NoZWNrLCAnJykKICAgIGlmIG5vdCBvcy5wYXRoLmlzZGlyKGRpclRvQ2hlY2spOgogICAgICAgIGxvZ2dlci5pbmZvKGYne2RpclRvQ2hlY2t9IGRvZXMgbm90IGV4aXN0LiBDcmVhdGluZy4uLicpCiAgICAgICAgdHJ5OgogICAgICAgICAgICBvcy5tYWtlZGlycyhkaXJUb0NoZWNrKQogICAgICAgICAgICBsb2dnZXIuaW5mbyhmJ3tkaXJUb0NoZWNrfSBjcmVhdGVkLicpCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBsb2dnZXIuZXJyb3IoZidGYWlsZWQgdG8gY3JlYXRlIHtkaXJUb0NoZWNrfS4gUmVhc29uOiB7ZX0nKQogICAgICAgICAgICBzeXMuZXhpdCgpCiAgICByZXR1cm4oZGlyVG9DaGVjaykKCmRlZiB6aXBGaWxlKGZpbGVUb1ppcCk6CiAgICAjIENvbXByZXNzIGEgZmlsZSB1c2luZyBaSVAgZm9ybWF0CiAgICBpbXBvcnQgemlwZmlsZQogICAgaW5GaWxlIAkJPSBmJ3tmaWxlc0Rpcn17ZmlsZVRvWmlwfScKICAgIG91dFppcEZpbGUgCT0gZid7ZmlsZXNEaXJ9e2ZpbGVUb1ppcH0uemlwJwogICAgbG9nZ2VyLmluZm8oZidaaXBwaW5nIHtpbkZpbGV9IHRvIHtvdXRaaXBGaWxlfScpCiAgICB3aXRoIHppcGZpbGUuWmlwRmlsZShvdXRaaXBGaWxlLCAndycsIGNvbXByZXNzaW9uPXppcGZpbGUuWklQX0RFRkxBVEVEKSBhcyB6aXBmOgogICAgICAgIHppcGYud3JpdGUoaW5GaWxlLCBvcy5wYXRoLmJhc2VuYW1lKGluRmlsZSkpCiAgICBsb2dnZXIuaW5mbyhmJ1N1Y2Nlc3NmdWxseSB6aXBwZWQge2luRmlsZX0gdG8ge291dFppcEZpbGV9JykKICAgIHJldHVybihvdXRaaXBGaWxlKQoKZGVmIGdldERldmljZVV1aWQoY29uZmlnRmlsZSk6CiAgICAjIEdldCBkZXZpY2UgVVVJRCBhbmQgc2VydmVyIGFkZHJlc3MgZnJvbSBjb25maWcgZmlsZQogICAgbG9nZ2VyLmluZm8oZidBdHRlbXB0aW5nIHRvIHJlYWQgY29uZmlnIGZpbGU6IHtjb25maWdGaWxlfS4uLicpCiAgICBpZiBvcy5wYXRoLmlzZmlsZShjb25maWdGaWxlKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHdpdGggb3Blbihjb25maWdGaWxlLCAncicpIGFzIGY6CiAgICAgICAgICAgICAgICBjb25maWdEaWN0ID0ganNvbi5sb2FkKGYpCiAgICAgICAgICAgIGxvZ2dlci5pbmZvKGYnU3VjY2Vzc2Z1bGx5IHJlYWQge2NvbmZpZ0ZpbGV9JykKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIGxvZ2dlci5lcnJvcihmJ0ZhaWxlZCB0byByZWFkIHtjb25maWdGaWxlfScpCiAgICAgICAgICAgIHF1aXQoJ1F1aXR0aW5nLicpCiAgICAgICAgZGV2aWNlVXVpZCAJPSBjb25maWdEaWN0WydkZXZpY2V1dWlkJ10KICAgICAgICBpZiAnc2VydmVyQWRkcicgaW4gY29uZmlnRGljdDoKICAgICAgICAgICAgaG9zdAkJPSBjb25maWdEaWN0WydzZXJ2ZXJBZGRyJ10KICAgICAgICBlbHNlOgogICAgICAgICAgICBob3N0IAk9ICdhcHAud2Vnd2Vpc2VyLnRlY2gnICAjIERlZmF1bHQgc2VydmVyCiAgICByZXR1cm4oZGV2aWNlVXVpZCwgaG9zdCkKCmRlZiBkZWxGaWxlKGZpbGVUb0RlbGV0ZSk6CiAgICAjIERlbGV0ZSBhIGZpbGUgYWZ0ZXIgc3VjY2Vzc2Z1bCB1cGxvYWQKICAgIGxvZ2dlci5pbmZvKGYnQXR0ZW1wdGluZyB0byBkZWxldGUge2ZpbGVUb0RlbGV0ZX0uLi4nKQogICAgdHJ5OgogICAgICAgIG9zLnJlbW92ZShmaWxlVG9EZWxldGUpCiAgICAgICAgbG9nZ2VyLmluZm8oZidTdWNjZXNzZnVsbHkgZGVsZXRlZCB7ZmlsZVRvRGVsZXRlfS4nKQogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIGxvZ2dlci5lcnJvcihmJ0ZhaWxlZCB0byBkZWxldGUge2ZpbGVUb0RlbGV0ZX0uIFJlYXNvbjoge2V9JykKCmRlZiBmaWx0ZXJFdmVudExvZyhsb2dOYW1lKToKICAgICMgQ3JlYXRlIHN1bW1hcnkgb2YgV2luZG93cyBldmVudCBsb2dzIGJ5IGZpbHRlcmluZyBhbmQgZ3JvdXBpbmcgZXZlbnRzCiAgICBncm91cGVkRGF0YSA9IHt9CiAgICBqc29uRmlsZSAJPSBvcy5wYXRoLmpvaW4oZmlsZXNEaXIsIGYnZXZlbnRzLXtsb2dOYW1lfS5qc29uJykKICAgIGRhdGEgCQk9IHJlYWRFdmVudEpzb24oanNvbkZpbGUpCgogICAgIyBHcm91cCBldmVudHMgYnkgZXZlbnQgSUQgZm9yIHdhcm5pbmdzLCBlcnJvcnMsIGFuZCBhbGwgc2VjdXJpdHkgZXZlbnRzCiAgICBmb3IgcmVjb3JkX2lkLCByZWNvcmQgaW4gZGF0YS5pdGVtcygpOgogICAgICAgIGV2ZW50SWQgCQk9IHJlY29yZFsiZXZlbnRpZCJdCiAgICAgICAgdGltZUdlbmVyYXRlZCAJPSBwYXJzZVRpbWUocmVjb3JkWyJ0aW1lZ2VuZXJhdGVkIl0pCiAgICAgICAgbWVzc2FnZSAJCT0gcmVjb3JkWyJtZXNzYWdlIl0KICAgICAgICBsZXZlbCAJCQk9IHJlY29yZFsnZXZlbnR0eXBlJ10KICAgICAgICBpZiAobGV2ZWwgPT0gJ1dBUk5JTkcnKSBvciAobGV2ZWwgPT0gJ0VSUk9SJykgb3IgKGxvZ05hbWUgPT0gJ1NlY3VyaXR5Jyk6CiAgICAgICAgICAgIGlmIGV2ZW50SWQgbm90IGluIGdyb3VwZWREYXRhOgogICAgICAgICAgICAgICAgZ3JvdXBlZERhdGFbZXZlbnRJZF0gPSB7CiAgICAgICAgICAgICAgICAgICAgImNvdW50IjogMCwKICAgICAgICAgICAgICAgICAgICAibWVzc2FnZSI6IG1lc3NhZ2UsCiAgICAgICAgICAgICAgICAgICAgIm1vc3RyZWNlbnR0aW1lIjogdGltZUdlbmVyYXRlZCwKICAgICAgICAgICAgICAgICAgICAibGV2ZWwiOiBsZXZlbAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICBncm91cGVkRGF0YVtldmVudElkXVsiY291bnQiXSArPSAxCiAgICAgICAgICAgIGlmIHRpbWVHZW5lcmF0ZWQgPiBncm91cGVkRGF0YVtldmVudElkXVsibW9zdHJlY2VudHRpbWUiXToKICAgICAgICAgICAgICAgIGdyb3VwZWREYXRhW2V2ZW50SWRdWyJtb3N0cmVjZW50dGltZSJdID0gdGltZUdlbmVyYXRlZAogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHBhc3MKCiAgICAjIEZvcm1hdCBkYXRlcyBhbmQgc29ydCBieSBmcmVxdWVuY3kKICAgIGZvciBldmVudElkLCBkZXRhaWxzIGluIGdyb3VwZWREYXRhLml0ZW1zKCk6CiAgICAgICAgZGV0YWlsc1sibW9zdHJlY2VudHRpbWUiXSA9IGRldGFpbHNbIm1vc3RyZWNlbnR0aW1lIl0uc3RyZnRpbWUoIiVZLSVtLSVkLSVIOiVNOiVTIikKICAgICMgTElNSVRBVElPTjogQ2hhbmdlIHRoZSB2YWx1ZSAxMCBiZWxvdyB0byBpbmNyZWFzZSB0aGUgbnVtYmVyIG9mIHRvcCBldmVudHMgY29sbGVjdGVkIGZvciBXaW5kb3dzIGxvZ3MKICAgIHNvcnRlZEdyb3VwZWREYXRhID0gc29ydGVkKGdyb3VwZWREYXRhLml0ZW1zKCksIGtleT1sYW1iZGEgeDogeFsxXVsiY291bnQiXSwgcmV2ZXJzZT1UcnVlKVs6MTBdCgogICAgIyBDcmVhdGUgdG9wIDEwIGxpc3QKICAgIHRvcEV2ZW50cyA9IFtdCiAgICBmb3IgZXZlbnRJZCwgZGV0YWlscyBpbiBzb3J0ZWRHcm91cGVkRGF0YToKICAgICAgICBjdXJyZW50VG9wRXZlbnQgPSB7CiAgICAgICAgICAgICdNZXNzYWdlJzpkZXRhaWxzWydtZXNzYWdlJ10sIAogICAgICAgICAgICAnRXZlbnRJRCc6IGV2ZW50SWQsIAogICAgICAgICAgICAnTGV2ZWwnOiBkZXRhaWxzWydsZXZlbCddLCAKICAgICAgICAgICAgJ0NvdW50JzogZGV0YWlsc1snY291bnQnXSwgCiAgICAgICAgICAgICdMYXRlc3RPY2N1cnJlbmNlJzpkZXRhaWxzWydtb3N0cmVjZW50dGltZSddCiAgICAgICAgICAgIH0KICAgICAgICB0b3BFdmVudHMuYXBwZW5kKGN1cnJlbnRUb3BFdmVudCkKCiAgICAjIENyZWF0ZSBzdW1tYXJ5IHN0cnVjdHVyZQogICAgZmlsdGVyZWRFdmVudERpY3QJCQkJCQkJPSB7fQogICAgZmlsdGVyZWRFdmVudERpY3RbJ0xvZ05hbWUnXSAJCQkJPSBsb2dOYW1lCiAgICBmaWx0ZXJlZEV2ZW50RGljdFsnU291cmNlcyddIAkJCQk9IHt9CiAgICBmaWx0ZXJlZEV2ZW50RGljdFsnU291cmNlcyddWydUb3BFdmVudHMnXSAJPSB0b3BFdmVudHMKICAgICMgTElNSVRBVElPTjogQ2hhbmdlIHRoZSB2YWx1ZSAxMCBiZWxvdyB0byBtYXRjaCB0aGUgbnVtYmVyIG9mIHRvcCBldmVudHMgY29sbGVjdGVkIGFib3ZlCiAgICBmaWx0ZXJlZEV2ZW50RGljdFsnU291cmNlcyddWydUb3RhbEV2ZW50cyddID0gMTAKICAgIHJldHVybihmaWx0ZXJlZEV2ZW50RGljdCkKCmRlZiByZWFkRXZlbnRKc29uKGpzb25GaWxlKToKICAgICMgUmVhZCBldmVudCBkYXRhIGZyb20gSlNPTiBmaWxlCiAgICB3aXRoIG9wZW4oanNvbkZpbGUsICdyJykgYXMgZjoKICAgICAgICBldmVudHNEaWN0ID0ganNvbi5sb2FkKGYpCiAgICByZXR1cm4oZXZlbnRzRGljdCkKCmRlZiBwYXJzZVRpbWUodGltZVN0cik6CiAgICAjIFBhcnNlIHRpbWUgc3RyaW5nIGluIHRoZSBzdGFuZGFyZCBmb3JtYXQgdXNlZCBieSBXaW5kb3dzIGV2ZW50cwogICAgcmV0dXJuIChkYXRldGltZS5kYXRldGltZS5zdHJwdGltZSh0aW1lU3RyLCAiJVktJW0tJWQtJUg6JU06JVMiKSkKCmRlZiBwYXJzZVRpbWUyKHRpbWVTdHIpOgogICAgIyBQYXJzZSB0aW1lIHN0cmluZyBpbiB0aGUgc3RhbmRhcmQgZm9ybWF0IHVzZWQgYnkgTGludXggbG9ncwogICAgcmV0dXJuIChkYXRldGltZS5kYXRldGltZS5zdHJwdGltZSh0aW1lU3RyLCAiJVktJW0tJWQgJUg6JU06JVMiKSkKCmRlZiBzZW5kRXZlbnRNZXRhZGF0YShkZXZpY2VVdWlkKToKICAgICMgU2VuZCBmaWx0ZXJlZCBXaW5kb3dzIGV2ZW50IGxvZyBzdW1tYXJpZXMgdG8gc2VydmVyCiAgICB1cmwgPSBmJ2h0dHBzOi8ve2hvc3R9L2FpL2RldmljZS9tZXRhZGF0YScKICAgIGxvZ05hbWVzID0gWydBcHBsaWNhdGlvbicsICdTeXN0ZW0nLCAnU2VjdXJpdHknXQogICAgZm9yIGxvZ05hbWUgaW4gbG9nTmFtZXM6CiAgICAgICAgd2l0aCBvcGVuKG9zLnBhdGguam9pbihmaWxlc0RpciwgJ2V2ZW50c0ZpbHRlcmVkLScgKyBsb2dOYW1lICsnLmpzb24nKSwgJ3InKSBhcyBmOgogICAgICAgICAgICBkYXRhID0ganNvbi5sb2FkKGYpCiAgICAgICAgYm9keSA9IHsKICAgICAgICAgICAgJ2RldmljZXV1aWQnOmRldmljZVV1aWQsCiAgICAgICAgICAgICdtZXRhbG9nb3NfdHlwZSc6ZidldmVudHNGaWx0ZXJlZC17bG9nTmFtZX0nLAogICAgICAgICAgICAnbWV0YWxvZ29zJzpkYXRhCiAgICAgICAgICAgIH0KICAgICAgICAKICAgICAgICBoZWFkZXJzIAk9IHsnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nfQogICAgICAgIGxvZ2dlci5pbmZvKGYnQXR0ZW1wdGluZyB0byBQT1NUIHRvOiB7dXJsfScpCiAgICAgICAgcmVzcG9uc2UgCT0gcmVxdWVzdHMucG9zdCh1cmwsIGhlYWRlcnM9aGVhZGVycywgZGF0YT1qc29uLmR1bXBzKGJvZHkpKQogICAgICAgIGxvZ2dlci5pbmZvKGYncmVzcG9uc2U6IHtyZXNwb25zZS5zdGF0dXNfY29kZX0nKQogICAgICAgIGlmIHJlc3BvbnNlLnN0YXR1c19jb2RlICE9IDIwMToKICAgICAgICAgICAgbG9nZ2VyLmVycm9yKGYnRmFpbGVkIHRvIFBPU1QgZGF0YS4gUmVhc29uOiB7cmVzcG9uc2UudGV4dH0nKQoKZGVmIHNlbmRMaW51eExvZ01ldGFkYXRhKGRldmljZVV1aWQsIGxvZ1RvU2VuZCk6CiAgICAjIFNlbmQgZmlsdGVyZWQgTGludXggbG9nIHN1bW1hcmllcyB0byBzZXJ2ZXIKICAgIHVybCA9IGYnaHR0cHM6Ly97aG9zdH0vYWkvZGV2aWNlL21ldGFkYXRhJwogICAgd2l0aCBvcGVuKG9zLnBhdGguam9pbihmaWxlc0RpciwgZid7bG9nVG9TZW5kfUZpbHRlcmVkLmpzb24nKSwgJ3InKSBhcyBmOgogICAgICAgIGRhdGEgPSBqc29uLmxvYWQoZikKICAgIGJvZHkgPSB7CiAgICAgICAgJ2RldmljZXV1aWQnOmRldmljZVV1aWQsCiAgICAgICAgJ21ldGFsb2dvc190eXBlJzpmJ3tsb2dUb1NlbmR9RmlsdGVyZWQnLAogICAgICAgICdtZXRhbG9nb3MnOmRhdGEKICAgICAgICB9CiAgICBoZWFkZXJzIAk9IHsnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nfQogICAgbG9nZ2VyLmluZm8oZidBdHRlbXB0aW5nIHRvIFBPU1QgdG86IHt1cmx9IGZvciB7bG9nVG9TZW5kfScpCiAgICByZXNwb25zZSAJPSByZXF1ZXN0cy5wb3N0KHVybCwgaGVhZGVycz1oZWFkZXJzLCBkYXRhPWpzb24uZHVtcHMoYm9keSkpCiAgICBsb2dnZXIuaW5mbyhmJ3Jlc3BvbnNlOiB7cmVzcG9uc2Uuc3RhdHVzX2NvZGV9JykKICAgIGlmIHJlc3BvbnNlLnN0YXR1c19jb2RlICE9IDIwMToKICAgICAgICBsb2dnZXIuZXJyb3IoZidGYWlsZWQgdG8gUE9TVCBkYXRhLiBSZWFzb246IHtyZXNwb25zZS50ZXh0fScpCgoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIE1BSU4gIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCgojIEdsb2JhbCBjb25maWd1cmF0aW9uCmRlYnVnTW9kZSAJCT0gRmFsc2UKcG9ydCAJCQk9IDQ0MwoKIyBTZXR1cCBkaXJlY3RvcmllcwphcHBEaXIsIFwKICAgIGxvZ0RpciwgXAogICAgY29uZmlnRGlyLCBcCiAgICB0ZW1wRGlyLCBcCiAgICBmaWxlc0Rpcgk9IGdldEFwcERpcnMoKQoKIyBHZXQgZGV2aWNlIGlkZW50aWZpY2F0aW9uIGFuZCBzZXJ2ZXIgaW5mb3JtYXRpb24Kd2VnQ29uZmlnRmlsZSAJPSBmJ3tjb25maWdEaXJ9YWdlbnQuY29uZmlnJwpkZXZpY2VVdWlkLCBcCiAgICBob3N0CQk9IGdldERldmljZVV1aWQod2VnQ29uZmlnRmlsZSkKCnJvdXRlID0gJy9wYXlsb2FkL3NlbmRmaWxlJwoKIyBQbGF0Zm9ybS1zcGVjaWZpYyBwcm9jZXNzaW5nCmlmIHBsYXRmb3JtLnN5c3RlbSgpID09ICdXaW5kb3dzJzoKICAgICMgV2luZG93cyBldmVudCBsb2cgY29sbGVjdGlvbgogICAgIyBQcm9jZXNzIHN0YW5kYXJkIFdpbmRvd3MgZXZlbnQgbG9ncwogICAgbG9nTGlzdCAJCQk9IFsnQXBwbGljYXRpb24nLCAnU3lzdGVtJywgJ1NlY3VyaXR5J10KICAgIGxvZ2dlci5pbmZvKCdTdGFydGluZyBFdmVudCBMb2cgQ29sbGVjdGlvbicpCiAgICBmb3IgbG9nIGluIGxvZ0xpc3Q6CiAgICAgICAgbGF0ZXN0RXZ0RmlsZQkJPSBmJ3tjb25maWdEaXJ9bGF0ZXN0RXZ0LXtsb2d9LnR4dCcKICAgICAgICBsYXRlc3RFdmVudCAJCT0gZ2V0TGF0ZXN0RXZlbnQobGF0ZXN0RXZ0RmlsZSkKICAgICAgICBvYmplY3RMaXN0IAkJCT0gcmVhZExvZyhsb2cpCiAgICAgICAgZXZlbnREaWN0CQkJPSByZWFkRXhpc3RpbmdMb2dKc29uKGxvZykKICAgICAgICBldmVudERpY3QJCQk9IHByb2Nlc3NFdmVudHMobG9nLCBvYmplY3RMaXN0LCBldmVudERpY3QpCiAgICAgICAgd3JpdGVMb2dKc29uKGV2ZW50RGljdCwgbG9nKQogICAgICAgIHdyaXRlTGF0ZXN0RXZlbnQobGF0ZXN0RXZlbnQsIGxvZywgb2JqZWN0TGlzdCkKICAgICAgICBvdXRaaXBGaWxlIAkJCT0gemlwRmlsZShmJ2V2ZW50cy17bG9nfS5qc29uJykKICAgICAgICB1cGxvYWRTdWNjZXNzIAkJPSBzZW5kUGF5bG9hZEZsYXNrKHJvdXRlLCBvdXRaaXBGaWxlLCBkZXZpY2VVdWlkKQogICAgICAgIGlmIHVwbG9hZFN1Y2Nlc3MgPT0gVHJ1ZToKICAgICAgICAgICAgZGVsRmlsZShvdXRaaXBGaWxlKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGxvZ2dlci5lcnJvcihmJ1VwbG9hZCBmYWlsZWQuJykKICAgIAogICAgIyBDcmVhdGUgYW5kIHNlbmQgZmlsdGVyZWQgZXZlbnQgc3VtbWFyaWVzCiAgICBsb2dOYW1lcyA9IFsnQXBwbGljYXRpb24nLCAnU3lzdGVtJywgJ1NlY3VyaXR5J10JCiAgICBzdGFydFRpbWUgPSB0aW1lLnRpbWUoKQogICAgZm9yIGxvZ05hbWUgaW4gbG9nTmFtZXM6CiAgICAgICAgZmlsdGVyZWRFdmVudERpY3QgCT0gZmlsdGVyRXZlbnRMb2cobG9nTmFtZSkKICAgICAgICBldmVudHMgCQkJCT0gZmlsdGVyZWRFdmVudERpY3RbIlNvdXJjZXMiXVsiVG9wRXZlbnRzIl0KICAgICAgICB0b3RhbENvdW50IAkJCT0gc3VtKGV2ZW50WyJDb3VudCJdIGZvciBldmVudCBpbiBldmVudHMpCiAgICAgICAgZmlsdGVyZWRFdmVudERpY3RbJ1NvdXJjZXMnXVsnVG90YWxFdmVudHMnXSA9IHRvdGFsQ291bnQKICAgICAgICBsb2dnZXIuZGVidWcoanNvbi5kdW1wcyhmaWx0ZXJlZEV2ZW50RGljdCwgaW5kZW50PTQpKQogICAgICAgIHdpdGggb3Blbihvcy5wYXRoLmpvaW4oZmlsZXNEaXIsICdldmVudHNGaWx0ZXJlZC0nICsgbG9nTmFtZSArJy5qc29uJyksICd3JykgYXMgZjoKICAgICAgICAgICAgZi53cml0ZShqc29uLmR1bXBzKGZpbHRlcmVkRXZlbnREaWN0LCBpbmRlbnQ9NCkpCiAgICBsb2dnZXIuaW5mbyhmJ0V2ZW50bG9nIFBhcnNlIFRpbWU6IHt0aW1lLnRpbWUoKS1zdGFydFRpbWV9IHNlY29uZHMuJykKICAgIHNlbmRFdmVudE1ldGFkYXRhKGRldmljZVV1aWQpCmVsc2U6CiAgICAjIExpbnV4IGxvZyBjb2xsZWN0aW9uIC0gZGV0ZWN0IGFuZCB1c2UgYXBwcm9wcmlhdGUgbG9nIHNvdXJjZQogICAgaWYgaXNKb3VybmFsVXNlZCgpID09IFRydWU6CiAgICAgICAgcHJvY2Vzc0xpbnV4Sm91cm5hbCgzMSkKICAgIGVsc2U6CQogICAgICAgIHByb2Nlc3NMaW51eExvZ3MoMzEp"}, "resigned_at": 1761308224}