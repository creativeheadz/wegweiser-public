{"settings": {"snippetUuid": "716e9778-4d17-44ef-ac3e-19182be49afb", "snippetname": "MacOSLogAudit", "snippettype": ".py", "created_at": 1751794105}, "payload": {"payloadsig": "ZuOkGkA+aecrKhhU5hYSKI57dPMf4/+Pdn2FIPrBn+7rBYmb57/uNbkn+QLZwj5+hoxpElqSB1HxwpC7t/5DIYe8bIIj9uVsOsYHCzLYVSxNGR8zeBgqCUOyROj+3PlfPsxgATboZq9l7nqMN65sMxeF8J2Dzg4lWH5uecuAt+/d9eYpgsIpXZqDiKNMKzAUGCfwNAhINYHAxfD5gywADizGHpdzaghxRjCLsrWj1A1uWhD2Cmrnspz9N2GD+2Rx5DNlMApBtrQwctJPTYHMb6P/5TLPvQ8If0GSGHisW+Hy8SD1mIeqa6tdZMONqLpfGKRERaacl3P6CBGfXRBHDVsJPOuB6gM6jMVe37qWJeGaT3nQjCUhugLqaiIbRlPdi7kTKmLS/rYOFALBP+djLLXvOYq6Pf/+HmbLL72FLPdx3aKptAfKn7qKnU9/OdcPFItJEhHj2V/E1PzHrFI56UIT6W7LjopBWOEHXO4FworCmmoSb6gveKqdZN+8j99R8m+5d0kkuYq7WoNpPl1/DYJ3PVIoZAXEVfZiNeUSMCf+gB+k+kU1jJgfvzfSMlfcGfS/nECZjkIMcNRKJoMD5Kx1OOuqItIs9hdgn/9w7Fw/hRnFCS4zqE8kszNQJdbiV8TAnKLQvmgkKivuIXEQ+hejqE//FZA9bPoIBdt4Hdo=", "payloadb64": "IyEvdXNyL2Jpbi9lbnYgcHl0aG9uMwoiIiIKTWFjT1MgTG9nIEF1ZGl0IFNjcmlwdCAtIEZvbGxvd2luZyBXaW5kb3dzIGV2ZW50TG9nQXVkaXQucHkgUGF0dGVybgpJbXBsZW1lbnRzIGJhc2VsaW5lICgzMC1kYXkpICsgaW5jcmVtZW50YWwgY29sbGVjdGlvbiBsaWtlIFdpbmRvd3MKIiIiCgppbXBvcnQgcGxhdGZvcm0KZnJvbSBsb2d6ZXJvIGltcG9ydCBsb2dnZXIsIGxvZ2ZpbGUKaW1wb3J0IGRhdGV0aW1lCmltcG9ydCBvcwppbXBvcnQganNvbgppbXBvcnQgcmVxdWVzdHMKaW1wb3J0IHRpbWUKaW1wb3J0IHN5cwppbXBvcnQgc3VicHJvY2VzcwppbXBvcnQgcmUKCiMgR2xvYmFsIHZhcmlhYmxlcwphcHBEaXIgPSAnL29wdC9XZWd3ZWlzZXIvJwpsb2dEaXIgPSBvcy5wYXRoLmpvaW4oYXBwRGlyLCAnTG9ncycsICcnKQpjb25maWdEaXIgPSBvcy5wYXRoLmpvaW4oYXBwRGlyLCAnQ29uZmlnJywgJycpCmZpbGVzRGlyID0gb3MucGF0aC5qb2luKGFwcERpciwgJ0ZpbGVzJywgJycpCgpkZWYgZ2V0RGV2aWNlVXVpZCh3ZWdDb25maWdGaWxlKToKICAgICIiIlJlYWQgZGV2aWNlIFVVSUQgYW5kIGhvc3QgZnJvbSBjb25maWcgZmlsZSIiIgogICAgdHJ5OgogICAgICAgIGxvZ2dlci5pbmZvKGYnQXR0ZW1wdGluZyB0byByZWFkIGNvbmZpZyBmaWxlOiB7d2VnQ29uZmlnRmlsZX0uLi4nKQogICAgICAgIHdpdGggb3Blbih3ZWdDb25maWdGaWxlLCAncicpIGFzIGY6CiAgICAgICAgICAgIGNvbmZpZ0RpY3QgPSBqc29uLmxvYWQoZikKICAgICAgICBsb2dnZXIuaW5mbyhmJ1N1Y2Nlc3NmdWxseSByZWFkIHt3ZWdDb25maWdGaWxlfScpCiAgICAgICAgZGV2aWNlVXVpZCA9IGNvbmZpZ0RpY3RbJ2RldmljZXV1aWQnXQogICAgICAgIGhvc3QgPSBjb25maWdEaWN0LmdldCgnc2VydmVyQWRkcicsICdhcHAud2Vnd2Vpc2VyLnRlY2gnKQogICAgICAgIHJldHVybiBkZXZpY2VVdWlkLCBob3N0CiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgbG9nZ2VyLmVycm9yKGYnRmFpbGVkIHRvIHJlYWQgY29uZmlnOiB7ZX0nKQogICAgICAgIHN5cy5leGl0KDEpCgpkZWYgZ2V0TGFzdENvbGxlY3Rpb25UaW1lKGNhdGVnb3J5X25hbWUpOgogICAgIiIiR2V0IGxhc3QgY29sbGVjdGlvbiB0aW1lc3RhbXAgKGxpa2UgV2luZG93cyBnZXRMYXRlc3RFdmVudCkiIiIKICAgIHRyYWNraW5nX2ZpbGUgPSBvcy5wYXRoLmpvaW4oY29uZmlnRGlyLCBmJ21hY29zLWxhc3Qte2NhdGVnb3J5X25hbWV9LnR4dCcpCiAgICBpZiBub3Qgb3MucGF0aC5pc2ZpbGUodHJhY2tpbmdfZmlsZSk6CiAgICAgICAgbG9nZ2VyLmluZm8oZidObyB0cmFja2luZyBmaWxlIGZvciB7Y2F0ZWdvcnlfbmFtZX0uIEZpcnN0IHJ1biAtIHdpbGwgY29sbGVjdCAzMC1kYXkgYmFzZWxpbmUuJykKICAgICAgICByZXR1cm4gTm9uZSAgIyBGaXJzdCBydW4KICAgIGVsc2U6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB3aXRoIG9wZW4odHJhY2tpbmdfZmlsZSwgJ3InKSBhcyBmOgogICAgICAgICAgICAgICAgdGltZXN0YW1wID0gZi5yZWFkbGluZSgpLnN0cmlwKCkKICAgICAgICAgICAgbG9nZ2VyLmluZm8oZidMYXN0IGNvbGxlY3Rpb24gZm9yIHtjYXRlZ29yeV9uYW1lfToge3RpbWVzdGFtcH0nKQogICAgICAgICAgICByZXR1cm4gdGltZXN0YW1wCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBsb2dnZXIuZXJyb3IoZidFcnJvciByZWFkaW5nIHRyYWNraW5nIGZpbGU6IHtlfScpCiAgICAgICAgICAgIHJldHVybiBOb25lCgpkZWYgdXBkYXRlTGFzdENvbGxlY3Rpb25UaW1lKGNhdGVnb3J5X25hbWUpOgogICAgIiIiVXBkYXRlIGxhc3QgY29sbGVjdGlvbiB0aW1lc3RhbXAgKGxpa2UgV2luZG93cyB3cml0ZUxhdGVzdEV2ZW50KSIiIgogICAgdHJhY2tpbmdfZmlsZSA9IG9zLnBhdGguam9pbihjb25maWdEaXIsIGYnbWFjb3MtbGFzdC17Y2F0ZWdvcnlfbmFtZX0udHh0JykKICAgIGN1cnJlbnRfdGltZSA9IGRhdGV0aW1lLmRhdGV0aW1lLm5vdygpLmlzb2Zvcm1hdCgpCiAgICB0cnk6CiAgICAgICAgd2l0aCBvcGVuKHRyYWNraW5nX2ZpbGUsICd3JykgYXMgZjoKICAgICAgICAgICAgZi53cml0ZShjdXJyZW50X3RpbWUpCiAgICAgICAgbG9nZ2VyLmluZm8oZidVcGRhdGVkIHRyYWNraW5nIGZvciB7Y2F0ZWdvcnlfbmFtZX06IHtjdXJyZW50X3RpbWV9JykKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICBsb2dnZXIuZXJyb3IoZidFcnJvciB1cGRhdGluZyB0cmFja2luZyBmaWxlOiB7ZX0nKQoKZGVmIHJlYWRFeGlzdGluZ0xvZ0pzb24oY2F0ZWdvcnlfbmFtZSk6CiAgICAiIiJSZWFkIGV4aXN0aW5nIGxvZyBkYXRhIChsaWtlIFdpbmRvd3MgcmVhZEV4aXN0aW5nTG9nSnNvbikiIiIKICAgIGxvZ19maWxlID0gb3MucGF0aC5qb2luKGZpbGVzRGlyLCBmJ21hY29zLXtjYXRlZ29yeV9uYW1lfS5qc29uJykKICAgIGlmIG9zLnBhdGguaXNmaWxlKGxvZ19maWxlKToKICAgICAgICBsb2dnZXIuaW5mbyhmJ1JlYWRpbmcgZXhpc3Rpbmcge2NhdGVnb3J5X25hbWV9IGRhdGEuLi4nKQogICAgICAgIHRyeToKICAgICAgICAgICAgd2l0aCBvcGVuKGxvZ19maWxlLCAncicpIGFzIGY6CiAgICAgICAgICAgICAgICByZXR1cm4ganNvbi5sb2FkKGYpCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBsb2dnZXIuZXJyb3IoZidFcnJvciByZWFkaW5nIGV4aXN0aW5nIGRhdGE6IHtlfScpCiAgICAgICAgICAgIHJldHVybiB7fQogICAgZWxzZToKICAgICAgICBsb2dnZXIuaW5mbyhmJ05vIGV4aXN0aW5nIHtjYXRlZ29yeV9uYW1lfSBkYXRhIGZvdW5kLicpCiAgICAgICAgcmV0dXJuIHt9CgpkZWYgd3JpdGVMb2dKc29uKGxvZ19kYXRhLCBjYXRlZ29yeV9uYW1lKToKICAgICIiIldyaXRlIGxvZyBkYXRhIHRvIGZpbGUgKGxpa2UgV2luZG93cyB3cml0ZUxvZ0pzb24pIiIiCiAgICBsb2dfZmlsZSA9IG9zLnBhdGguam9pbihmaWxlc0RpciwgZidtYWNvcy17Y2F0ZWdvcnlfbmFtZX0uanNvbicpCiAgICB0cnk6CiAgICAgICAgd2l0aCBvcGVuKGxvZ19maWxlLCAndycpIGFzIGY6CiAgICAgICAgICAgIGpzb24uZHVtcChsb2dfZGF0YSwgZiwgaW5kZW50PTIsIGRlZmF1bHQ9c3RyKQogICAgICAgIGxvZ2dlci5pbmZvKGYnV3JvdGUge2NhdGVnb3J5X25hbWV9IGRhdGEgdG8ge2xvZ19maWxlfScpCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgbG9nZ2VyLmVycm9yKGYnRXJyb3Igd3JpdGluZyBsb2cgZGF0YToge2V9JykKCmRlZiBjb2xsZWN0Q2F0ZWdvcnlMb2dzKGNhdGVnb3J5LCBpc19maXJzdF9ydW4pOgogICAgIiIiQ29sbGVjdCBsb2dzIGZvciBhIHNwZWNpZmljIGNhdGVnb3J5IChsaWtlIFdpbmRvd3MgcmVhZExvZyArIHByb2Nlc3NFdmVudHMpIiIiCiAgICBsb2dnZXIuaW5mbyhmIkNvbGxlY3Rpbmcge2NhdGVnb3J5WyduYW1lJ119IGxvZ3MuLi4iKQogICAgCiAgICAjIERldGVybWluZSB0aW1lIHdpbmRvdwogICAgaWYgaXNfZmlyc3RfcnVuOgogICAgICAgIHRpbWVfd2luZG93ID0gIjMwZCIgICMgRnVsbCBiYXNlbGluZQogICAgICAgIGxvZ2dlci5pbmZvKGYiRmlyc3QgcnVuIGZvciB7Y2F0ZWdvcnlbJ25hbWUnXX0gLSBjb2xsZWN0aW5nIDMwLWRheSBiYXNlbGluZSIpCiAgICBlbHNlOgogICAgICAgIHRpbWVfd2luZG93ID0gIjI0aCIgICMgSW5jcmVtZW50YWwKICAgICAgICBsb2dnZXIuaW5mbyhmIkluY3JlbWVudGFsIHJ1biBmb3Ige2NhdGVnb3J5WyduYW1lJ119IC0gY29sbGVjdGluZyBsYXN0IDI0aCIpCiAgICAKICAgIGNtZCA9IFsKICAgICAgICAibG9nIiwgInNob3ciLAogICAgICAgICItLWxhc3QiLCB0aW1lX3dpbmRvdywKICAgICAgICAiLS1wcmVkaWNhdGUiLCBjYXRlZ29yeVsncHJlZGljYXRlJ10sCiAgICAgICAgIi0tc3R5bGUiLCAiY29tcGFjdCIKICAgIF0KICAgIAogICAgdHJ5OgogICAgICAgICMgUmVhc29uYWJsZSB0aW1lb3V0CiAgICAgICAgcmVzdWx0ID0gc3VicHJvY2Vzcy5ydW4oY21kLCBjYXB0dXJlX291dHB1dD1UcnVlLCB0ZXh0PVRydWUsIHRpbWVvdXQ9MzYwKQogICAgICAgIAogICAgICAgIGlmIHJlc3VsdC5yZXR1cm5jb2RlICE9IDA6CiAgICAgICAgICAgIGxvZ2dlci53YXJuaW5nKGYiTG9nIGNvbGxlY3Rpb24gZmFpbGVkIGZvciB7Y2F0ZWdvcnlbJ25hbWUnXX06IHtyZXN1bHQuc3RkZXJyfSIpCiAgICAgICAgICAgIHJldHVybiBbXQogICAgICAgIAogICAgICAgICMgUHJvY2VzcyB0aGUgb3V0cHV0CiAgICAgICAgbGluZXMgPSByZXN1bHQuc3Rkb3V0LnN0cmlwKCkuc3BsaXQoJ1xuJykKICAgICAgICBldmVudHMgPSBbXQogICAgICAgIAogICAgICAgICMgRmlsdGVyIHRvIGxhc3QgMzAgZGF5cyAobGlrZSBXaW5kb3dzIHByb2Nlc3NFdmVudHMpCiAgICAgICAgbm93ID0gZGF0ZXRpbWUuZGF0ZXRpbWUubm93KCkKICAgICAgICB0aGlydHlfZGF5c19hZ28gPSBub3cgLSBkYXRldGltZS50aW1lZGVsdGEoZGF5cz0zMCkKICAgICAgICAKICAgICAgICBmb3IgaSwgbGluZSBpbiBlbnVtZXJhdGUobGluZXMpOgogICAgICAgICAgICBpZiBsaW5lLnN0cmlwKCkgYW5kIGxlbihsaW5lKSA+IDIwOgogICAgICAgICAgICAgICAgIyBDcmVhdGUgZXZlbnQgZW50cnkgKHNpbXBsaWZpZWQpCiAgICAgICAgICAgICAgICBldmVudCA9IHsKICAgICAgICAgICAgICAgICAgICAnaWQnOiBpLAogICAgICAgICAgICAgICAgICAgICd0aW1lc3RhbXAnOiBub3cuaXNvZm9ybWF0KCksICAjIFNpbXBsaWZpZWQgLSBjb3VsZCBwYXJzZSBhY3R1YWwgdGltZXN0YW1wCiAgICAgICAgICAgICAgICAgICAgJ21lc3NhZ2UnOiBsaW5lLnN0cmlwKClbOjUwMF0sICAjIExpbWl0IG1lc3NhZ2UgbGVuZ3RoCiAgICAgICAgICAgICAgICAgICAgJ2NhdGVnb3J5JzogY2F0ZWdvcnlbJ25hbWUnXQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAjIE9ubHkga2VlcCBldmVudHMgZnJvbSBsYXN0IDMwIGRheXMgZm9yIGhlYWx0aCBzY29yaW5nCiAgICAgICAgICAgICAgICBldmVudHMuYXBwZW5kKGV2ZW50KQogICAgICAgIAogICAgICAgIGxvZ2dlci5pbmZvKGYiQ29sbGVjdGVkIHtsZW4oZXZlbnRzKX0ge2NhdGVnb3J5WyduYW1lJ119IGV2ZW50cyIpCiAgICAgICAgcmV0dXJuIGV2ZW50cwogICAgICAgIAogICAgZXhjZXB0IHN1YnByb2Nlc3MuVGltZW91dEV4cGlyZWQ6CiAgICAgICAgbG9nZ2VyLmVycm9yKGYiVGltZW91dCBjb2xsZWN0aW5nIHtjYXRlZ29yeVsnbmFtZSddfSBsb2dzIikKICAgICAgICByZXR1cm4gW10KICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICBsb2dnZXIuZXJyb3IoZiJFcnJvciBjb2xsZWN0aW5nIHtjYXRlZ29yeVsnbmFtZSddfSBsb2dzOiB7ZX0iKQogICAgICAgIHJldHVybiBbXQoKZGVmIHByb2Nlc3NBbmRGaWx0ZXJMb2dzKGV2ZW50cywgY2F0ZWdvcnlfbmFtZSk6CiAgICAiIiJQcm9jZXNzIGFuZCBmaWx0ZXIgbG9ncyAobGlrZSBXaW5kb3dzIGZpbHRlckV2ZW50TG9nKSIiIgogICAgaWYgbm90IGV2ZW50czoKICAgICAgICByZXR1cm4gewogICAgICAgICAgICAnTG9nTmFtZSc6IGNhdGVnb3J5X25hbWUsCiAgICAgICAgICAgICdTb3VyY2VzJzogeydUb3BFdmVudHMnOiBbXSwgJ1RvdGFsRXZlbnRzJzogMH0KICAgICAgICB9CiAgICAKICAgICMgR3JvdXAgYnkgbWVzc2FnZSBwYXR0ZXJuIChzaW1wbGlmaWVkKQogICAgZ3JvdXBzID0ge30KICAgIGZvciBldmVudCBpbiBldmVudHM6CiAgICAgICAgIyBFeHRyYWN0IGZpcnN0IGZldyB3b3JkcyBhcyBwYXR0ZXJuCiAgICAgICAgd29yZHMgPSBldmVudFsnbWVzc2FnZSddLnNwbGl0KClbOjVdCiAgICAgICAgcGF0dGVybiA9ICcgJy5qb2luKHdvcmRzKSBpZiBsZW4od29yZHMpID49IDMgZWxzZSBldmVudFsnbWVzc2FnZSddWzo1MF0KICAgICAgICAKICAgICAgICBpZiBwYXR0ZXJuIG5vdCBpbiBncm91cHM6CiAgICAgICAgICAgIGdyb3Vwc1twYXR0ZXJuXSA9IHsKICAgICAgICAgICAgICAgICdjb3VudCc6IDAsCiAgICAgICAgICAgICAgICAnbGF0ZXN0X3RpbWUnOiBldmVudFsndGltZXN0YW1wJ10sCiAgICAgICAgICAgICAgICAnc2FtcGxlX21lc3NhZ2UnOiBldmVudFsnbWVzc2FnZSddCiAgICAgICAgICAgIH0KICAgICAgICBncm91cHNbcGF0dGVybl1bJ2NvdW50J10gKz0gMQogICAgCiAgICAjIFNvcnQgYnkgY291bnQgYW5kIHRha2UgdG9wIDEwCiAgICBzb3J0ZWRfZ3JvdXBzID0gc29ydGVkKGdyb3Vwcy5pdGVtcygpLCBrZXk9bGFtYmRhIHg6IHhbMV1bJ2NvdW50J10sIHJldmVyc2U9VHJ1ZSlbOjEwXQogICAgCiAgICB0b3BfZXZlbnRzID0gW10KICAgIGZvciBwYXR0ZXJuLCBkYXRhIGluIHNvcnRlZF9ncm91cHM6CiAgICAgICAgdG9wX2V2ZW50cy5hcHBlbmQoewogICAgICAgICAgICAnUGF0dGVybic6IHBhdHRlcm4sCiAgICAgICAgICAgICdNZXNzYWdlJzogZGF0YVsnc2FtcGxlX21lc3NhZ2UnXVs6MjAwXSwKICAgICAgICAgICAgJ0NvdW50JzogZGF0YVsnY291bnQnXSwKICAgICAgICAgICAgJ0xhdGVzdE9jY3VycmVuY2UnOiBkYXRhWydsYXRlc3RfdGltZSddCiAgICAgICAgfSkKICAgIAogICAgcmV0dXJuIHsKICAgICAgICAnTG9nTmFtZSc6IGNhdGVnb3J5X25hbWUsCiAgICAgICAgJ1NvdXJjZXMnOiB7CiAgICAgICAgICAgICdUb3BFdmVudHMnOiB0b3BfZXZlbnRzLAogICAgICAgICAgICAnVG90YWxFdmVudHMnOiBsZW4oZXZlbnRzKQogICAgICAgIH0KICAgIH0KCmRlZiBzZW5kTG9nTWV0YWRhdGEoZGV2aWNlVXVpZCwgaG9zdCwgY2F0ZWdvcnlfbmFtZSwgZmlsdGVyZWRfZGF0YSk6CiAgICAiIiJTZW5kIG1ldGFkYXRhIHRvIHNlcnZlciAobGlrZSBXaW5kb3dzIHNlbmRFdmVudE1ldGFkYXRhKSIiIgogICAgdHJ5OgogICAgICAgIGJvZHkgPSB7CiAgICAgICAgICAgICdkZXZpY2V1dWlkJzogZGV2aWNlVXVpZCwKICAgICAgICAgICAgJ21ldGFsb2dvc190eXBlJzogZidtYWNvcy17Y2F0ZWdvcnlfbmFtZX0tZmlsdGVyZWQnLAogICAgICAgICAgICAnbWV0YWxvZ29zJzogZmlsdGVyZWRfZGF0YQogICAgICAgIH0KICAgICAgICAKICAgICAgICB1cmwgPSBmJ2h0dHBzOi8ve2hvc3R9L2FpL2RldmljZS9tZXRhZGF0YScKICAgICAgICBoZWFkZXJzID0geydDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbid9CiAgICAgICAgCiAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5wb3N0KHVybCwgaGVhZGVycz1oZWFkZXJzLCBkYXRhPWpzb24uZHVtcHMoYm9keSkpCiAgICAgICAgbG9nZ2VyLmluZm8oZidNZXRhZGF0YSByZXNwb25zZSBmb3Ige2NhdGVnb3J5X25hbWV9OiB7cmVzcG9uc2Uuc3RhdHVzX2NvZGV9JykKICAgICAgICAKICAgICAgICBpZiByZXNwb25zZS5zdGF0dXNfY29kZSBub3QgaW4gWzIwMCwgMjAxXToKICAgICAgICAgICAgbG9nZ2VyLmVycm9yKGYnRmFpbGVkIHRvIHNlbmQge2NhdGVnb3J5X25hbWV9IG1ldGFkYXRhOiB7cmVzcG9uc2UudGV4dH0nKQogICAgICAgICAgICAKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICBsb2dnZXIuZXJyb3IoZidFcnJvciBzZW5kaW5nIHtjYXRlZ29yeV9uYW1lfSBtZXRhZGF0YToge2V9JykKCmRlZiBtYWluKCk6CiAgICBpZiBwbGF0Zm9ybS5zeXN0ZW0oKSAhPSAiRGFyd2luIjoKICAgICAgICBsb2dnZXIuZXJyb3IoIlRoaXMgc2NyaXB0IG9ubHkgcnVucyBvbiBNYWNPUyIpCiAgICAgICAgc3lzLmV4aXQoMSkKCiAgICAjIEluaXRpYWxpemUgbG9nZ2luZwogICAgbG9nZmlsZShvcy5wYXRoLmpvaW4obG9nRGlyLCAibWFjb3NfbG9nX2F1ZGl0LmxvZyIpKQogICAgCiAgICAjIEdldCBjb25maWcKICAgIHdlZ0NvbmZpZ0ZpbGUgPSBvcy5wYXRoLmpvaW4oY29uZmlnRGlyLCAnYWdlbnQuY29uZmlnJykKICAgIGRldmljZVV1aWQsIGhvc3QgPSBnZXREZXZpY2VVdWlkKHdlZ0NvbmZpZ0ZpbGUpCiAgICAKICAgICMgRGVmaW5lIGxvZyBjYXRlZ29yaWVzIChsaWtlIFdpbmRvd3MgbG9nTGlzdCkKICAgIGxvZ19jYXRlZ29yaWVzID0gWwogICAgICAgIHsKICAgICAgICAgICAgJ25hbWUnOiAnZXJyb3JzJywKICAgICAgICAgICAgJ3ByZWRpY2F0ZSc6ICdtZXNzYWdlVHlwZSA9PSAiRXJyb3IiIE9SIG1lc3NhZ2VUeXBlID09ICJGYXVsdCInLAogICAgICAgICAgICAnZGVzY3JpcHRpb24nOiAnU3lzdGVtIGVycm9ycyBhbmQgZmF1bHRzJwogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgICAnbmFtZSc6ICdzZWN1cml0eScsCiAgICAgICAgICAgICdwcmVkaWNhdGUnOiAnc3Vic3lzdGVtIENPTlRBSU5TICJzZWN1cml0eSInLAogICAgICAgICAgICAnZGVzY3JpcHRpb24nOiAnU2VjdXJpdHkgZXZlbnRzJwogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgICAnbmFtZSc6ICdjcmFzaGVzJywKICAgICAgICAgICAgJ3ByZWRpY2F0ZSc6ICdldmVudE1lc3NhZ2UgQ09OVEFJTlMgImNyYXNoIicsCiAgICAgICAgICAgICdkZXNjcmlwdGlvbic6ICdBcHBsaWNhdGlvbiBjcmFzaGVzJwogICAgICAgIH0KICAgIF0KICAgIAogICAgbG9nZ2VyLmluZm8oJ1N0YXJ0aW5nIE1hY09TIExvZyBBdWRpdCAoZm9sbG93aW5nIFdpbmRvd3MgZXZlbnRMb2dBdWRpdCBwYXR0ZXJuKScpCiAgICAKICAgIGZvciBjYXRlZ29yeSBpbiBsb2dfY2F0ZWdvcmllczoKICAgICAgICB0cnk6CiAgICAgICAgICAgICMgQ2hlY2sgaWYgdGhpcyBpcyBmaXJzdCBydW4gKGxpa2UgV2luZG93cyBnZXRMYXRlc3RFdmVudCkKICAgICAgICAgICAgbGFzdF90aW1lID0gZ2V0TGFzdENvbGxlY3Rpb25UaW1lKGNhdGVnb3J5WyduYW1lJ10pCiAgICAgICAgICAgIGlzX2ZpcnN0X3J1biA9IChsYXN0X3RpbWUgaXMgTm9uZSkKICAgICAgICAgICAgCiAgICAgICAgICAgICMgQ29sbGVjdCBsb2dzIChsaWtlIFdpbmRvd3MgcmVhZExvZykKICAgICAgICAgICAgZXZlbnRzID0gY29sbGVjdENhdGVnb3J5TG9ncyhjYXRlZ29yeSwgaXNfZmlyc3RfcnVuKQogICAgICAgICAgICAKICAgICAgICAgICAgIyBSZWFkIGV4aXN0aW5nIGRhdGEgYW5kIG1lcmdlIChsaWtlIFdpbmRvd3MgcmVhZEV4aXN0aW5nTG9nSnNvbikKICAgICAgICAgICAgZXhpc3RpbmdfZGF0YSA9IHJlYWRFeGlzdGluZ0xvZ0pzb24oY2F0ZWdvcnlbJ25hbWUnXSkKICAgICAgICAgICAgCiAgICAgICAgICAgICMgTWVyZ2UgbmV3IGV2ZW50cyB3aXRoIGV4aXN0aW5nIChzaW1wbGlmaWVkKQogICAgICAgICAgICBpZiBpc2luc3RhbmNlKGV4aXN0aW5nX2RhdGEsIGRpY3QpIGFuZCAnZXZlbnRzJyBpbiBleGlzdGluZ19kYXRhOgogICAgICAgICAgICAgICAgYWxsX2V2ZW50cyA9IGV4aXN0aW5nX2RhdGFbJ2V2ZW50cyddICsgZXZlbnRzCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBhbGxfZXZlbnRzID0gZXZlbnRzCiAgICAgICAgICAgIAogICAgICAgICAgICAjIEtlZXAgb25seSBsYXN0IDMwIGRheXMgZm9yIGhlYWx0aCBzY29yaW5nCiAgICAgICAgICAgIG5vdyA9IGRhdGV0aW1lLmRhdGV0aW1lLm5vdygpCiAgICAgICAgICAgIHRoaXJ0eV9kYXlzX2FnbyA9IG5vdyAtIGRhdGV0aW1lLnRpbWVkZWx0YShkYXlzPTMwKQogICAgICAgICAgICAKICAgICAgICAgICAgIyBGaWx0ZXIgYW5kIHByb2Nlc3MgKGxpa2UgV2luZG93cyBmaWx0ZXJFdmVudExvZykKICAgICAgICAgICAgZmlsdGVyZWRfZGF0YSA9IHByb2Nlc3NBbmRGaWx0ZXJMb2dzKGFsbF9ldmVudHMsIGNhdGVnb3J5WyduYW1lJ10pCiAgICAgICAgICAgIAogICAgICAgICAgICAjIFNhdmUgZGF0YSAobGlrZSBXaW5kb3dzIHdyaXRlTG9nSnNvbikKICAgICAgICAgICAgd3JpdGVMb2dKc29uKHsnZXZlbnRzJzogYWxsX2V2ZW50cywgJ2ZpbHRlcmVkJzogZmlsdGVyZWRfZGF0YX0sIGNhdGVnb3J5WyduYW1lJ10pCiAgICAgICAgICAgIAogICAgICAgICAgICAjIFNlbmQgdG8gc2VydmVyIChsaWtlIFdpbmRvd3Mgc2VuZEV2ZW50TWV0YWRhdGEpCiAgICAgICAgICAgIHNlbmRMb2dNZXRhZGF0YShkZXZpY2VVdWlkLCBob3N0LCBjYXRlZ29yeVsnbmFtZSddLCBmaWx0ZXJlZF9kYXRhKQogICAgICAgICAgICAKICAgICAgICAgICAgIyBVcGRhdGUgdHJhY2tpbmcgKGxpa2UgV2luZG93cyB3cml0ZUxhdGVzdEV2ZW50KQogICAgICAgICAgICB1cGRhdGVMYXN0Q29sbGVjdGlvblRpbWUoY2F0ZWdvcnlbJ25hbWUnXSkKICAgICAgICAgICAgCiAgICAgICAgICAgIGxvZ2dlci5pbmZvKGYiQ29tcGxldGVkIHtjYXRlZ29yeVsnbmFtZSddfToge2xlbihhbGxfZXZlbnRzKX0gdG90YWwgZXZlbnRzLCB7bGVuKGZpbHRlcmVkX2RhdGFbJ1NvdXJjZXMnXVsnVG9wRXZlbnRzJ10pfSBwYXR0ZXJucyIpCiAgICAgICAgICAgIAogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgbG9nZ2VyLmVycm9yKGYiRXJyb3IgcHJvY2Vzc2luZyB7Y2F0ZWdvcnlbJ25hbWUnXX06IHtlfSIpCiAgICAKICAgIGxvZ2dlci5pbmZvKCdNYWNPUyBMb2cgQXVkaXQgY29tcGxldGVkIHN1Y2Nlc3NmdWxseScpCgppZiBfX25hbWVfXyA9PSAiX19tYWluX18iOgogICAgbWFpbigpCg=="}, "resigned_at": 1761308229}