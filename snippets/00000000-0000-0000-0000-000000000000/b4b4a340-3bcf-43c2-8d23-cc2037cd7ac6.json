{"settings": {"snippetUuid": "b4b4a340-3bcf-43c2-8d23-cc2037cd7ac6", "snippetname": "lynis_audit", "snippettype": ".py", "created_at": 1761419491}, "payload": {"payloadsig": "THb4hDCU03cJ4qLXJlgk0wmVRWK0/YWhJVDLqnd7Tq3yIAmJ+9RbPQaR9ZY0nq0JXU9wlXtTvdKMsRCPS16UPbc5XmWJR0Aeye7X+8P4GKw+bDocWaSLOG30ivj6c7FeZ6xUifYMUQlyfq3FOz/0vlAn505vRQpliCI4co+COFVz6wzhSsD+EIG5FiY5sVWWyOVhYOsNX25w62gVE4nuoLmmqtc1stb2JKFAQ5eLzQfHIjalgwTuMqdHrBXalhqEcyt16gGFQywk92qfcfNJN4oUL0sxSkY2qoLnG+L+hAA/YIykolvqt67tHxrWMjBsrkQKnEZCedKZ0uwFG3LffPN7Ad4WTOOROJ5Ze1+p7BvM4mLnaHtn8W0gyeCxS+R8+FDsc0KKA1UjNaoHZtHejQAvl2daQVhM7r0C2bT1FR2e24gPy4K1PrZtsjZSIo/aKIo/a+icQiHsxZ7AmDJSqCcKvep17wEHnJd3prhKgvz6t5Szq3Tm45R2/CzgPT+0FJp9xLdWU4l4jZ5436o05d//WfX1+zqMStiaObWdy4n5UXH14WwGO6IktkVMBINRgHfndWuU99G6eAwDN0G+7DmADgYztQLgPuuf8E/m9ZGYGnLAHH2YTfhybG9p84YmyjA3MrgFhnjY1+kpYO2aj2Wo1yCo7UpGQ2gooQZXyqY=", "payloadb64": "IyBGaWxlcGF0aDogc25pcHBldHMvdW5TaWduZWQvbHluaXNfYXVkaXQucHkKIyBMeW5pcyBTZWN1cml0eSBBdWRpdCBTY3JpcHQgZm9yIFdlZ3dlaXNlcgojIFRoaXMgc2NyaXB0IGRvd25sb2FkcyBMeW5pcyBmcm9tIG9mZmljaWFsIEdpdEh1YiByZXBvIGFuZCBydW5zIGEgc2VjdXJpdHkgYXVkaXQKIyBQbGF0Zm9ybTogTGludXgsIG1hY09TCiMgbWV0YWxvZ29zX3R5cGU6IGx5bmlzLWF1ZGl0CgppbXBvcnQgb3MKaW1wb3J0IHN5cwppbXBvcnQganNvbgppbXBvcnQgcGxhdGZvcm0KaW1wb3J0IHN1YnByb2Nlc3MKaW1wb3J0IHRpbWUKZnJvbSBsb2d6ZXJvIGltcG9ydCBsb2dnZXIKCnRyeToKCWltcG9ydCByZXF1ZXN0cwpleGNlcHQgRXhjZXB0aW9uIGFzIGU6CglzdWJwcm9jZXNzLmNoZWNrX2NhbGwoW3N5cy5leGVjdXRhYmxlLCAnLW0nLCAncGlwJywgJ2luc3RhbGwnLCAncmVxdWVzdHMnXSkKCWltcG9ydCByZXF1ZXN0cwoKCiMjIyMjIyMjIyMjIyMjIyMjIEZVTkNUSU9OUyAjIyMjIyMjIyMjIyMjIyMjIwoKZGVmIGdldEFwcERpcnMoKToKCSIiIkdldCBhcHBsaWNhdGlvbiBkaXJlY3RvcmllcyBiYXNlZCBvbiBPUyIiIgoJaWYgcGxhdGZvcm0uc3lzdGVtKCkgPT0gJ1dpbmRvd3MnOgoJCWFwcERpciA9ICdjOlxccHJvZ3JhbSBmaWxlcyAoeDg2KVxcV2Vnd2Vpc2VyXFwnCgllbHNlOgoJCWFwcERpciA9ICcvb3B0L1dlZ3dlaXNlci8nCglsb2dEaXIgPSBvcy5wYXRoLmpvaW4oYXBwRGlyLCAnTG9ncycsICcnKQoJY29uZmlnRGlyID0gb3MucGF0aC5qb2luKGFwcERpciwgJ0NvbmZpZycsICcnKQoJZmlsZXNEaXIgPSBvcy5wYXRoLmpvaW4oYXBwRGlyLCAnZmlsZXMnLCAnJykKCXNjcmlwdHNEaXIgPSBvcy5wYXRoLmpvaW4oYXBwRGlyLCAnU2NyaXB0cycsICcnKQoJdGVtcERpciA9IG9zLnBhdGguam9pbihhcHBEaXIsICdUZW1wJywgJycpCglseW5pc0RpciA9IG9zLnBhdGguam9pbihhcHBEaXIsICdseW5pcycsICcnKQoJcmV0dXJuIGFwcERpciwgbG9nRGlyLCBjb25maWdEaXIsIHRlbXBEaXIsIGZpbGVzRGlyLCBzY3JpcHRzRGlyLCBseW5pc0RpcgoKZGVmIGNoZWNrRGlycyhkaXJzVG9DaGVjayk6CgkiIiJDcmVhdGUgZGlyZWN0b3JpZXMgaWYgdGhleSBkb24ndCBleGlzdCIiIgoJZm9yIGRpclRvQ2hlY2sgaW4gZGlyc1RvQ2hlY2s6CgkJZGlyVG9DaGVjayA9IG9zLnBhdGguam9pbihkaXJUb0NoZWNrLCAnJykKCQlpZiBub3Qgb3MucGF0aC5pc2RpcihkaXJUb0NoZWNrKToKCQkJbG9nZ2VyLmluZm8oZid7ZGlyVG9DaGVja30gZG9lcyBub3QgZXhpc3QuIENyZWF0aW5nLi4uJykKCQkJdHJ5OgoJCQkJb3MubWFrZWRpcnMoZGlyVG9DaGVjaykKCQkJCWxvZ2dlci5pbmZvKGYne2RpclRvQ2hlY2t9IGNyZWF0ZWQuJykKCQkJZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgoJCQkJbG9nZ2VyLmVycm9yKGYnRmFpbGVkIHRvIGNyZWF0ZSB7ZGlyVG9DaGVja30uIFJlYXNvbjoge2V9JykKCQkJCXN5cy5leGl0KCkKCmRlZiBnZXREZXZpY2VVdWlkKCk6CgkiIiJSZWFkIGRldmljZSBVVUlEIGFuZCBzZXJ2ZXIgYWRkcmVzcyBmcm9tIGNvbmZpZyIiIgoJYXBwRGlyLCBsb2dEaXIsIGNvbmZpZ0RpciwgdGVtcERpciwgZmlsZXNEaXIsIHNjcmlwdHNEaXIsIGx5bmlzRGlyID0gZ2V0QXBwRGlycygpCgl3aXRoIG9wZW4ob3MucGF0aC5qb2luKGNvbmZpZ0RpciwgJ2FnZW50LmNvbmZpZycpKSBhcyBmOgoJCWFnZW50Q29uZmlnRGljdCA9IGpzb24ubG9hZChmKQoJZGV2aWNlVXVpZCA9IGFnZW50Q29uZmlnRGljdFsnZGV2aWNldXVpZCddCglpZiAnc2VydmVyQWRkcicgaW4gYWdlbnRDb25maWdEaWN0OgoJCWhvc3QgPSBhZ2VudENvbmZpZ0RpY3RbJ3NlcnZlckFkZHInXQoJZWxzZToKCQlob3N0ID0gJ2FwcC53ZWd3ZWlzZXIudGVjaCcKCXJldHVybiBkZXZpY2VVdWlkLCBob3N0CgpkZWYgY2hlY2tfb3NfY29tcGF0aWJpbGl0eSgpOgoJIiIiQ2hlY2sgaWYgT1MgaXMgY29tcGF0aWJsZSB3aXRoIEx5bmlzIiIiCglvc19uYW1lID0gcGxhdGZvcm0uc3lzdGVtKCkKCWlmIG9zX25hbWUgbm90IGluIFsnTGludXgnLCAnRGFyd2luJ106ICAjIERhcndpbiA9IG1hY09TCgkJbG9nZ2VyLmVycm9yKGYiTHluaXMgaXMgbm90IGNvbXBhdGlibGUgd2l0aCB7b3NfbmFtZX0iKQoJCXJldHVybiBGYWxzZQoJcmV0dXJuIFRydWUKCmRlZiBpbnN0YWxsX2x5bmlzKGx5bmlzRGlyKToKCSIiIkRvd25sb2FkIGFuZCBpbnN0YWxsIEx5bmlzIGZyb20gb2ZmaWNpYWwgR2l0SHViIHJlcG9zaXRvcnkiIiIKCSMgQ2hlY2sgaWYgTHluaXMgYWxyZWFkeSBleGlzdHMKCWx5bmlzX2JpbmFyeSA9IG9zLnBhdGguam9pbihseW5pc0RpciwgJ2x5bmlzJykKCWlmIG9zLnBhdGguZXhpc3RzKGx5bmlzX2JpbmFyeSk6CgkJbG9nZ2VyLmluZm8oIkx5bmlzIGFscmVhZHkgaW5zdGFsbGVkLCBjaGVja2luZyBmb3IgdXBkYXRlcy4uLiIpCgkJdHJ5OgoJCQkjIFVwZGF0ZSBleGlzdGluZyBpbnN0YWxsYXRpb24KCQkJcmVzdWx0ID0gc3VicHJvY2Vzcy5ydW4oCgkJCQlbJ2dpdCcsICctQycsIGx5bmlzRGlyLCAncHVsbCddLAoJCQkJY2FwdHVyZV9vdXRwdXQ9VHJ1ZSwKCQkJCXRleHQ9VHJ1ZSwKCQkJCXRpbWVvdXQ9NjAKCQkJKQoJCQlpZiByZXN1bHQucmV0dXJuY29kZSA9PSAwOgoJCQkJbG9nZ2VyLmluZm8oIkx5bmlzIHVwZGF0ZWQgc3VjY2Vzc2Z1bGx5IikKCQkJCXJldHVybiBUcnVlCgkJCWVsc2U6CgkJCQlsb2dnZXIud2FybmluZygiRmFpbGVkIHRvIHVwZGF0ZSBMeW5pcywgd2lsbCB1c2UgZXhpc3RpbmcgdmVyc2lvbiIpCgkJCQlyZXR1cm4gVHJ1ZQoJCWV4Y2VwdCBFeGNlcHRpb24gYXMgZToKCQkJbG9nZ2VyLndhcm5pbmcoZiJDb3VsZCBub3QgdXBkYXRlIEx5bmlzOiB7ZX0sIHVzaW5nIGV4aXN0aW5nIHZlcnNpb24iKQoJCQlyZXR1cm4gVHJ1ZQoKCSMgSW5zdGFsbCBmcmVzaCBjb3B5Cglsb2dnZXIuaW5mbygiSW5zdGFsbGluZyBMeW5pcyBmcm9tIG9mZmljaWFsIEdpdEh1YiByZXBvc2l0b3J5Li4uIikKCXRyeToKCQkjIEVuc3VyZSBwYXJlbnQgZGlyZWN0b3J5IGV4aXN0cwoJCWFwcERpciA9IG9zLnBhdGguZGlybmFtZShseW5pc0Rpci5yc3RyaXAoJy8nKSkKCQlvcy5tYWtlZGlycyhhcHBEaXIsIG1vZGU9MG83NTUsIGV4aXN0X29rPVRydWUpCgoJCSMgQ2xvbmUgZnJvbSBvZmZpY2lhbCByZXBvc2l0b3J5CgkJcmVzdWx0ID0gc3VicHJvY2Vzcy5ydW4oCgkJCVsnZ2l0JywgJ2Nsb25lJywgJ2h0dHBzOi8vZ2l0aHViLmNvbS9DSVNPZnkvbHluaXMuZ2l0JywgbHluaXNEaXJdLAoJCQljYXB0dXJlX291dHB1dD1UcnVlLAoJCQl0ZXh0PVRydWUsCgkJCXRpbWVvdXQ9MTIwCgkJKQoKCQlpZiByZXN1bHQucmV0dXJuY29kZSA9PSAwOgoJCQlsb2dnZXIuaW5mbygiTHluaXMgaW5zdGFsbGVkIHN1Y2Nlc3NmdWxseSIpCgkJCXJldHVybiBUcnVlCgkJZWxzZToKCQkJbG9nZ2VyLmVycm9yKGYiRmFpbGVkIHRvIGluc3RhbGwgTHluaXM6IHtyZXN1bHQuc3RkZXJyfSIpCgkJCXJldHVybiBGYWxzZQoKCWV4Y2VwdCBzdWJwcm9jZXNzLlRpbWVvdXRFeHBpcmVkOgoJCWxvZ2dlci5lcnJvcigiTHluaXMgaW5zdGFsbGF0aW9uIHRpbWVkIG91dCIpCgkJcmV0dXJuIEZhbHNlCglleGNlcHQgRXhjZXB0aW9uIGFzIGU6CgkJbG9nZ2VyLmVycm9yKGYiRXJyb3IgaW5zdGFsbGluZyBMeW5pczoge2V9IikKCQlyZXR1cm4gRmFsc2UKCmRlZiBydW5fbHluaXNfYXVkaXQobHluaXNEaXIpOgoJIiIiUnVuIEx5bmlzIHNlY3VyaXR5IGF1ZGl0IGFuZCByZXR1cm4gcmVzdWx0cyIiIgoJbHluaXNfYmluYXJ5ID0gJy4vbHluaXMnICAjIFVzZSByZWxhdGl2ZSBwYXRoIHNpbmNlIHdlJ2xsIHJ1biBmcm9tIGx5bmlzRGlyCglseW5pc19mdWxsX3BhdGggPSBvcy5wYXRoLmpvaW4obHluaXNEaXIsICdseW5pcycpCgoJaWYgbm90IG9zLnBhdGguZXhpc3RzKGx5bmlzX2Z1bGxfcGF0aCk6CgkJbG9nZ2VyLmVycm9yKCJMeW5pcyBiaW5hcnkgbm90IGZvdW5kIikKCQlyZXR1cm4gTm9uZQoKCWxvZ2dlci5pbmZvKCJSdW5uaW5nIEx5bmlzIHNlY3VyaXR5IGF1ZGl0Li4uIikKCgl0cnk6CgkJIyBSdW4gTHluaXMgYXVkaXQgZnJvbSBpdHMgb3duIGRpcmVjdG9yeSAocmVxdWlyZWQgZm9yIEx5bmlzIHRvIGZpbmQgaW5jbHVkZSBmaWxlcykKCQkjIC0tcXVpZXQ6IExlc3MgdmVyYm9zZSBvdXRwdXQKCQkjIC0tcXVpY2s6IFNraXAgd2FpdCBmb3IgdXNlciBpbnB1dAoJCSMgLS1hdWRpdG9yICJXZWd3ZWlzZXIiOiBUYWcgdGhlIGF1ZGl0CgkJcmVzdWx0ID0gc3VicHJvY2Vzcy5ydW4oCgkJCVtseW5pc19iaW5hcnksICdhdWRpdCcsICdzeXN0ZW0nLCAnLS1xdWlldCcsICctLXF1aWNrJywgJy0tYXVkaXRvcicsICdXZWd3ZWlzZXInXSwKCQkJY2FwdHVyZV9vdXRwdXQ9VHJ1ZSwKCQkJdGV4dD1UcnVlLAoJCQljd2Q9bHluaXNEaXIsICAjIFJ1biBmcm9tIEx5bmlzIGRpcmVjdG9yeQoJCQl0aW1lb3V0PTMwMCAgIyA1IG1pbnV0ZXMgbWF4CgkJKQoKCQlpZiByZXN1bHQucmV0dXJuY29kZSBub3QgaW4gWzAsIDFdOiAgIyBMeW5pcyByZXR1cm5zIDEgaWYgd2FybmluZ3MgZm91bmQgKG5vcm1hbCkKCQkJbG9nZ2VyLmVycm9yKGYiTHluaXMgYXVkaXQgZmFpbGVkOiB7cmVzdWx0LnN0ZGVycn0iKQoJCQlyZXR1cm4gTm9uZQoKCQkjIFBhcnNlIHRoZSBsb2cgZmlsZSBmb3IgcmVzdWx0cwoJCWxvZ19maWxlID0gJy92YXIvbG9nL2x5bmlzLmxvZycKCQlyZXBvcnRfZmlsZSA9ICcvdmFyL2xvZy9seW5pcy1yZXBvcnQuZGF0JwoKCQlhdWRpdF9yZXN1bHRzID0gewoJCQknc3RhdHVzJzogJ2NvbXBsZXRlZCcsCgkJCSd0aW1lc3RhbXAnOiBpbnQodGltZS50aW1lKCkpLAoJCQknb3MnOiBwbGF0Zm9ybS5zeXN0ZW0oKSwKCQkJJ29zX3ZlcnNpb24nOiBwbGF0Zm9ybS5yZWxlYXNlKCksCgkJCSdob3N0bmFtZSc6IHBsYXRmb3JtLm5vZGUoKSwKCQkJJ2x5bmlzX3ZlcnNpb24nOiBOb25lLAoJCQknaGFyZGVuaW5nX2luZGV4JzogTm9uZSwKCQkJJ3Rlc3RzX3BlcmZvcm1lZCc6IDAsCgkJCSd3YXJuaW5ncyc6IFtdLAoJCQknc3VnZ2VzdGlvbnMnOiBbXSwKCQkJJ2ZpbmRpbmdzJzoge30sCgkJCSdyYXdfb3V0cHV0JzogcmVzdWx0LnN0ZG91dAoJCX0KCgkJIyBQYXJzZSByZXBvcnQgZmlsZSBpZiBpdCBleGlzdHMKCQlpZiBvcy5wYXRoLmV4aXN0cyhyZXBvcnRfZmlsZSk6CgkJCXdpdGggb3BlbihyZXBvcnRfZmlsZSwgJ3InKSBhcyBmOgoJCQkJZm9yIGxpbmUgaW4gZjoKCQkJCQlsaW5lID0gbGluZS5zdHJpcCgpCgkJCQkJaWYgbm90IGxpbmUgb3IgbGluZS5zdGFydHN3aXRoKCcjJyk6CgkJCQkJCWNvbnRpbnVlCgoJCQkJCWlmICc9JyBpbiBsaW5lOgoJCQkJCQlrZXksIHZhbHVlID0gbGluZS5zcGxpdCgnPScsIDEpCgkJCQkJCWtleSA9IGtleS5zdHJpcCgpCgkJCQkJCXZhbHVlID0gdmFsdWUuc3RyaXAoKQoKCQkJCQkJIyBFeHRyYWN0IGtleSBpbmZvcm1hdGlvbgoJCQkJCQlpZiBrZXkgPT0gJ2x5bmlzX3ZlcnNpb24nOgoJCQkJCQkJYXVkaXRfcmVzdWx0c1snbHluaXNfdmVyc2lvbiddID0gdmFsdWUKCQkJCQkJZWxpZiBrZXkgPT0gJ2hhcmRlbmluZ19pbmRleCc6CgkJCQkJCQl0cnk6CgkJCQkJCQkJYXVkaXRfcmVzdWx0c1snaGFyZGVuaW5nX2luZGV4J10gPSBpbnQodmFsdWUpCgkJCQkJCQlleGNlcHQgVmFsdWVFcnJvcjoKCQkJCQkJCQlwYXNzCgkJCQkJCWVsaWYga2V5ID09ICd0ZXN0c19wZXJmb3JtZWQnOgoJCQkJCQkJdHJ5OgoJCQkJCQkJCWF1ZGl0X3Jlc3VsdHNbJ3Rlc3RzX3BlcmZvcm1lZCddID0gaW50KHZhbHVlKQoJCQkJCQkJZXhjZXB0IFZhbHVlRXJyb3I6CgkJCQkJCQkJcGFzcwoJCQkJCQllbGlmIGtleS5zdGFydHN3aXRoKCd3YXJuaW5nWycpOgoJCQkJCQkJYXVkaXRfcmVzdWx0c1snd2FybmluZ3MnXS5hcHBlbmQodmFsdWUpCgkJCQkJCWVsaWYga2V5LnN0YXJ0c3dpdGgoJ3N1Z2dlc3Rpb25bJyk6CgkJCQkJCQlhdWRpdF9yZXN1bHRzWydzdWdnZXN0aW9ucyddLmFwcGVuZCh2YWx1ZSkKCQkJCQkJZWxzZToKCQkJCQkJCSMgU3RvcmUgb3RoZXIgZmluZGluZ3MKCQkJCQkJCWlmIGtleSBub3QgaW4gYXVkaXRfcmVzdWx0c1snZmluZGluZ3MnXToKCQkJCQkJCQlhdWRpdF9yZXN1bHRzWydmaW5kaW5ncyddW2tleV0gPSBbXQoJCQkJCQkJYXVkaXRfcmVzdWx0c1snZmluZGluZ3MnXVtrZXldLmFwcGVuZCh2YWx1ZSkKCgkJIyBQYXJzZSBsb2cgZmlsZSBmb3IgYWRkaXRpb25hbCBkZXRhaWxzCgkJaWYgb3MucGF0aC5leGlzdHMobG9nX2ZpbGUpOgoJCQl0cnk6CgkJCQl3aXRoIG9wZW4obG9nX2ZpbGUsICdyJykgYXMgZjoKCQkJCQlsb2dfY29udGVudCA9IGYucmVhZCgpCgkJCQkJYXVkaXRfcmVzdWx0c1snbG9nX2V4Y2VycHQnXSA9IGxvZ19jb250ZW50Wy01MDAwOl0gICMgTGFzdCA1MDAwIGNoYXJzCgkJCWV4Y2VwdCBFeGNlcHRpb24gYXMgZToKCQkJCWxvZ2dlci53YXJuaW5nKGYiQ291bGQgbm90IHJlYWQgbG9nIGZpbGU6IHtlfSIpCgoJCWxvZ2dlci5pbmZvKGYiTHluaXMgYXVkaXQgY29tcGxldGVkLiBIYXJkZW5pbmcgSW5kZXg6IHthdWRpdF9yZXN1bHRzLmdldCgnaGFyZGVuaW5nX2luZGV4JywgJ04vQScpfSIpCgkJbG9nZ2VyLmluZm8oZiJUZXN0cyBwZXJmb3JtZWQ6IHthdWRpdF9yZXN1bHRzWyd0ZXN0c19wZXJmb3JtZWQnXX0iKQoJCWxvZ2dlci5pbmZvKGYiV2FybmluZ3M6IHtsZW4oYXVkaXRfcmVzdWx0c1snd2FybmluZ3MnXSl9IikKCQlsb2dnZXIuaW5mbyhmIlN1Z2dlc3Rpb25zOiB7bGVuKGF1ZGl0X3Jlc3VsdHNbJ3N1Z2dlc3Rpb25zJ10pfSIpCgoJCXJldHVybiBhdWRpdF9yZXN1bHRzCgoJZXhjZXB0IHN1YnByb2Nlc3MuVGltZW91dEV4cGlyZWQ6CgkJbG9nZ2VyLmVycm9yKCJMeW5pcyBhdWRpdCB0aW1lZCBvdXQgYWZ0ZXIgNSBtaW51dGVzIikKCQlyZXR1cm4gTm9uZQoJZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgoJCWxvZ2dlci5lcnJvcihmIkVycm9yIHJ1bm5pbmcgTHluaXMgYXVkaXQ6IHtlfSIpCgkJcmV0dXJuIE5vbmUKCmRlZiBzZW5kX3RvX3dlZ3dlaXNlcihkZXZpY2VVdWlkLCBob3N0LCBhdWRpdF9kYXRhKToKCSIiIlNlbmQgYXVkaXQgcmVzdWx0cyB0byBXZWd3ZWlzZXIgc2VydmVyIiIiCglib2R5ID0gewoJCSdkZXZpY2V1dWlkJzogZGV2aWNlVXVpZCwKCQknbWV0YWxvZ29zX3R5cGUnOiAnbHluaXMtYXVkaXQnLAoJCSdtZXRhbG9nb3MnOiBhdWRpdF9kYXRhCgl9CgoJdXJsID0gZidodHRwczovL3tob3N0fS9haS9kZXZpY2UvbWV0YWRhdGEnCgloZWFkZXJzID0geydDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbid9CgoJdHJ5OgoJCXJlc3BvbnNlID0gcmVxdWVzdHMucG9zdCh1cmwsIGhlYWRlcnM9aGVhZGVycywgZGF0YT1qc29uLmR1bXBzKGJvZHkpLCB0aW1lb3V0PTMwKQoJCWlmIHJlc3BvbnNlLnN0YXR1c19jb2RlID09IDIwMToKCQkJbG9nZ2VyLmluZm8oIkx5bmlzIGF1ZGl0IGRhdGEgc2VudCBzdWNjZXNzZnVsbHkgdG8gV2Vnd2Vpc2VyIikKCQkJcmV0dXJuIFRydWUKCQllbHNlOgoJCQlsb2dnZXIuZXJyb3IoZiJGYWlsZWQgdG8gc2VuZCBkYXRhOiBIVFRQIHtyZXNwb25zZS5zdGF0dXNfY29kZX0gLSB7cmVzcG9uc2UudGV4dH0iKQoJCQlyZXR1cm4gRmFsc2UKCWV4Y2VwdCBFeGNlcHRpb24gYXMgZToKCQlsb2dnZXIuZXJyb3IoZiJFcnJvciBzZW5kaW5nIGRhdGEgdG8gV2Vnd2Vpc2VyOiB7ZX0iKQoJCXJldHVybiBGYWxzZQoKIyMjIyMjIyMjIyMjIyMjIyMgTUFJTiAjIyMjIyMjIyMjIyMjIyMjIwoKdHJ5OgoJIyBHZXQgYXBwIGRpcmVjdG9yaWVzCglhcHBEaXIsIGxvZ0RpciwgY29uZmlnRGlyLCB0ZW1wRGlyLCBmaWxlc0Rpciwgc2NyaXB0c0RpciwgbHluaXNEaXIgPSBnZXRBcHBEaXJzKCkKCWNoZWNrRGlycyhbYXBwRGlyLCBsb2dEaXIsIGNvbmZpZ0RpciwgdGVtcERpciwgZmlsZXNEaXIsIHNjcmlwdHNEaXIsIGx5bmlzRGlyXSkKCgkjIENoZWNrIE9TIGNvbXBhdGliaWxpdHkKCWlmIG5vdCBjaGVja19vc19jb21wYXRpYmlsaXR5KCk6CgkJbG9nZ2VyLmVycm9yKCJUaGlzIHNjcmlwdCByZXF1aXJlcyBMaW51eCBvciBtYWNPUyIpCgkJcHJpbnQoIkVSUk9SOiBMeW5pcyBpcyBvbmx5IGNvbXBhdGlibGUgd2l0aCBMaW51eCBhbmQgbWFjT1Mgc3lzdGVtcyIpCgkJc3lzLmV4aXQoMSkKCgkjIEdldCBkZXZpY2UgY29uZmlndXJhdGlvbgoJZGV2aWNlVXVpZCwgaG9zdCA9IGdldERldmljZVV1aWQoKQoJbG9nZ2VyLmluZm8oZiJEZXZpY2UgVVVJRDoge2RldmljZVV1aWR9IikKCWxvZ2dlci5pbmZvKGYiV2Vnd2Vpc2VyIEhvc3Q6IHtob3N0fSIpCgoJIyBJbnN0YWxsL1VwZGF0ZSBMeW5pcwoJaWYgbm90IGluc3RhbGxfbHluaXMobHluaXNEaXIpOgoJCWxvZ2dlci5lcnJvcigiRmFpbGVkIHRvIGluc3RhbGwgTHluaXMiKQoJCXByaW50KCJFUlJPUjogRmFpbGVkIHRvIGluc3RhbGwgTHluaXMgZnJvbSBHaXRIdWIiKQoJCXN5cy5leGl0KDEpCgoJIyBSdW4gc2VjdXJpdHkgYXVkaXQKCWF1ZGl0X3Jlc3VsdHMgPSBydW5fbHluaXNfYXVkaXQobHluaXNEaXIpCglpZiBhdWRpdF9yZXN1bHRzIGlzIE5vbmU6CgkJbG9nZ2VyLmVycm9yKCJGYWlsZWQgdG8gcnVuIEx5bmlzIGF1ZGl0IikKCQlwcmludCgiRVJST1I6IEZhaWxlZCB0byBydW4gTHluaXMgYXVkaXQiKQoJCXN5cy5leGl0KDEpCgoJIyBDb252ZXJ0IHRvIEpTT04gc3RyaW5nIGZvciB0cmFuc21pc3Npb24KCWRhdGEgPSBqc29uLmR1bXBzKGF1ZGl0X3Jlc3VsdHMpCgoJIyBTZW5kIHRvIFdlZ3dlaXNlcgoJaWYgc2VuZF90b193ZWd3ZWlzZXIoZGV2aWNlVXVpZCwgaG9zdCwgZGF0YSk6CgkJbG9nZ2VyLmluZm8oIkx5bmlzIHNlY3VyaXR5IGF1ZGl0IGNvbXBsZXRlZCBzdWNjZXNzZnVsbHkiKQoJCXByaW50KCJTVUNDRVNTOiBMeW5pcyBhdWRpdCBjb21wbGV0ZWQgYW5kIHNlbnQgdG8gV2Vnd2Vpc2VyIikKCWVsc2U6CgkJbG9nZ2VyLmVycm9yKCJGYWlsZWQgdG8gc2VuZCBhdWRpdCByZXN1bHRzIHRvIFdlZ3dlaXNlciIpCgkJcHJpbnQoIkVSUk9SOiBGYWlsZWQgdG8gc2VuZCBhdWRpdCByZXN1bHRzIHRvIFdlZ3dlaXNlciIpCgkJc3lzLmV4aXQoMSkKCmV4Y2VwdCBFeGNlcHRpb24gYXMgZToKCWxvZ2dlci5lcnJvcihmIkZhdGFsIGVycm9yIGluIEx5bmlzIGF1ZGl0IHNjcmlwdDoge2V9IikKCXByaW50KGYiRVJST1I6IHtlfSIpCglzeXMuZXhpdCgxKQo="}}