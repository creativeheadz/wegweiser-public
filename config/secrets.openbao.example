# OpenBao Secrets Configuration Example
# This file shows how to structure secrets in OpenBao for Wegweiser
#
# OpenBao is a fork of HashiCorp Vault and uses a compatible API
# https://openbao.org/

# ============================================================================
# HOW TO USE THIS CONFIGURATION
# ============================================================================
#
# 1. Install and run OpenBao:
#    docker run -d --name openbao -p 8200:8200 openbao:latest
#
# 2. Initialize and unseal OpenBao (one-time setup)
#
# 3. Login and create secrets using the OpenBao CLI or API:
#    vault login <token>
#
# 4. Create secrets using commands below
#
# 5. Configure Wegweiser to use OpenBao:
#    - Set SECRET_STORAGE=openbao in .env
#    - Set OPENBAO_ADDR=http://localhost:8200
#    - Set OPENBAO_TOKEN=<your-token>
#    - Set OPENBAO_SECRET_PATH=secret/wegweiser

# ============================================================================
# EXAMPLE COMMANDS TO CREATE SECRETS IN OPENBAO
# ============================================================================

# Enable KV v2 secrets engine at path 'secret/' (usually enabled by default)
# vault secrets enable -version=2 -path=secret kv

# Create all required secrets for Wegweiser
# These commands assume the default KV v2 engine at 'secret/'

# Database Configuration
# vault kv put secret/wegweiser/databaseurl value="postgresql://wegweiser:password@localhost:5432/wegweiser"

# Secret Keys
# vault kv put secret/wegweiser/secretkey value="your-32-character-secret-key"
# vault kv put secret/wegweiser/apikey value="your-api-key"

# Azure Configuration
# vault kv put secret/wegweiser/azureopenaiapkey value="your-azure-openai-key"
# vault kv put secret/wegweiser/azureopenaiendpoint value="https://your-resource.openai.azure.net/"
# vault kv put secret/wegweiser/azureopenaiapiversion value="2024-02-01"
# vault kv put secret/wegweiser/azuretenantid value="your-tenant-id"
# vault kv put secret/wegweiser/azureclientid value="your-client-id"
# vault kv put secret/wegweiser/azureclientsecret value="your-client-secret"
# vault kv put secret/wegweiser/azureredirecturi value="https://yourapp.com/auth/microsoft/callback"

# AI Provider Secrets
# vault kv put secret/wegweiser/openaikey value="sk-your-openai-key"
# vault kv put secret/wegweiser/anthropicapikey value="sk-ant-your-anthropic-key"

# Email Configuration
# vault kv put secret/wegweiser/mailserver value="smtp.gmail.com"
# vault kv put secret/wegweiser/mailusername value="your-email@gmail.com"
# vault kv put secret/wegweiser/mailpassword value="your-email-password"
# vault kv put secret/wegweiser/maildefaultsender value="noreply@example.com"

# Stripe Configuration
# vault kv put secret/wegweiser/stripesecretkey value="sk_live_your-stripe-secret-key"
# vault kv put secret/wegweiser/stripewebhooksecret value="whsec_your-webhook-secret"

# reCAPTCHA Configuration
# vault kv put secret/wegweiser/recaptchapublickey value="your-recaptcha-public-key"
# vault kv put secret/wegweiser/recaptchaprivatekey value="your-recaptcha-private-key"

# Support Desk Integration
# vault kv put secret/wegweiser/supportdeskapitoken value="your-zammad-api-token"

# Remote Logging (optional)
# vault kv put secret/wegweiser/remoteloggingpassword value="your-remote-logging-password"

# IP Blocker Redis Password (if using Redis for IP blocking)
# vault kv put secret/wegweiser/ipblockerredispassword value="your-redis-password"

# Celery Configuration
# vault kv put secret/wegweiser/celerybrokerurl value="redis://localhost:6379/0"
# vault kv put secret/wegweiser/celeryresultbackend value="redis://localhost:6379/0"

# ============================================================================
# ENVIRONMENT VARIABLES FOR OPENBAO CONNECTION
# ============================================================================

# In your .env file, set:
# SECRET_STORAGE=openbao
# OPENBAO_ADDR=http://localhost:8200
# OPENBAO_TOKEN=your-openbao-token
# OPENBAO_SECRET_PATH=secret/wegweiser
# OPENBAO_VERIFY_SSL=true

# ============================================================================
# OPENBAO CLI EXAMPLES
# ============================================================================

# List all secrets at a path:
# vault kv list secret/wegweiser

# Get a specific secret:
# vault kv get secret/wegweiser/databaseurl

# Update a secret:
# vault kv put secret/wegweiser/databaseurl value="postgresql://..."

# Delete a secret:
# vault kv delete secret/wegweiser/databaseurl

# ============================================================================
# DOCKER EXAMPLE (Development Setup)
# ============================================================================

# docker run -d \
#   --name openbao \
#   -p 8200:8200 \
#   -e VAULT_DEV_ROOT_TOKEN_ID=dev-token \
#   -e VAULT_DEV_LISTEN_ADDRESS=0.0.0.0:8200 \
#   openbao:latest

# Then configure Wegweiser with:
# OPENBAO_ADDR=http://localhost:8200
# OPENBAO_TOKEN=dev-token
# SECRET_STORAGE=openbao

# ============================================================================
# PRODUCTION RECOMMENDATIONS
# ============================================================================

# 1. Use strong, randomly generated tokens
# 2. Enable mTLS for client authentication
# 3. Implement audit logging
# 4. Use sealed unsealing mechanisms (Shamir keys, KMS auto-unseal)
# 5. Implement regular backup and disaster recovery procedures
# 6. Use separate namespaces for different environments (dev, staging, prod)
# 7. Implement access policies following principle of least privilege
# 8. Regularly rotate tokens and credentials

# Example access policy for Wegweiser:
# path "secret/data/wegweiser/*" {
#   capabilities = ["read", "list"]
# }
